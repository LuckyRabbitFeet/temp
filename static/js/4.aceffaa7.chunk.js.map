{"version":3,"sources":["components/loader/index.jsx","components/menu-icon/index.jsx","components/menu-layout/header.jsx","components/menu-layout/index.jsx","components/config/item.jsx","components/hexagon-button/index.jsx","components/switch/index.jsx","components/config/volume.jsx","engine/utils/index.ts","engine/sound/sound.ts","components/config/index.jsx","components/about/card.jsx","game/config/stage.js","game/config/about.js","game/config/asset.js","game/config/text.js","game/config/character/components/eyes.js","game/config/character/components/mouth.js","game/config/character/components/head.js","game/config/character/components/body.js","game/config/character/components/hand.js","game/config/character/components/map.js","game/config/color.js","components/about/index.jsx","components/dialog/save.jsx","components/dialog/warning.jsx","engine/loader/index.ts","engine/render/renderer.ts","engine/core/object-pool.ts","engine/core/component.ts","engine/core/utils.ts","engine/core/entity.ts","engine/core/entity-query.ts","engine/core/entity-manager.ts","engine/core/system.ts","engine/core/system-manager.ts","engine/core/world.ts","engine/render/stage.ts","engine/render/scene.ts","engine/render/plugins/interaction/InteractionData.ts","engine/render/plugins/interaction/InteractionManager.ts","game/scene/title/flower.js","game/scene/title/index.js","engine/components/base/render.ts","engine/components/sprite.ts","engine/components/animation.ts","engine/lib/rainbow-text/rainbow-text.js","engine/components/text.ts","engine/components/typewriter.ts","engine/components/button.ts","engine/components/transform.ts","engine/components/transparent.ts","engine/components/sound.ts","engine/components/displacement.ts","engine/components/fade.ts","engine/systems/pixi-render.ts","engine/systems/text-update.ts","engine/systems/animation.ts","engine/systems/typewriter.ts","engine/systems/text-button.ts","engine/systems/transform.ts","engine/systems/sound.ts","game/components/singleton/input.js","game/components/singleton/story.js","game/systems/input.js","game/systems/story.js","game/components/tag/index.js","game/systems/remove.js","game/story/api/util.js","game/story/api/stage/util.js","game/story/api/stage/curtain.js","game/story/api/stage/voiceover.js","game/story/api/stage/index.js","game/story/api/flow/index.js","game/story/api/scene/util.js","game/story/api/scene/show.js","game/story/api/scene/hide.js","game/story/api/scene/index.js","game/story/api/scene/shake.js","game/story/api/dialog/util.js","game/story/api/dialog/show.js","game/story/api/dialog/index.js","game/story/api/dialog/hide.js","game/story/api/character/util.js","game/config/character/index.js","game/story/api/character/show.js","game/story/api/character/index.js","game/story/api/character/hide.js","game/story/api/character/update.js","game/story/api/choice/util.js","game/story/api/choice/index.js","game/story/api/choice/select.js","game/story/api/choice/button.js","game/story/api/bgm/util.js","game/story/api/bgm/index.js","game/story/api/index.js","game/story/chapter1/chapter1.js","game/story/chapter1/chapter1-1/chapter1-1.js","game/story/chapter1/chapter1-2/chapter1-2.js","game/story/utils.js","game/story/common.js","game/story/chapter1/chapter1-3/chapter1-3.js","game/story/chapter1/chapter1-4/chapter1-4.js","game/story/chapter1/chapter1-5/east.js","game/story/chapter1/chapter1-5/west.js","game/story/chapter1/chapter1-5/chapter1-5.js","game/story/chapter1/chapter1-5/chapter1-5-1.js","game/story/chapter1/chapter1-5/chapter1-5-2.js","game/story/chapter1/chapter1-5/chapter1-5-3.js","game/story/chapter1/chapter1-5/chapter1-5-4.js","game/story/chapter1/chapter1-6/chapter1-6.js","game/story/chapter2/chapter2-1/event0.js","game/story/chapter2/chapter2-1/chapter2-1.js","game/story/chapter2/chapter2-2/east.js","game/story/chapter2/chapter2-2/west.js","game/story/chapter2/chapter2-2/chapter2-2.js","game/story/chapter2/chapter2-2/chapter2-2-1.js","game/story/chapter2/chapter2-2/chapter2-2-3.js","game/story/chapter2/chapter2-2/chapter2-2-5.js","game/story/chapter2/chapter2-3/battle.js","game/story/chapter2/chapter2-3/chapter2-3.js","game/story/chapter2/chapter2-4/east.js","game/story/chapter2/chapter2-4/west.js","game/story/chapter2/chapter2-4/chapter2-4.js","game/story/chapter2/chapter2-4/chapter2-4-1.js","game/story/chapter2/chapter2-4/chapter2-4-4.js","game/story/chapter2/chapter2-4/chapter2-4-5.js","game/story/index.js","game/scene/main/index.js","game/scene/cutscene/index.js","game/index.js","components/love-memory/index.jsx"],"names":["Loader","detailsHandle","setState","show","state","this","props","loader","loading","progress","error","style","className","display","width","color","onClick","React","Component","MenuIcon","e","Header","version","MenuLayout","children","onClose","Item","name","HexagonButton","Switch","checked","onChange","type","input","target","sliderStyle","position","touchAction","Volume","value","domain","mode","step","rootStyle","values","getRailProps","handles","getHandleProps","map","handle","key","id","right","tracks","getTrackProps","source","railOuterStyle","height","transform","borderRadius","cursor","railInnerStyle","pointerEvents","backgroundColor","SliderRail","Handle","min","max","percent","disabled","left","WebkitTapHighlightColor","zIndex","role","aria-valuemin","aria-valuemax","aria-valuenow","boxShadow","Track","saveToLocalStorage","storageKey","data","localStorage","setItem","loadFromLocalStorage","force","getItem","console","warn","utf8","parse","toString","Sound","alias","sound","find","options","play","stop","stopAll","muted","muteAll","unmuteAll","volume","JSON","stringify","mute","volumeAll","isPlaying","Config","switchHandle","unmute","saveState","volumeHandle","exportHandle","textarea","current","getArchive","selectAllHandle","select","createRef","onPanel","onSave","onLoad","onBack","ref","PureComponent","Card","item","title","url","content","href","rel","stageInfo","about","assets","onComplete","soundMiddleware","resource","singleInstance","baseSrtle","fontFamily","fontWeight","fontSize","lineJoin","fill","stroke","strokeThickness","startMenuStyle","buttonStyle","voiceoverStyle","nameStyle","dialogStyle","background","padding","eyes","res","layer","x","y","mouth","head","body","hand","About","SaveDialog","isOpen","status","closeTimeoutMS","ariaHideApp","contentLabel","overlay","justifyContent","alignItems","margin","WarningDialog","onConfirm","lineHeight","textAlign","paddingTop","paddingLeft","baseUrl","concurrency","loaded","onProgressed","onCompleted","PIXI","Signal","Promise","resolve","resources","add","on","_onProgress","bind","_onComplete","reject","_onError","load","_onLoad","dispatch","reset","Renderer","pluginKey","renderer","plugins","antialias","interaction","autoPreventDefault","view","render","autoDensity","resize","pluginClass","ObjectPool","ObjectClass","freed","capacity","size","pool","pools","get","undefined","set","clear","delete","length","expand","pop","push","count","Math","round","i","componentRegister","IComponent","_componentClassMap","has","_id","_isRegister","_pools","of","WeakMap","entity","componentClass","component","acquire","_setProps","init","onComponentCreated","onComponentDestroyed","release","components","forEach","totalSize","free","totalFree","used","totalUsed","_isComponent","Map","now","window","performance","Date","Entity","d","getTime","replace","c","r","random","floor","generateUUID","isSingleton","_world","_components","onComponentChanged","removeAllComponent","Error","hasComponent","componentClassList","verifyComponent","create","destory","class","json","componentClassMap","classId","addComponent","world","_pool","_destory","QueryItem","queryComponents","matchType","entities","matchAll","matchAny","hasAllComponent","hasAnyComponent","indexOf","index","splice","numQueryComponents","numEntities","EntityQuery","queries","join","query","removeEntity","match","addEntity","stats","numQueries","EntityManager","entityQuery","entitiesWithComponentChanged","Set","initEntity","pushEntity","onEntityRemoved","QueryComponents","createQuery","onEntityComponentChanged","token","fromJSON","queryStats","SystemPriority","ISystem","_priority","_executeTime","delta","timestamp","isSystem","SystemManager","entityManager","systems","systemClass","system","Array","isArray","results","getEntity","systemCount","unshift","priority","isRegisterSystem","_injectQuery","_pushSystem","findIndex","startTime","execute","updateEntityQuery","numSystems","executeTime","constructor","World","systemManager","singleton","enabled","lastTimestamp","registerSystem","createEntity","hasEntity","overview","poolStats","Stage","numLayer","layerMap","addChildAt","addChild","_addLayer","removeChild","removeChildren","Scene","addLayer","createLayer","createParticleLayer","hasLayer","getLayer","removeLayer","layerId","sprite","Point","InteractionData","global","originalEvent","isDown","identifier","isPrimary","button","buttons","tiltX","tiltY","pointerType","pressure","rotationAngle","twist","tangentialPressure","event","Number","isInteger","which","InteractionManager","supportsTouchEvents","supportsPointerEvents","mouse","resolution","interactionDOMElement","eventsAdded","PointerEvent","onPointerUp","onPointerCancel","onPointerDown","onPointerMove","onPointerOut","onPointerOver","setTargetElement","element","removeEvents","addEvents","navigator","msPointerEnabled","msContentZooming","msTouchAction","dom","document","addEventListener","removeEventListener","rect","point","parentElement","getBoundingClientRect","resolutionMultiplier","top","interactionData","getInteractionData","configureInteractionDataForDOMEvent","normalizeToPointerData","processInteractive","onPointerComplete","pointerId","copyEvent","pointerEvent","mapPositionToPoint","clientX","clientY","globalX","globalY","normalizedEvents","TouchEvent","li","changedTouches","touch","touches","radiusX","radiusY","layerX","offsetX","layerY","offsetY","isNormalized","MouseEvent","tempEvent","Flower","texture","clientWidth","clientHeight","maxDist","z","vx","vy","rotation","PI","anchor","spin","Sprite","FlowerFlyBackground","amount","parent","textureId","flowerArr","Texture","from","flower","obj","xpos","update","fontStyle","btnDownStyle","Title","_bgmPlay","_addBackground","_addPtcLayer","_addMenu","ptcLayer","flowerFly","gameInfo","group","start","_createButton","_bgmStop","onStartClicked","onLoadClicked","setup","onSettingClicked","onAboutClicked","loop","text","clickHandle","btn","interactive","buttonMode","onButtonDown","onButtonUp","onButtonOver","onButtonOut","preventDefault","tick","isdown","scale","isOver","RenderComponent","visible","isRender","destroy","SpriteComponent","EMPTY","revert","getRenderJSON","AnimationComponent","texturesId","animationSpeed","playing","cycle","textures","fillFrames","getFillFrames","AnimatedSprite","TEXT_GRADIENT","defaultDestroyOptions","baseTexture","processBbcode","tokens","magic","params","bbcode","slice","tmp","TextMetrics","tokenize","char","test","wordWrap","canvas","_canvas","context","getContext","line","lines","cache","letterSpacing","whiteSpace","collapseSpaces","collapseNewlines","canPrependSpaces","wordWrapWidth","result","isNewline","addLine","currIsBreakingSpace","isBreakingSpace","lastIsBreakingSpace","tokenWidth","getFromCache","canBreakWords","breakWords","characters","wordWrapSplit","j","k","nextChar","lastChar","canBreakChars","characterWidth","isLastToken","RainbowText","ownCanvas","createElement","orig","Rectangle","trim","_ownCanvas","_resolution","settings","RESOLUTION","_autoResolution","_text","_style","_styleListener","_font","localStyleID","bbcodeFillIndex","bbcodeStrokeIndex","respectDirty","styleID","dirty","toFontString","linePositionX","linePositionY","measured","measureText","lineWidths","maxLineWidth","fontProperties","ceil","clearRect","font","lineWidth","textBaseline","miterLimit","passesCount","dropShadow","isShadowPass","dsOffsetText","dsOffsetShadow","fillStyle","strokeStyle","dropShadowColor","rgb","hex2rgb","string2hex","shadowColor","dropShadowAlpha","shadowBlur","dropShadowBlur","shadowOffsetX","cos","dropShadowAngle","dropShadowDistance","shadowOffsetY","sin","_generateFillStyle","originText","split","ascent","align","drawLetterSpacing","updateTexture","isStroke","currentPosition","stringArray","previousWidth","currentWidth","currentChar","offset","strokeText","fillText","substring","trimmed","trimCanvas","putImageData","_texture","_frame","_onTextureUpdate","setRealSize","_recursivePostUpdateTransform","updateText","call","calculateVertices","_bounds","addQuad","vertexData","metrics","gradient","dropShadowCorrection","fillGradientStops","lengthPlus1","fillGradientType","createLinearGradient","lastIterationStop","gradStopLineHeight","thisLineTop","globalStop","clampedStop","addColorStop","totalIterations","currentIteration","Object","assign","abs","s","sign","_width","_height","TextStyle","String","TextComponent","bgTextureId","bgTexture","textView","btnView","Container","btnW","btnH","textW","textH","TypewriterComponent","speed","printDelay","deltaTimer","ButtonComponent","tag","useAnimation","isBind","isClick","origin","clickEvent","removeAllListeners","TransformComponent","angle","TransparentComponent","alpha","SoundComponent","firstPlay","DisplacementComponent","end","duration","FadeComponent","PIXIRenderSystem","getComponent","configureSprite","transparent","pivot","scene","addSprite","TextUpdateSystem","Text","AnimationSystem","animation","gotoAndStop","TypewriterSystem","typewriter","time","charAt","removeComponent","string","TextButtonSystem","processButtonDown","processButtonUp","textC","btnC","TransformSystem","disp","Transform","Displacement","fade","Transparent","Fade","method","SoundSystem","BtnTypes","InputComponent","curEvent","preEvent","downPoint","readyClick","btnType","StoryComponent","curChapter","initialed","nodeIndex","subIndex","InputSystem","StorySystem","systemData","storyScript","Input","processStory","chapter","nodeCount","node","process","goto","removeAllEntity","BackgroundComponent","CGComponent","BGMComponent","CharacterComponent","DialogComponent","NameComponent","ChoiceComponent","RemoveComponent","RemoveSystem","removed","bgm","GroupMap","getGroup","createCurtain","targetId","typewriterOptions","changeVoiceover","curtain","up","entityId","down","voiceover","texts","createVoiceover","hide","wait","delay","timer","waitClick","storyData","callback","addTransform","configOption","setEntity","show_async","hide_async","shake","amplitude","fadeIn","fadeOut","baseShake","createDialog","changeDialog","textBackground","createName","removeName","auto","dialog","createComponent","addFade","fadeCompleted","xing_nai_1","xing_nai_2","xing_nai_2_1","xing_nai_3","xing_nai_4","xing_nai_5","xing_nai_6","xing_nai_7","xing_nai_map_1","xing_nai_map_2","sawa_1","sawa_2","sawa_3","sawa_4","sawa_5","sawa_6","sawa_7","sawa_8","xing_sha_1","xing_sha_2","liu_man_1","liu_man_2","createChar","character","entityIdList","flag","actions","gotoResult","createButton","action","list","util","colorText","chapter1","flow","chapter1_1","stage","chapter1_2","initRoadSignData","seaside","shopping","temple","park","hostel","townStreet","option11","roadSign","option12","option21","option22","option23","option1","choice","option2","chapter1_3","room","chapter1_4","east","common","west","chapter1_5","chapter1_5_1","commonStart","commonEnd","chapter1_5_2","chapter1_5_2end","commonStart1","commonStart2","chapter1_5_3","chapter1_5_3end","chapter1_5_4","chapter1_6","event0_1","event0_2","event0_1next","event0_2next","next","chapter2_1","eventSelected","length1","length2","roomEvent","chapter2_2","chapter2_2_1","chapter2_2_3","chapter2_2_3end","chapter2_2_5","chapter2_2_5next","chapter2_2_5end","commomOptions","next1","next2","next3","attack1","defense1","run1","attack2","defense2","run2","attack3","defense3","run3","battle","chapter2_3","firstEnter","chapter2_4","chapter2_4_1","chapter2_4_4","chapter2_4_5","chapter2","Main","game","_initWorldModule","_initData","engine","serialize","story","Rabbit","encrypt","decrypt","deserialize","log","Cutscene","registerPlugin","_update","begin","isPlay","updated","curScene","requestAnimationFrame","_updateRenderScale","_setSceneScale","cutscenes","CutsceneScene","prevScene","Stats","added","addPanel","Panel","showPanel","_initSoundModule","_initRenderModule","appendChild","loadState","devicePixelRatio","sceneClass","_cutscenesWait","addOnce","cutscenesWait","then","setTimeout","_changeScene","saveArchive","loadArchive","windowWidth","innerWidth","windowHeight","innerHeight","love_memory","LoveMemory","progressHandle","loadError","clickStartHandle","to","MainScene","menu","clickLoadHandle","clickSettingHandle","clickAboutHandle","openMenuHandle","closeMenuHandle","togglePanelHandle","removeStats","addStats","closeDialogHandle","dialogStatus","openSaveDialogHandle","openLoadDialogHandle","openBackTitleDialogHandle","confirmWarnHandle","backTitle","TitleScene","opacity","remove","pause","resume"],"mappings":"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","file":"static/js/4.aceffaa7.chunk.js","sourcesContent":["import React from 'react'\r\nimport './index.css'\r\n\r\nclass Loader extends React.Component {\r\n  constructor() {\r\n    super()\r\n    this.state = {\r\n      show: false\r\n    }\r\n  }\r\n\r\n  detailsHandle = () => {\r\n    this.setState({\r\n      show: !this.state.show\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { loading, progress, error } = this.props.loader\r\n    let style = 'loader'\r\n\r\n    if (this.state.show) {\r\n      style += ' open'\r\n    }\r\n\r\n    return (\r\n      <div className=\"loader-wrapper\" style={{display: loading ? 'block' : 'none'}}>\r\n        <div className=\"loader-container\">\r\n          <div className={style}>\r\n            <em style={{ width: `${progress}%` }}></em>\r\n            <div className=\"details-panel\">\r\n              <p>\r\n                <strong>Progress:</strong> <font>{`${progress}%`}</font>\r\n              </p>\r\n              {\r\n                error && (\r\n                  <p>\r\n                    <strong>Error:</strong> <font style={{color: 'red'}}>{'resource loading failed.'}</font>\r\n                  </p>\r\n                )\r\n              }\r\n            </div>\r\n          </div>\r\n          <div className=\"details button\" onClick={this.detailsHandle}>Details</div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Loader\r\n","import React from 'react'\r\nimport './index.css'\r\n\r\nfunction MenuIcon(props) {\r\n  function clickHandle(e) {\r\n    props.onClick && props.onClick(e)\r\n  }\r\n\r\n  return (\r\n    <div className=\"menu-icon\" onClick={clickHandle}>\r\n      <div className=\"top bar\"></div>\r\n      <div className=\"middle bar\"></div>\r\n      <div className=\"bottom bar\"></div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default MenuIcon\r\n","import React from 'react'\r\nimport { version } from '../../../package.json'\r\n\r\nfunction Header() {\r\n  return (\r\n    <div className=\"menu-title\">\r\n    <h1>\r\n      {''}\r\n      <p className=\"menu-subtitle\">\r\n        <span>{''}</span>\r\n        <span className=\"menu-version\">{`ver: ${version}`}</span>\r\n      </p>\r\n    </h1>\r\n    <h2>{'Love Memory'}</h2>\r\n  </div>\r\n  )\r\n}\r\n\r\nexport default Header\r\n","import React from 'react'\r\nimport './index.css'\r\n\r\nimport Header from './header'\r\n\r\nfunction MenuLayout(props) {\r\n  const style = {\r\n    display: props.show > 0 ? 'block' : 'none'\r\n  }\r\n  return (\r\n    <div className=\"menu-wrapper\" style={style}>\r\n      <div className=\"menu-container\">\r\n        <Header />\r\n        <div className=\"menu-content\">{props.children}</div>\r\n        <div className=\"close\" onClick={props.onClose}></div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default MenuLayout\r\n","import React from 'react'\r\n\r\nfunction Item(props) {\r\n  return (\r\n    <div className=\"config-item\">\r\n      <div className=\"config-name\">{props.name}</div>\r\n      <div className=\"config-content\">{props.children}</div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Item\r\n","import React from 'react'\r\nimport './index.css'\r\n\r\nfunction HexagonButton(props) {\r\n  function clickHandle(e) {\r\n    props.onClick && props.onClick(e)\r\n  }\r\n\r\n  return (\r\n    <div className=\"hexagon-button\">\r\n      <div onClick={clickHandle}>\r\n        <span>{props.children}</span>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default HexagonButton\r\n","import React from 'react'\r\nimport './index.css'\r\n\r\nfunction Switch(props) {\r\n  const { checked, onChange } = props\r\n  function changeHandle(e) {\r\n    const input = e.target\r\n    onChange && onChange(input.checked)\r\n  }\r\n\r\n  return (\r\n    <div className=\"switch-button\">\r\n      <input\r\n        className=\"switch-button-checkbox\"\r\n        type=\"checkbox\"\r\n        checked={checked}\r\n        onChange={changeHandle}\r\n      />\r\n      <div className=\"switch-button-handle\"></div>\r\n      <label className=\"switch-button-label\"></label>\r\n      <label className=\"switch-button-label\"></label>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Switch\r\n","import React from 'react'\r\nimport { Slider, Rail, Handles, Tracks } from 'react-compound-slider'\r\n\r\nconst sliderStyle = {\r\n  position: 'relative',\r\n  width: '100%',\r\n  touchAction: 'none'\r\n}\r\n\r\nfunction Volume(props) {\r\n  const { value = 80, onChange } = props\r\n  const domain = [0, 100]\r\n  function changeHandle(values) {\r\n    onChange && onChange(values[0])\r\n  }\r\n\r\n  return (\r\n    <Slider\r\n      mode={1}\r\n      step={1}\r\n      domain={domain}\r\n      rootStyle={sliderStyle}\r\n      onChange={changeHandle}\r\n      values={[value]}\r\n    >\r\n      <Rail>\r\n        {({ getRailProps }) => <SliderRail getRailProps={getRailProps} />}\r\n      </Rail>\r\n      <Handles>\r\n        {({ handles, getHandleProps }) => (\r\n          <div className=\"slider-handles\">\r\n            {handles.map(handle => (\r\n              <Handle\r\n                key={handle.id}\r\n                handle={handle}\r\n                domain={domain}\r\n                getHandleProps={getHandleProps}\r\n              />\r\n            ))}\r\n          </div>\r\n        )}\r\n      </Handles>\r\n      <Tracks right={false}>\r\n        {({ tracks, getTrackProps }) => (\r\n          <div className=\"slider-tracks\">\r\n            {tracks.map(({ id, source, target }) => (\r\n              <Track\r\n                key={id}\r\n                source={source}\r\n                target={target}\r\n                getTrackProps={getTrackProps}\r\n              />\r\n            ))}\r\n          </div>\r\n        )}\r\n      </Tracks>\r\n    </Slider>\r\n  )\r\n}\r\n\r\nexport default Volume\r\n\r\nconst railOuterStyle = {\r\n  position: 'absolute',\r\n  width: '100%',\r\n  height: 42,\r\n  transform: 'translate(0%, -50%)',\r\n  borderRadius: 7,\r\n  cursor: 'pointer'\r\n}\r\n\r\nconst railInnerStyle = {\r\n  position: 'absolute',\r\n  width: '100%',\r\n  height: 14,\r\n  transform: 'translate(0%, -50%)',\r\n  borderRadius: 7,\r\n  pointerEvents: 'none',\r\n  backgroundColor: 'rgb(155,155,155)'\r\n}\r\n\r\nconst SliderRail = ({ getRailProps }) => {\r\n  return (\r\n    <>\r\n      <div style={railOuterStyle} {...getRailProps()} />\r\n      <div style={railInnerStyle} />\r\n    </>\r\n  )\r\n}\r\n\r\nconst Handle = ({\r\n  domain: [min, max],\r\n  handle: { id, value, percent },\r\n  disabled = false,\r\n  getHandleProps\r\n}) => {\r\n  return (\r\n    <>\r\n      <div\r\n        style={{\r\n          left: `${percent}%`,\r\n          position: 'absolute',\r\n          transform: 'translate(-50%, -50%)',\r\n          WebkitTapHighlightColor: 'rgba(0,0,0,0)',\r\n          zIndex: 5,\r\n          width: 28,\r\n          height: 42,\r\n          cursor: 'pointer',\r\n          backgroundColor: 'none'\r\n        }}\r\n        {...getHandleProps(id)}\r\n      />\r\n      <div\r\n        role=\"slider\"\r\n        aria-valuemin={min}\r\n        aria-valuemax={max}\r\n        aria-valuenow={value}\r\n        style={{\r\n          left: `${percent}%`,\r\n          position: 'absolute',\r\n          transform: 'translate(-50%, -50%)',\r\n          zIndex: 2,\r\n          width: 24,\r\n          height: 24,\r\n          borderRadius: '50%',\r\n          boxShadow: '1px 1px 1px 1px rgba(0, 0, 0, 0.3)',\r\n          backgroundColor: disabled ? '#666' : '#9BBFD4'\r\n        }}\r\n      />\r\n    </>\r\n  )\r\n}\r\n\r\nconst Track = ({ source, target, getTrackProps, disabled = false }) => {\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'absolute',\r\n        transform: 'translate(0%, -50%)',\r\n        height: 14,\r\n        zIndex: 1,\r\n        backgroundColor: disabled ? '#999' : '#607E9E',\r\n        borderRadius: 7,\r\n        cursor: 'pointer',\r\n        left: `${source.percent}%`,\r\n        width: `${target.percent - source.percent}%`\r\n      }}\r\n      {...getTrackProps()}\r\n    />\r\n  )\r\n}\r\n","import Rabbit from 'crypto-js/rabbit'\r\nimport utf8 from 'crypto-js/enc-utf8'\r\n\r\n/**\r\n *  localStorage\r\n * @param storageKey localStorage \r\n * @param data \r\n */\r\nexport function saveToLocalStorage(storageKey: string, data: string) {\r\n  localStorage.setItem(storageKey, data)\r\n}\r\n\r\n/**\r\n *  localStorage \r\n * @param storageKey localStorage \r\n * @param force \r\n */\r\nexport function loadFromLocalStorage(storageKey: string, force: boolean = false) {\r\n  const data = localStorage.getItem(storageKey)\r\n  if (!data && force === false) {\r\n    console.warn(`No data with the key value \"${storageKey}\" in localStorage.`)\r\n  }\r\n  return data\r\n}\r\n\r\n/**\r\n *  localStorage \r\n * @param storageKey localStorage \r\n */\r\nexport function removeFromLocalStorage(storageKey: string) {\r\n  localStorage.removeItem(storageKey)\r\n}\r\n\r\n/**\r\n * time33 \r\n * @param text \r\n */\r\nexport function time33(text: string) {\r\n  for (var i = 0, len = text.length, hash = 5381; i < len; ++i) {\r\n    hash += (hash << 5) + text.charAt(i).charCodeAt(0)\r\n  }\r\n  return hash & 0x7fffffff\r\n}\r\n\r\n/**  */\r\nconst key = utf8.parse('JQfTTft92kQ4').toString()\r\n\r\n/**\r\n *  rabbit \r\n * @param text \r\n */\r\nexport function encryptByRabbit(text: string) {\r\n  return Rabbit.encrypt(text, key).toString()\r\n}\r\n\r\n/**\r\n *  rabbit \r\n * @param text \r\n */\r\nexport function decryptByRabbit(text: string) {\r\n  const bytes = Rabbit.decrypt(text, key)\r\n  const originalText = bytes.toString(utf8)\r\n  return originalText\r\n}\r\n","import * as PIXI from 'pixi.js'\r\nimport sound from 'pixi-sound'\r\nimport { saveToLocalStorage, loadFromLocalStorage } from '../utils'\r\n\r\ntype PlayOptions = {\r\n  start?: number\r\n  end?: number\r\n  speed?: number\r\n  loop?: boolean\r\n  volume?: number\r\n  sprite?: string\r\n  muted?: boolean\r\n  complete?: any\r\n  loaded?: any\r\n}\r\n\r\nexport class Sound {\r\n  static muted = false\r\n\r\n  static set volume(value: number) {\r\n    sound.volumeAll = value\r\n  }\r\n\r\n  static get volume() {\r\n    return sound.volumeAll\r\n  }\r\n\r\n  static play(alias: string, options?: PlayOptions) {\r\n    sound.play(alias, options)\r\n  }\r\n\r\n  static stop(alias: string) {\r\n    sound.stop(alias)\r\n  }\r\n\r\n  static stopAll() {\r\n    sound.stopAll()\r\n  }\r\n\r\n  static mute() {\r\n    this.muted = true\r\n    sound.muteAll()\r\n  }\r\n\r\n  static unmute() {\r\n    this.muted = false\r\n    sound.unmuteAll()\r\n  }\r\n\r\n  static saveState() {\r\n    const state = {\r\n      muted: this.muted,\r\n      volume: this.volume\r\n    }\r\n    saveToLocalStorage('sound', JSON.stringify(state))\r\n  }\r\n\r\n  static loadState() {\r\n    const state = JSON.parse(loadFromLocalStorage('sound', true))\r\n    if (state) {\r\n      this.muted = state.muted\r\n      this.volume = state.volume\r\n\r\n      if (this.muted === true) {\r\n        this.mute()\r\n      }\r\n    } else {\r\n      this.volume = 0.8\r\n    }\r\n  }\r\n\r\n  private sound: PIXI.sound.Sound\r\n\r\n  constructor(public alias: string) {\r\n    this.sound = sound.find(alias)\r\n  }\r\n\r\n  get isPlaying() {\r\n    return this.sound.isPlaying\r\n  }\r\n\r\n  public play(options?: PlayOptions) {\r\n    this.sound.play(options)\r\n  }\r\n\r\n  public stop() {\r\n    this.sound.stop()\r\n  }\r\n}\r\n","import React from 'react'\r\nimport './index.css'\r\n\r\nimport Item from './item'\r\nimport HexagonButton from '../hexagon-button'\r\nimport Switch from '../switch'\r\nimport Volume from './volume'\r\n\r\nimport { Sound } from '../../engine/sound'\r\n\r\nclass Config extends React.PureComponent {\r\n  constructor() {\r\n    super()\r\n    this.data = React.createRef()\r\n    this.state = {\r\n      checked: false\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.setState({\r\n      checked: !Sound.muted,\r\n      volume: Sound.volume\r\n    })\r\n  }\r\n\r\n  switchHandle = checked => {\r\n    if (checked) {\r\n      Sound.unmute()\r\n    } else {\r\n      Sound.mute()\r\n    }\r\n    Sound.saveState()\r\n    this.setState({\r\n      checked\r\n    })\r\n  }\r\n\r\n  volumeHandle = value => {\r\n    Sound.volume = value / 100\r\n    Sound.saveState()\r\n  }\r\n\r\n  exportHandle = () => {\r\n    const textarea = this.data.current\r\n    const data = this.props.getArchive() || ''\r\n    textarea.value = data\r\n  }\r\n\r\n  selectAllHandle = () => {\r\n    const textarea = this.data.current\r\n    textarea.select()\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"game-config\">\r\n        <section>\r\n          <h3 className=\"game-config-title\"></h3>\r\n          <Item name=\"\"><Switch checked={this.state.checked} onChange={this.switchHandle} /></Item>\r\n          <Item name=\"\"><Volume value={Sound.volume * 100} onChange={this.volumeHandle} /></Item>\r\n          <HexagonButton onClick={this.props.onPanel}>on/off<br /></HexagonButton>\r\n          {\r\n            this.props.show === 3 && (\r\n              <>\r\n                <HexagonButton onClick={this.props.onSave}></HexagonButton>\r\n                <HexagonButton onClick={this.props.onLoad}></HexagonButton>\r\n                <HexagonButton onClick={this.props.onBack}></HexagonButton>\r\n              </>\r\n            )\r\n          }\r\n        </section>\r\n        <section>\r\n          <h3 className=\"game-config-title\"></h3>\r\n          <textarea className=\"game-input-data\" ref={this.data}></textarea>\r\n          <div className=\"game-data-options\">\r\n            <button onClick={this.exportHandle}></button>\r\n            <button onClick={this.selectAllHandle}></button>\r\n            <button></button>\r\n          </div>\r\n        </section>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Config\r\n","import React from 'react'\r\n\r\nfunction Card(props) {\r\n  const { title, url, content } = props.item\r\n  return (\r\n    <div className=\"about-item\">\r\n      <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\r\n        <p className=\"about-item-title\">{title}</p>\r\n        {url && <p className=\"about-item-content\">{url}</p>}\r\n        {content && <p className=\"about-item-content\">{content}</p>}\r\n      </a>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Card\r\n","export const stageInfo = {\r\n  width: 480,\r\n  height: 576\r\n}","import { version } from '../../../package.json'\r\n\r\nexport const about = [\r\n  {\r\n    title: '',\r\n    content: version\r\n  },\r\n  {\r\n    title: 'Blog',\r\n    url: 'https://xxxxxxxxx.net/'\r\n  },\r\n  {\r\n    title: 'Email',\r\n    url: '/'\r\n  },\r\n  {\r\n    title: 'Github',\r\n    url: 'https://github.com/LuckyRabbitFeet'\r\n  },\r\n  {\r\n    title: 'Bug',\r\n    url: 'xxxxxxxxxxx'\r\n  },\r\n  {\r\n    title: 'License',\r\n    content: 'MIT'\r\n  }\r\n]","export const assetRootUrl =\r\n  process.env.NODE_ENV === 'development'\r\n    ? process.env.PUBLIC_URL\r\n    : 'https://cdn.jsdelivr.net/gh/LuckyRabbitFeet/temp@main/'\r\n\r\nexport const assets = [\r\n  // fonts\r\n  'assets/fonts/SourceHanSansSC-Regular.woff',\r\n  'assets/fonts/SourceHanSansSC-Bold.woff',\r\n  // images\r\n  'assets/images/map01.json',\r\n  'assets/images/map02.json',\r\n  'assets/images/map03.json',\r\n  // images/system\r\n  'assets/images/system/title_gold.json',\r\n  'assets/images/system/system.json',\r\n  // images/file\r\n  'assets/images/file/1001.json',\r\n  'assets/images/file/1002.json',\r\n  'assets/images/file/1003.json',\r\n  'assets/images/file/1004.json',\r\n  'assets/images/file/1005.json',\r\n  'assets/images/file/1006.json',\r\n  'assets/images/file/1007.json',\r\n  'assets/images/file/1008-1010.json',\r\n  'assets/images/file/2001.json',\r\n  'assets/images/file/2002-2004.json',\r\n  'assets/images/file/3001.json',\r\n  'assets/images/file/3002.json',\r\n  'assets/images/file/3003-3005.json',\r\n  'assets/images/file/4001.json',\r\n  'assets/images/file/4002.json',\r\n  // sound\r\n  {\r\n    name: 'funny',\r\n    url: 'assets/sound/funny.mp3',\r\n    onComplete: soundMiddleware\r\n  },\r\n  {\r\n    name: 'happy',\r\n    url: 'assets/sound/happy.mp3',\r\n    onComplete: soundMiddleware\r\n  },\r\n  {\r\n    name: 'hope',\r\n    url: 'assets/sound/hope.mp3',\r\n    onComplete: soundMiddleware\r\n  },\r\n  {\r\n    name: 'memory',\r\n    url: 'assets/sound/memory.mp3',\r\n    onComplete: soundMiddleware\r\n  },\r\n  {\r\n    name: 'nerves',\r\n    url: 'assets/sound/nerves.mp3',\r\n    onComplete: soundMiddleware\r\n  },\r\n  {\r\n    name: 'night',\r\n    url: 'assets/sound/night.mp3',\r\n    onComplete: soundMiddleware\r\n  },\r\n  {\r\n    name: 'romantix',\r\n    url: 'assets/sound/romantix.mp3',\r\n    onComplete: soundMiddleware\r\n  },\r\n  {\r\n    name: 'sad',\r\n    url: 'assets/sound/sad.mp3',\r\n    onComplete: soundMiddleware\r\n  },\r\n  {\r\n    name: 'shopping',\r\n    url: 'assets/sound/shopping.mp3',\r\n    onComplete: soundMiddleware\r\n  },\r\n  {\r\n    name: 'system_over',\r\n    url: 'assets/sound/system_over.mp3',\r\n    onComplete: soundMiddleware\r\n  },\r\n  {\r\n    name: 'system_title',\r\n    url: 'assets/sound/system_title.mp3',\r\n    onComplete: soundMiddleware\r\n  }\r\n]\r\n\r\nfunction soundMiddleware(resource) {\r\n  resource.sound.singleInstance = true\r\n}\r\n","const baseSrtle = {\r\n  fontFamily: ['Source Han Sans SC', 'Arial', 'sans-serif'],\r\n  fontWeight: 'bold',\r\n  fontSize: 20,\r\n  lineJoin: 'round',\r\n  fill: '#ffffff',\r\n  stroke: '#000000',\r\n  strokeThickness: 3\r\n}\r\n\r\nexport const startMenuStyle = {\r\n  ...baseSrtle,\r\n  fontSize: 22,\r\n  fill: '#6D8CD4',\r\n  stroke: '#ffffff'\r\n}\r\n\r\nexport const buttonStyle = baseSrtle\r\n\r\nexport const voiceoverStyle = baseSrtle\r\n\r\nexport const nameStyle = baseSrtle\r\n\r\nexport const dialogStyle = baseSrtle\r\n\r\nexport const background = {\r\n  button: {\r\n    id: 'button',\r\n    width: 220,\r\n    height: 45,\r\n    padding: 3\r\n  },\r\n  name: {\r\n    id: 'name_frame',\r\n    height: 44,\r\n    padding: 0\r\n  },\r\n  dialog: {\r\n    id: 'speak_frame',\r\n    height: 126,\r\n    padding: 12\r\n  }\r\n}","// \r\nexport const eyes = {\r\n  '1001_e': {\r\n    res: ['1001_e-0', '1001_e-1', '1001_e-2', '1001_e-1', '1001_e-0'],\r\n    layer: 1,\r\n    x: 180,\r\n    y: 158\r\n  },\r\n  '1002_e': {\r\n    res: ['1002_e-0', '1002_e-1', '1002_e-2', '1002_e-1', '1002_e-0'],\r\n    layer: 1,\r\n    x: 180,\r\n    y: 158\r\n  },\r\n  '1003_e': ['1003_e-0', '1003_e-1', '1003_e-2', '1003_e-1', '1003_e-0'],\r\n  '1004_e': {\r\n    res: ['1004_e-0', '1004_e-1', '1004_e-2', '1004_e-1', '1004_e-0'],\r\n    layer: 1,\r\n    x: 180,\r\n    y: 160\r\n  },\r\n  '1005_e': {\r\n    res: ['1005_e-0', '1005_e-1', '1005_e-2', '1005_e-1', '1005_e-0'],\r\n    layer: 1,\r\n    x: 180,\r\n    y: 158\r\n  },\r\n  '1006_e': {\r\n    res: ['1006_e-0', '1006_e-1', '1006_e-2', '1006_e-1', '1006_e-0'],\r\n    layer: 1,\r\n    x: 180,\r\n    y: 158\r\n  },\r\n  '1007_e': {\r\n    res: ['1007_e-0', '1007_e-1', '1007_e-2', '1007_e-1', '1007_e-0'],\r\n    layer: 1,\r\n    x: 180,\r\n    y: 155\r\n  },\r\n  '1008_e': {\r\n    res: '1008_e',\r\n    layer: 1,\r\n    x: 180,\r\n    y: 157\r\n  },\r\n  '1009_e': ['1009_e-0', '1009_e-1', '1009_e-2', '1009_e-1', '1009_e-0'],\r\n  '1010_e': {\r\n    res: '1010_e',\r\n    layer: 1,\r\n    x: 180,\r\n    y: 154\r\n  },\r\n  '2001_e': {\r\n    res: ['2001_e-0', '2001_e-1', '2001_e-2', '2001_e-1', '2001_e-0'],\r\n    layer: 1,\r\n    x: 173,\r\n    y: 158\r\n  },\r\n  '2002_e': ['2002_e-0', '2002_e-1', '2002_e-2', '2002_e-1', '2002_e-0'],\r\n  '2003_e': {\r\n    res: ['2003_e-0', '2003_e-1', '2003_e-2', '2003_e-1', '2003_e-0'],\r\n    layer: 1,\r\n    x: 173,\r\n    y: 158\r\n  },\r\n  '2004_e': ['2004_e-0', '2004_e-1', '2004_e-2', '2004_e-1', '2004_e-0'],\r\n  '3001_e': {\r\n    res: ['3001_e-0', '3001_e-1', '3001_e-2', '3001_e-1', '3001_e-0'],\r\n    layer: 1,\r\n    x: 167,\r\n    y: 157\r\n  },\r\n  '3002_e': {\r\n    res: ['3002_e-0', '3002_e-1', '3002_e-2', '3002_e-1', '3002_e-0'],\r\n    layer: 1,\r\n    x: 169,\r\n    y: 160\r\n  },\r\n  '3003_e': {\r\n    res: ['3003_e-0', '3003_e-1', '3003_e-2', '3003_e-1', '3003_e-0'],\r\n    layer: 1,\r\n    x: 169,\r\n    y: 161\r\n  },\r\n  '3004_e': {\r\n    res: ['3004_e-0', '3004_e-1', '3004_e-2', '3004_e-1', '3004_e-0'],\r\n    layer: 1,\r\n    x: 167,\r\n    y: 156\r\n  },\r\n  '3005_e': {\r\n    res: '3005_e',\r\n    layer: 1,\r\n    x: 167,\r\n    y: 155\r\n  },\r\n  '4001_e': {\r\n    res: ['4001_e-0', '4001_e-1', '4001_e-2', '4001_e-1', '4001_e-0'],\r\n    layer: 1,\r\n    x: 200,\r\n    y: 122\r\n  },\r\n  '4002_e': {\r\n    res: ['4002_e-0', '4002_e-1', '4002_e-2', '4002_e-1', '4002_e-0'],\r\n    layer: 1,\r\n    x: 232,\r\n    y: 100\r\n  }\r\n}","// \r\nexport const mouth = {\r\n  '1001_m-01': {\r\n    res: '1001_m-01',\r\n    layer: 1,\r\n    x: 218,\r\n    y: 225\r\n  },\r\n  '1001_m-02': {\r\n    res: '1001_m-02',\r\n    layer: 1,\r\n    x: 217,\r\n    y: 224\r\n  },\r\n  '1001_m-03': {\r\n    res: '1001_m-03',\r\n    layer: 1,\r\n    x: 217,\r\n    y: 224\r\n  },\r\n  '1001_m-04': {\r\n    res: '1001_m-04',\r\n    layer: 1,\r\n    x: 218,\r\n    y: 225\r\n  },\r\n  '1001_m-05': {\r\n    res: '1001_m-05',\r\n    layer: 1,\r\n    x: 217,\r\n    y: 224\r\n  },\r\n  '1001_m-06': {\r\n    res: '1001_m-06',\r\n    layer: 1,\r\n    x: 218,\r\n    y: 224\r\n  },\r\n  '1001_m-07': {\r\n    res: '1001_m-07',\r\n    layer: 1,\r\n    x: 218,\r\n    y: 224\r\n  },\r\n  '1003_m': {\r\n    res: '1003_m',\r\n    layer: 1,\r\n    x: 216,\r\n    y: 226\r\n  },\r\n  '2001_m-01': {\r\n    res: '2001_m-01',\r\n    layer: 1,\r\n    x: 209,\r\n    y: 222\r\n  },\r\n  '2001_m-03': {\r\n    res: '2001_m-03',\r\n    layer: 1,\r\n    x: 209,\r\n    y: 224\r\n  },\r\n  '3001_m-01': {\r\n    res: '3001_m-01',\r\n    layer: 1,\r\n    x: 209,\r\n    y: 226\r\n  },\r\n  '3001_m-02': {\r\n    res: '3001_m-02',\r\n    layer: 1,\r\n    x: 213,\r\n    y: 222\r\n  },\r\n  '3001_m-03': {\r\n    res: '3001_m-03',\r\n    layer: 1,\r\n    x: 211,\r\n    y: 226\r\n  },\r\n  '3001_m-04': {\r\n    res: '3001_m-04',\r\n    layer: 1,\r\n    x: 215,\r\n    y: 226\r\n  },\r\n  '3002_m': {\r\n    res: '3002_m',\r\n    layer: 1,\r\n    x: 209,\r\n    y: 219\r\n  }\r\n}","// \r\nexport const head = {\r\n  '1001_he': {\r\n    res: '1001_he',\r\n    layer: 0,\r\n    x: 146,\r\n    y: 46\r\n  },\r\n  '3001_he': {\r\n    res: '3001_he',\r\n    layer: 0,\r\n    x: 97,\r\n    y: 30\r\n  },\r\n  '4001_he': {\r\n    res: '4001_he',\r\n    layer: 0,\r\n    x: 142,\r\n    y: 30\r\n  },\r\n  '4002_he': {\r\n    res: '4002_he',\r\n    layer: 0,\r\n    x: 142,\r\n    y: 30\r\n  },\r\n}","// \r\nexport const body = {\r\n  '1001_b': {\r\n    res: '1001_b',\r\n    layer: 1,\r\n    x: 110,\r\n    y: 292\r\n  },\r\n  '1002_b': '1002_b',\r\n  '1003_b': '1003_b',\r\n  '2001_b': {\r\n    res: '2001_b',\r\n    layer: 0,\r\n    x: 73,\r\n    y: 48\r\n  },\r\n  '3001_b': {\r\n    res: '3001_b',\r\n    layer: 1,\r\n    x: 77,\r\n    y: 272\r\n  },\r\n  '3002_b': {\r\n    res: '3002_b',\r\n    layer: 1,\r\n    x: 97,\r\n    y: 272\r\n  },\r\n  '4001_b': {\r\n    res: '4001_b',\r\n    layer: 1,\r\n    x: 62,\r\n    y: 258\r\n  }\r\n}","// \r\nexport const hand = {\r\n  '1001_ha': {\r\n    res: '1001_ha',\r\n    layer: 0,\r\n    x: 102,\r\n    y: 346\r\n  },\r\n  '1002_ha': {\r\n    res: '1002_ha',\r\n    layer: 0,\r\n    x: 290,\r\n    y: 362\r\n  },\r\n  '1005_ha': {\r\n    res: '1005_ha',\r\n    layer: 2,\r\n    x: 96,\r\n    y: 340\r\n  },\r\n  '1007_ha': {\r\n    res: '1007_ha',\r\n    layer: 2,\r\n    x: 92,\r\n    y: 329\r\n  }\r\n}","// map\r\nexport const map = {\r\n  // body\r\n  'map02001': {\r\n    res: 'map02001',\r\n    layer: 1,\r\n    x: 48,\r\n    y: 0\r\n  },\r\n  'map02002': 'map02002',\r\n  'map02003': 'map02003',\r\n\r\n  // face\r\n  'map02001a': 'map02001a',\r\n  'map02001b': 'map02001b',\r\n  'map02001c': 'map02001c',\r\n  'map02001d': {\r\n    res: 'map02001d',\r\n    layer: 2,\r\n    x: 96,\r\n    y: 192\r\n  },\r\n  'map02001f': {\r\n    res: 'map02001f',\r\n    layer: 2,\r\n    x: 96,\r\n    y: 192\r\n  },\r\n  'map02001g': 'map02001g',\r\n  'map02001h': 'map02001h',\r\n}","const lightskyblue = '#87cefa'\r\n\r\nconst burlywood = '#deb887'\r\n\r\nconst deepskyblue = '#00bfff'\r\n\r\nconst tomato = '#ff6347'\r\n\r\nexport default {\r\n  lightskyblue,\r\n  burlywood,\r\n  deepskyblue,\r\n  tomato\r\n}","import React from 'react'\r\nimport './index.css'\r\n\r\nimport Card from './card'\r\n\r\nimport { about } from '../../game/config'\r\n\r\nfunction About() {\r\n  return (\r\n    <div className=\"game-about\">\r\n      {about.map(item => <Card key={item.title} item={item} />)}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default About\r\n","import React from 'react'\r\nimport ReactModal from 'react-modal'\r\n\r\nfunction SaveDialog(props) {\r\n  const { isOpen, onClose, status } = props\r\n\r\n  function closeHandle(e) {\r\n    onClose && onClose(e)\r\n  }\r\n\r\n  return (\r\n    <ReactModal\r\n      isOpen={isOpen}\r\n      closeTimeoutMS={200}\r\n      ariaHideApp={false}\r\n      contentLabel=\"save dialog\"\r\n      style={{\r\n        overlay: {\r\n          display: 'flex',\r\n          justifyContent: 'center',\r\n          alignItems: 'center',\r\n          zIndex: 6,\r\n          backgroundColor: null\r\n        }\r\n      }}\r\n      className=\"dialog\"\r\n    >\r\n      <div className=\"dialog-container\">\r\n        <div className=\"dialog-content\">\r\n          <div className=\"dialog-icon\">\r\n            {\r\n              status === 'saving'\r\n                ? (\r\n                  <div className=\"spinner-box\">\r\n                    <div className=\"circle-border\">\r\n                      <div className=\"circle-core\"></div>\r\n                    </div>\r\n                  </div>\r\n                )\r\n                : (\r\n                  <div className=\"sa-success\">\r\n                    <div className=\"sa-success-tip\"></div>\r\n                    <div className=\"sa-success-long\"></div>\r\n                    <div className=\"sa-success-placeholder\"></div>\r\n                    <div className=\"sa-success-fix\"></div>\r\n                  </div>\r\n                )\r\n            }\r\n          </div>\r\n          <div className=\"dialog-text\">\r\n            { status === 'saving' ? 'Saving...' : 'Saved.' }\r\n          </div>\r\n        </div>\r\n        <div className=\"dialog-interaction\">\r\n          <div\r\n            className=\"dialog-button\"\r\n            style={{\r\n              margin: status === 'saving' ? -55 : 0\r\n            }}\r\n          >\r\n            <button onClick={closeHandle}>OK</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </ReactModal>\r\n  )\r\n}\r\n\r\nexport default SaveDialog\r\n","import React from 'react'\r\nimport ReactModal from 'react-modal'\r\n\r\nfunction WarningDialog(props) {\r\n  const { isOpen, onConfirm, onClose } = props\r\n\r\n  function yesHandle(e) {\r\n    onConfirm && onConfirm(e)\r\n  }\r\n\r\n  function noHandle(e) {\r\n    onClose && onClose(e)\r\n  }\r\n\r\n  return (\r\n    <ReactModal\r\n      isOpen={isOpen}\r\n      closeTimeoutMS={200}\r\n      ariaHideApp={false}\r\n      contentLabel=\"warning dialog\"\r\n      style={{\r\n        overlay: {\r\n          display: 'flex',\r\n          justifyContent: 'center',\r\n          alignItems: 'center',\r\n          zIndex: 6,\r\n          backgroundColor: null\r\n        }\r\n      }}\r\n      className=\"dialog\"\r\n    >\r\n      <div className=\"dialog-container\">\r\n        <div className=\"dialog-content\">\r\n          <div className=\"dialog-icon\">\r\n            <div className=\"sa-warning\">\r\n              <span className=\"sa-warning-body\"></span>\r\n              <span className=\"sa-warning-dot\"></span>\r\n            </div>\r\n          </div>\r\n          <div className=\"dialog-text\" style={{\r\n            lineHeight: 1.2,\r\n            textAlign: 'left',\r\n            paddingTop: 5,\r\n            paddingLeft: 80\r\n          }}>\r\n            \r\n          </div>\r\n        </div>\r\n        <div className=\"dialog-interaction\">\r\n          <div\r\n            className=\"dialog-button\"\r\n            style={{\r\n              margin: 0\r\n            }}\r\n          >\r\n            <button className=\"dialog-button-yes\" onClick={yesHandle}>Yes</button>\r\n            <button className=\"dialog-button-no\" onClick={noHandle}>No</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </ReactModal>\r\n  )\r\n}\r\n\r\nexport default WarningDialog\r\n","import * as PIXI from 'pixi.js'\r\nimport 'pixi-sound'\r\nimport { Signal } from 'signals'\r\n\r\nexport default class Loader {\r\n  public source: PIXI.Loader\r\n  public loaded: boolean\r\n  public assets: any[] | undefined\r\n  public onProgressed: Signal\r\n  public onCompleted: Signal\r\n\r\n  constructor(baseUrl?: string, concurrency?: number) {\r\n    this.source = new PIXI.Loader(baseUrl, concurrency)\r\n    this.loaded = false\r\n    this.onProgressed = new Signal()\r\n    this.onCompleted = new Signal()\r\n  }\r\n\r\n  public load(assets: any[]): Promise<any> {\r\n    if (this.loaded === true) {\r\n      return Promise.resolve(this.source.resources)\r\n    }\r\n\r\n    this.assets = assets\r\n    this.source\r\n      .add(assets)\r\n      .on('progress', this._onProgress.bind(this))\r\n      .on('complete', this._onComplete.bind(this))\r\n\r\n    return new Promise((resolve, reject) => {\r\n      this.source\r\n        .on('error', this._onError(reject))\r\n        .load(this._onLoad(resolve))\r\n    })\r\n  }\r\n\r\n  private _onProgress(loader: PIXI.Loader, resource: PIXI.LoaderResource) {\r\n    this.onProgressed.dispatch(loader.progress, resource)\r\n  }\r\n\r\n  private _onComplete(loader: PIXI.Loader, resources: PIXI.IResourceDictionary) {\r\n    this.onCompleted.dispatch(loader.progress, resources)\r\n  }\r\n\r\n  private _onError(reject: (...args: any[]) => void) {\r\n    return (error: Error) => {\r\n      this.source.reset()\r\n      reject(error)\r\n    }\r\n  }\r\n\r\n  private _onLoad(resolve: (...args: any[]) => void) {\r\n    return (loader: PIXI.Loader, resources: PIXI.IResourceDictionary) => {\r\n      this.loaded = true\r\n      resolve(resources)\r\n    }\r\n  }\r\n}\r\n","import * as PIXI from 'pixi.js'\r\n\r\nexport type options = {\r\n  width?: number\r\n  height?: number\r\n  view?: HTMLCanvasElement\r\n  transparent?: boolean\r\n  autoDensity?: boolean\r\n  antialias?: boolean\r\n  forceFXAA?: boolean\r\n  resolution?: number\r\n  clearBeforeRender?: boolean\r\n  preserveDrawingBuffer?: boolean\r\n  backgroundColor?: number\r\n  powerPreference?: string\r\n  context?: any\r\n}\r\n\r\ntype Plugins = {\r\n  [key: string]: any\r\n}\r\n\r\nexport class Renderer {\r\n  static readonly plugins: Plugins = {}\r\n\r\n  private renderer: PIXI.Renderer\r\n  public readonly plugins: Plugins\r\n\r\n  constructor(options?: options) {\r\n    options = {\r\n      antialias: true, // \r\n      ...options\r\n    }\r\n    this.renderer = PIXI.autoDetectRenderer(options)\r\n    this.plugins = {}\r\n    for (const pluginKey in Renderer.plugins) {\r\n      this.plugins[pluginKey] = new Renderer.plugins[pluginKey](\r\n        this.renderer,\r\n        options\r\n      )\r\n    }\r\n    this.renderer.plugins.interaction.autoPreventDefault = false\r\n    this.renderer.view.style.touchAction = 'auto'\r\n  }\r\n\r\n  static registerPlugin(id: string, pluginClass: () => any): void {\r\n    this.plugins[id] = pluginClass\r\n  }\r\n\r\n  get view() {\r\n    return this.renderer.view\r\n  }\r\n\r\n  public render(view: PIXI.Container) {\r\n    this.renderer.render(view)\r\n  }\r\n\r\n  public resize(width: number, height: number) {\r\n    this.renderer.autoDensity = true\r\n    this.renderer.resize(width, height)\r\n  }\r\n}\r\n\r\n/**\r\n * NOTE: PIXI Text \r\n * \r\n * \r\n *  Text \r\n * \r\n * NOTE:  lib  Rainbow Text \r\n *\r\n * 1~ breakWords \r\n * 2tokenize  TextMetrics  @ts-ignore  ts \r\n * : http://ts8zs.com/?p=309\r\n */\r\n// @ts-ignore\r\n// PIXI.TextMetrics.tokenize = function (text: string) {\r\n//   const tokens: string[] = []\r\n//   let token = ''\r\n//   if (typeof text !== 'string') {\r\n//     return tokens\r\n//   }\r\n\r\n//   for (let i = 0; i < text.length; i++) {\r\n//     const char = text[i]\r\n//     if (!/[a-z'-]/i.test(char)) {\r\n//       if (token !== '') {\r\n//         tokens.push(token)\r\n//         token = ''\r\n//       }\r\n//       tokens.push(char)\r\n//     } else {\r\n//       token += char\r\n//     }\r\n//   }\r\n\r\n//   if (token !== '') {\r\n//     tokens.push(token)\r\n//   }\r\n\r\n//   return tokens\r\n// }\r\n","/**  */\r\nexport class ObjectPool<T> {\r\n  private static pools: WeakMap<\r\n    { new (...args: any[]): any },\r\n    ObjectPool<any>\r\n    > = new WeakMap()\r\n  // \r\n  private freed: T[] = []\r\n  // \r\n  private capacity: number = 100\r\n  // \r\n  private size: number = 0\r\n\r\n  /**\r\n   * \r\n   * @param ObjectClass \r\n   * @returns \r\n   */\r\n  public static of<T>(ObjectClass: { new (...args: any[]): T }) {\r\n    let pool = this.pools.get(ObjectClass)\r\n    if (pool === undefined) {\r\n      this.pools.set(ObjectClass, (pool = new ObjectPool<T>(ObjectClass)))\r\n    }\r\n    return pool as ObjectPool<T>\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param ObjectClass \r\n   */\r\n  public static free<T>(ObjectClass: { new (...args: any[]): T }) {\r\n    const pool = this.pools.get(ObjectClass)\r\n    if (pool) {\r\n      pool.clear()\r\n      this.pools.delete(ObjectClass)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param ObjectClass \r\n   */\r\n  constructor(private ObjectClass: { new (...args: any[]): T }) {}\r\n\r\n  /**\r\n   * \r\n   * @returns \r\n   */\r\n  public acquire() {\r\n    if (this.freed.length <= 0) {\r\n      this.expand()\r\n    }\r\n\r\n    const item = this.freed.pop()\r\n\r\n    return item as T\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param item \r\n   */\r\n  public release(item: T) {\r\n    this.freed.push(item)\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  public clear() {\r\n    this.freed.length = 0\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  public expand() {\r\n    const count = Math.round(this.capacity * 0.2)\r\n    for (let i = 0; i < count; i++) {\r\n      const item = new this.ObjectClass()\r\n      this.freed.push(item)\r\n    }\r\n    this.size += count\r\n    if (this.size >= this.capacity) {\r\n      this.capacity += this.size\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @returns \r\n   */\r\n  public totalSize() {\r\n    return this.size\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @returns \r\n   */\r\n  public totalFree() {\r\n    return this.freed.length\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @returns \r\n   */\r\n  public totalUsed() {\r\n    return this.size - this.freed.length\r\n  }\r\n}\r\n","import { Signal } from 'signals'\r\nimport { ObjectPool } from './object-pool'\r\nimport { Entity } from './entity'\r\n\r\nexport type IComponentProps = {\r\n  [propName: string]: any\r\n}\r\n\r\nexport type IComponentClass<T extends IComponent> = {\r\n  new(): T\r\n  onComponentCreated: Signal\r\n  onComponentDestroyed: Signal\r\n  _id: string\r\n  _isRegister: boolean\r\n  _isComponent: boolean\r\n  _componentClassMap: Map<string, IComponentClass<IComponent>>\r\n  _pools: Map<string, ObjectPool<IComponent>>\r\n  create(\r\n    entity: Entity,\r\n    componentClass: IComponentClass<IComponent>,\r\n    values?: IComponentProps\r\n  ): IComponent\r\n  destory(componentClass: IComponentClass<IComponent>, component: IComponent): void\r\n}\r\n\r\n/**\r\n * \r\n * @param id  id\r\n * @returns \r\n */\r\nexport function componentRegister(id: string) {\r\n  return function (target: IComponentClass<IComponent>) {\r\n    if (IComponent._componentClassMap.has(id)) {\r\n      console.warn(\r\n        `Component id: '${id}' already registered.`\r\n      )\r\n    } else {\r\n      target._id = id\r\n      target._isRegister = true\r\n      IComponent._componentClassMap.set(id, target)\r\n      // \r\n      if (!IComponent._pools.has(id)) {\r\n        IComponent._pools.set(id, ObjectPool.of(target))\r\n      }\r\n    }\r\n    return target\r\n  }\r\n}\r\n\r\n/**  */\r\nexport class IComponent {\r\n  /**  */\r\n  public static readonly onComponentCreated: Signal = new Signal()\r\n  /**  */\r\n  public static readonly onComponentDestroyed: Signal = new Signal()\r\n\r\n  public static _id: string\r\n  public static _isRegister: boolean = false\r\n  public static _isComponent: boolean = true\r\n  public static _componentClassMap: Map<string, IComponentClass<IComponent>> = new Map()\r\n  public static _pools: Map<string, ObjectPool<IComponent>> = new Map()\r\n  private entity?: Entity = null\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   * @param componentClass \r\n   * @returns \r\n   */\r\n  public static create(\r\n    entity: Entity,\r\n    componentClass: IComponentClass<IComponent>,\r\n    values?: IComponentProps\r\n  ) {\r\n    // const component = new componentClass()\r\n    const pool = this._pools.get(componentClass._id)\r\n    const component = pool.acquire()\r\n    component.entity = entity\r\n    if (values) {\r\n      component._setProps(values)\r\n    }\r\n    component.init()\r\n    this.onComponentCreated.dispatch({\r\n      componentClass,\r\n      component,\r\n      entity\r\n    })\r\n    return component\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param componentClass \r\n   * @param component \r\n   */\r\n  public static destory(componentClass: IComponentClass<IComponent>, component: IComponent) {\r\n    const pool = this._pools.get(componentClass._id)\r\n\r\n    this.onComponentDestroyed.dispatch({\r\n      componentClass,\r\n      component,\r\n      entity: component.entity\r\n    })\r\n    component.clear()\r\n    component.entity = null\r\n    pool.release(component)\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  public static poolStats() {\r\n    const components = {} as any\r\n    this._pools.forEach((pool, id) => {\r\n      components[id] = {\r\n        size: pool.totalSize(),\r\n        free: pool.totalFree(),\r\n        used: pool.totalUsed()\r\n      }\r\n    })\r\n    return components\r\n  }\r\n\r\n  /**  */\r\n  public init() {}\r\n  /**  */\r\n  public clear() {}\r\n\r\n  /**\r\n   * \r\n   * @param values \r\n   */\r\n  public _setProps(values: IComponentProps) {\r\n    for (const key in values) {\r\n      if (typeof values[key] !== 'undefined') {\r\n        (this as IComponentProps)[key] = values[key]\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   *  json \r\n   * \r\n   * NOTE:  JSON.stringify() \r\n   * @returns  json \r\n   */\r\n  public toJSON(): any {\r\n    // \r\n    return {}\r\n  }\r\n\r\n  /**\r\n   *  json \r\n   * @param json json \r\n   */\r\n  // public fromJSON(json: any) {\r\n  //   if (Object.prototype.toString.call(json) === '[object Object]') {\r\n  //     // \r\n  //     this._setProps(json)\r\n  //   }\r\n  // }\r\n}\r\n","import { IComponentClass, IComponent } from './component'\r\n\r\n/**\r\n * \r\n * @param componentClassList \r\n */\r\nexport function queryKey(componentClassList: IComponentClass<IComponent>[]) {\r\n  return componentClassList.map(componentClass => componentClass._id).join('-')\r\n}\r\n\r\n/** uuid  */\r\nexport function generateUUID() {\r\n  let d = new Date().getTime()\r\n  let uuid = 'xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n    let r = (d + Math.random() * 16) % 16 | 0\r\n    d = Math.floor(d / 16)\r\n    return (c === 'x' ? r : (r & 0x3) | 0x8).toString(16)\r\n  })\r\n  return uuid\r\n}\r\n\r\n// Detector for browser's \"window\"\r\nexport const hasWindow = typeof window !== \"undefined\"\r\n\r\n// performance.now() \"polyfill\"\r\nexport const now =\r\n  hasWindow && typeof window.performance !== \"undefined\"\r\n    ? performance.now.bind(performance)\r\n    : Date.now.bind(Date)\r\n","import { IComponentClass, IComponent } from './component'\r\nimport { ObjectPool } from './object-pool'\r\nimport { generateUUID } from './utils'\r\nimport { World } from './world'\r\n\r\nexport type EntityClass = {\r\n  onComponentAdded(): void\r\n  onComponentRemoved(): void\r\n}\r\n\r\nexport class Entity {\r\n  public static _pool: ObjectPool<Entity> = ObjectPool.of(Entity)\r\n  public id: string = generateUUID()\r\n  public alias?: string\r\n  public isSingleton: boolean = false\r\n  public _world?: World\r\n  private _components: Map<IComponentClass<IComponent>, IComponent> = new Map()\r\n  public onComponentChanged?: (arg0: Entity) => void\r\n\r\n  /**\r\n   * \r\n   * @returns \r\n   */\r\n  public static create(world: World, alias?: string) {\r\n    const entity = this._pool.acquire()\r\n    entity._world = world\r\n    if (alias) {\r\n      entity.alias = alias\r\n    }\r\n    return entity\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   */\r\n  public static destory(entity: Entity) {\r\n    if (entity.isSingleton) {\r\n      throw new Error('Cannot destroy singleton entities.')\r\n    }\r\n    entity._destory()\r\n    this._pool.release(entity)\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @returns \r\n   */\r\n  public static singleton(world: World) {\r\n    const entity = new Entity()\r\n    entity._world = world\r\n    entity.alias = 'singleton components'\r\n    entity.isSingleton = true\r\n\r\n    return entity\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  public static poolStats() {\r\n    return {\r\n      size: this._pool.totalSize(),\r\n      free: this._pool.totalFree(),\r\n      used: this._pool.totalUsed()\r\n    }\r\n  }\r\n\r\n  /**  */\r\n  protected _destory() {\r\n    this.alias = undefined\r\n    this._world = undefined\r\n    this.onComponentChanged = undefined\r\n    this.removeAllComponent()\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param componentClass \r\n   * @returns true -  false - \r\n   */\r\n  public verifyComponent(componentClass: IComponentClass<IComponent>) {\r\n    // \r\n    if (\r\n      !componentClass._isComponent ||\r\n      !componentClass._isRegister\r\n    ) {\r\n      throw new Error(`The Component does not meet specifications.\\n` +\r\n        `Entity: ${this.alias || this.id} Component: ${componentClass._id || componentClass.name}`)\r\n    }\r\n    // \r\n    if (this.hasComponent(componentClass)) {\r\n      console.warn(`Component already exists on entity.\\n` +\r\n        `Entity: ${this.alias || this.id} Component: ${componentClass._id}`)\r\n      return false\r\n    } else {\r\n      return true\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param componentClass \r\n   * @returns true -  false - \r\n   */\r\n  public hasComponent(componentClass: IComponentClass<IComponent>) {\r\n    return this._components.has(componentClass)\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param componentClassList \r\n   * @returns true -  false - \r\n   */\r\n  public hasAllComponent(componentClassList: IComponentClass<IComponent>[]) {\r\n    for (const componentClass of componentClassList) {\r\n      if (!this.hasComponent(componentClass)) {\r\n        return false\r\n      }\r\n    }\r\n    return true\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param componentClassList \r\n   * @returns true -  false - \r\n   */\r\n  public hasAnyComponent(componentClassList: IComponentClass<IComponent>[]) {\r\n    for (const componentClass of componentClassList) {\r\n      if (this.hasComponent(componentClass)) {\r\n        return true\r\n      }\r\n    }\r\n    return false\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param componentClass \r\n   * @returns \r\n   */\r\n  public getComponent<T extends IComponent>(componentClass: IComponentClass<T>) {\r\n    if (this._components.has(componentClass)) {\r\n      return this._components.get(componentClass) as T\r\n    } else {\r\n      console.warn('getComponent: Component not found.\\n' +\r\n        `Component: ${ componentClass }`)\r\n      return {} as T\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param componentClass \r\n   * @param values \r\n   * @returns this\r\n   */\r\n  public addComponent<T extends IComponent>(\r\n    componentClass: IComponentClass<T>,\r\n    values?: Partial<T>\r\n  ) {\r\n    if (!this.verifyComponent(componentClass)) {\r\n      return this\r\n    }\r\n    const component = IComponent.create(this, componentClass, values)\r\n    this._components.set(componentClass, component)\r\n    this.onComponentChanged && this.onComponentChanged(this)\r\n    return this\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param componentClass \r\n   * @returns this\r\n   */\r\n  public removeComponent(componentClass: IComponentClass<IComponent>) {\r\n    if (this._components.has(componentClass)) {\r\n      const component = this._components.get(componentClass)\r\n      IComponent.destory(componentClass, component)\r\n      this._components.delete(componentClass)\r\n      this.onComponentChanged && this.onComponentChanged(this)\r\n    }\r\n    return this\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @returns this\r\n   */\r\n  public removeAllComponent() {\r\n    this._components.forEach((component, key) => {\r\n      IComponent.destory(key, component)\r\n      this._components.delete(key)\r\n    })\r\n    this.onComponentChanged && this.onComponentChanged(this)\r\n    return this\r\n  }\r\n\r\n  /**\r\n   *  json \r\n   * \r\n   * NOTE:  JSON.stringify() \r\n   * @returns  json \r\n   */\r\n  public toJSON() {\r\n    const components: any[] = []\r\n    this._components.forEach((component, componentClass) => {\r\n      components.push({\r\n        class: componentClass._id,\r\n        content: component\r\n      })\r\n    })\r\n    const json: any = {\r\n      id: this.id,\r\n      alias: this.alias,\r\n      isSingleton: this.isSingleton,\r\n      components\r\n    }\r\n    return json\r\n  }\r\n\r\n  /**\r\n   *  json \r\n   * @param json json \r\n   */\r\n  public fromJSON(json: any) {\r\n    const componentClassMap = IComponent._componentClassMap\r\n    this.id = json.id\r\n    this.alias = json.alias\r\n    this.isSingleton = json.isSingleton\r\n    const components = json.components as any[]\r\n    for (const item of components) {\r\n      const classId = item.class\r\n      const content = item.content\r\n      if (!componentClassMap.has(classId)) {\r\n        console.warn(`Cannot find component with id '${classId}'.`)\r\n        continue\r\n      }\r\n      const componentClass = componentClassMap.get(classId)\r\n      this.addComponent(componentClass, content)\r\n    }\r\n  }\r\n}\r\n","import { Entity } from './entity'\r\nimport { IComponentClass, IComponent } from './component'\r\nimport { queryKey } from './utils'\r\n\r\n/**  */\r\nexport class QueryItem {\r\n  private entities: Entity[] = []\r\n  public key: string = null\r\n\r\n  constructor(\r\n    private queryComponents: IComponentClass<IComponent>[],\r\n    private matchType: string\r\n  ) {\r\n    if (queryComponents.length === 0) {\r\n      throw new Error(`Can't create a query without \"components\" on System.`)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   * @returns true -  false - \r\n   */\r\n  public match(entity: Entity) {\r\n    if (this.matchType === 'all') {\r\n      return this.matchAll(entity)\r\n    } else if (this.matchType === 'any') {\r\n      return this.matchAny(entity)\r\n    } else {\r\n      return false\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   * @returns true -  false - \r\n   */\r\n  public matchAll(entity: Entity) {\r\n    return entity.hasAllComponent(this.queryComponents)\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   * @returns true -  false - \r\n   */\r\n  public matchAny(entity: Entity) {\r\n    return entity.hasAnyComponent(this.queryComponents)\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @returns \r\n   */\r\n  public getEntity() {\r\n    return this.entities\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   */\r\n  public addEntity(entity: Entity) {\r\n    if (this.entities.indexOf(entity) === -1) {\r\n      this.entities.push(entity)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   */\r\n  public removeEntity(entity: Entity) {\r\n    const index = this.entities.indexOf(entity)\r\n    if (index !== -1) {\r\n      this.entities.splice(index, 1)\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * \r\n   * @returns \r\n   */\r\n  public stats() {\r\n    const queryComponents = this.queryComponents.map(componentClass => componentClass._id)\r\n    return {\r\n      matchType: this.matchType,\r\n      numQueryComponents: this.queryComponents.length,\r\n      numEntities: this.entities.length,\r\n      queryComponents\r\n    }\r\n  }\r\n}\r\n\r\n/**  */\r\nexport class EntityQuery {\r\n  private queries: Map<string, QueryItem> = new Map()\r\n\r\n  /**\r\n   * \r\n   * @param queryComponents \r\n   * @param matchType  all | any\r\n   * @returns \r\n   */\r\n  public createQuery(queryComponents: IComponentClass<IComponent>[], matchType: string) {\r\n    const key = matchType + queryKey(queryComponents)\r\n    //  system \r\n    if (this.queries.has(key)) {\r\n      return this.queries.get(key)\r\n    } else {\r\n      const query = new QueryItem(queryComponents, matchType)\r\n      query.key = key\r\n      this.queries.set(key, query)\r\n      return query\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   */\r\n  public onEntityRemoved(entity: Entity) {\r\n    this.queries.forEach(query => {\r\n      query.removeEntity(entity)\r\n    })\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   */\r\n  public onEntityComponentChanged(entity: Entity) {\r\n    this.queries.forEach(query => {\r\n      if (query.match(entity)) {\r\n        query.addEntity(entity)\r\n      } else {\r\n        query.removeEntity(entity)\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @returns \r\n   */\r\n  public stats() {\r\n    const queries = [] as any[]\r\n    this.queries.forEach(query => {\r\n      queries.push(query.stats())\r\n    })\r\n    const numQueries = queries.length\r\n    \r\n    return {\r\n      numQueries,\r\n      queries\r\n    }\r\n  }\r\n}","import { Entity } from './entity'\r\nimport { IComponentClass, IComponent } from './component'\r\nimport { EntityQuery } from './entity-query'\r\nimport { World } from './world'\r\n\r\nexport class EntityManager {\r\n  private entities: Map<string, Entity> = new Map()\r\n  private numEntities: number = 0\r\n  private entityQuery: EntityQuery = new EntityQuery()\r\n  private entitiesWithComponentChanged: Set<Entity> = new Set()\r\n\r\n  constructor(private world: World) {}\r\n\r\n  /**\r\n   * \r\n   * @param alias \r\n   * @returns \r\n   */\r\n  public createEntity(alias?: string) {\r\n    const entity = this.initEntity(alias)\r\n    this.pushEntity(entity)\r\n    return entity\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param alias \r\n   */\r\n  private initEntity(alias?: string): Entity {\r\n    const entity = Entity.create(this.world, alias)\r\n    entity.onComponentChanged = entity => {\r\n      this.entitiesWithComponentChanged.add(entity)\r\n    }\r\n    return entity\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   */\r\n  private pushEntity(entity: Entity): void {\r\n    this.numEntities++\r\n    this.entities.set(entity.id, entity)\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   */\r\n  public removeEntity(entity: Entity) {\r\n    this.entityQuery.onEntityRemoved(entity)\r\n    this.numEntities--\r\n    this.entities.delete(entity.id)\r\n    Entity.destory(entity)\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   * @returns true  , false  \r\n   */\r\n  public hasEntity(entity: Entity) {\r\n    return this.entities.has(entity.id)\r\n  }\r\n\r\n  /**\r\n   *  id \r\n   * @param {string} id \r\n   * @returns {Entity | undefined}\r\n   */\r\n  public getEntity(id: string): Entity | undefined {\r\n    return this.entities.get(id)\r\n  }\r\n\r\n  /**  */\r\n  public clear() {\r\n    this.entities.forEach(entity => {\r\n      this.removeEntity(entity)\r\n    })\r\n    Entity._pool.clear()\r\n  }\r\n\r\n  /**\r\n   *  System \r\n   * @param QueryComponents \r\n   * @param matchType  all | any\r\n   * @returns \r\n   */\r\n  public createQuery(QueryComponents: IComponentClass<IComponent>[], matchType: string) {\r\n    return this.entityQuery.createQuery(QueryComponents, matchType)\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  public updateEntityQuery() {\r\n    this.entitiesWithComponentChanged.forEach(entity => {\r\n      this.entityQuery.onEntityComponentChanged(entity)\r\n    })\r\n    this.entitiesWithComponentChanged.clear()\r\n  }\r\n\r\n  /**\r\n   *  json \r\n   * \r\n   * NOTE:  JSON.stringify() \r\n   */\r\n  public toJSON() {\r\n    const json: any[] = []\r\n    this.entities.forEach(entity => {\r\n      json.push(entity)\r\n    })\r\n    return json\r\n  }\r\n\r\n  /**\r\n   *  json \r\n   */\r\n  public fromJSON(json: any) {\r\n    for (const token of json) {\r\n      const entity = this.initEntity()\r\n      entity.fromJSON(token)\r\n      this.pushEntity(entity)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @returns \r\n   */\r\n  public stats() {\r\n    const queryStats = this.entityQuery.stats()\r\n\r\n    const numEntities = this.numEntities\r\n    const numQueries = queryStats.numQueries\r\n    const queries = queryStats.queries\r\n    return {\r\n      numEntities,\r\n      numQueries,\r\n      queries,\r\n    }\r\n  }\r\n}\r\n","import { Entity } from './entity'\r\nimport { IComponentClass, IComponent } from './component'\r\nimport { World } from './world'\r\n\r\nexport type ISystemQuery = {\r\n  [queryName: string]: {\r\n    type: 'all' | 'any'\r\n    components: IComponentClass<IComponent>[]\r\n  } | IComponentClass<IComponent>[]\r\n}\r\n\r\nexport type ISystemQueries = {\r\n  [queryName: string]: {\r\n    results: Entity[]\r\n  }\r\n}\r\n\r\nexport type ISystemClass<T extends ISystem> = {\r\n  new (...args: any[]): T\r\n  isSystem: true\r\n  queries?: ISystemQuery\r\n}\r\n\r\n/**\r\n * \r\n */\r\nexport const SystemPriority = {\r\n  Begin: 0,\r\n  Start: 1,\r\n  FixedUpdate: 2,\r\n  Update: 3,\r\n  Animation: 4,\r\n  LateUpdate: 5,\r\n  BeforeRenderer: 6,\r\n  Renderer: 7,\r\n  End: 8\r\n}\r\n\r\nexport class ISystem {\r\n  public static readonly isSystem: true = true\r\n  public static queries?: ISystemQuery\r\n  public world: World = null\r\n  public queries: ISystemQueries = {}\r\n  public _priority: number = -1\r\n  public _executeTime: number = 0\r\n  public init() {}\r\n  public execute(delta: number, timestamp: number) {}\r\n}\r\n","import { World } from './world'\r\nimport { EntityManager } from './entity-manager'\r\nimport { ISystemClass, ISystem, SystemPriority } from './system'\r\nimport { now } from './utils'\r\n\r\nexport class SystemManager {\r\n  private systems: ISystem[] = []\r\n\r\n  constructor(\r\n    private world: World,\r\n    private entityManager: EntityManager\r\n  ) {}\r\n  \r\n  /**\r\n   *  system \r\n   * @param systemClass\r\n   * @param system\r\n   */\r\n  private _injectQuery<T extends ISystem>(\r\n    systemClass: ISystemClass<T>,\r\n    system: ISystem\r\n  ) {\r\n    const queries = systemClass.queries\r\n\r\n    if (queries) {\r\n      for (const key in queries) {\r\n        // \"\"\r\n        //  Object\r\n        if (Array.isArray(queries[key])) {\r\n          const query = this.entityManager.createQuery(queries[key] as any, 'all')\r\n          system.queries[key] = {\r\n            results: query.getEntity()\r\n          }\r\n        } else {\r\n          const { type = 'all', components } = queries[key] as any\r\n          if (type !== 'all' && type !== 'any' && Array.isArray(components)) {\r\n            continue\r\n          }\r\n          const query = this.entityManager.createQuery(components, type)\r\n          system.queries[key] = {\r\n            results: query.getEntity()\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   *  system  system \r\n   * @param system \r\n   */\r\n  private _pushSystem(system: ISystem) {\r\n    const systemCount = this.systems.length\r\n\r\n    if (systemCount > 0) {\r\n      if (system._priority < this.systems[0]._priority) {\r\n        this.systems.unshift(system)\r\n        return\r\n      } else if (system._priority >= this.systems[systemCount - 1]._priority) {\r\n        this.systems.push(system)\r\n        return\r\n      }\r\n    }\r\n\r\n    for (let i = 0; i < systemCount; i++) {\r\n      if (system._priority < this.systems[i]._priority) {\r\n        this.systems.splice(i, 0, system)\r\n        return\r\n      }\r\n    }\r\n    this.systems.push(system)\r\n  }\r\n\r\n  /**\r\n   *  system\r\n   * @param systemClass system \r\n   * @param priority system \r\n   */\r\n  public registerSystem<T extends ISystem>(\r\n    systemClass: ISystemClass<T>,\r\n    priority: number = SystemPriority.Update\r\n  ) {\r\n    if (!systemClass.isSystem) {\r\n      throw new Error(`System \"${systemClass.name}\" must extend \"System\" class.`)\r\n    }\r\n    if (this.isRegisterSystem(systemClass)) {\r\n      console.warn(`System \"${systemClass.name}\" already registered.`)\r\n      return\r\n    }\r\n    const system = new systemClass()\r\n    system._priority = priority\r\n    system.world = this.world\r\n    this._injectQuery(systemClass, system)\r\n    this._pushSystem(system)\r\n    system.init()\r\n  }\r\n\r\n  /**\r\n   *  system \r\n   * @param systemClass\r\n   * @returns true - false - \r\n   */\r\n  public isRegisterSystem<T extends ISystem>(systemClass: ISystemClass<T>) {\r\n    return this.systems.findIndex(system => system instanceof systemClass) !== -1\r\n  }\r\n\r\n  /**\r\n   *  system\r\n   * @param delta \r\n   * @param timestamp \r\n   */\r\n  public execute(delta: number, timestamp: number) {\r\n    this.systems.forEach(system => {\r\n      const startTime = now()\r\n      system.execute(delta, timestamp)\r\n      this.entityManager.updateEntityQuery()\r\n      system._executeTime = now() - startTime\r\n    })\r\n  }\r\n\r\n  /**\r\n   *  System \r\n   * @returns \r\n   */\r\n  public stats() {\r\n    return {\r\n      numSystems: this.systems.length,\r\n      executeTime: this.systems.map(system => {\r\n        const systemClass = system.constructor\r\n        return {\r\n          name: systemClass.name,\r\n          executeTime: system._executeTime\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n","import { Entity } from './entity'\r\nimport { IComponent } from './component'\r\nimport { EntityManager } from './entity-manager'\r\nimport { SystemManager } from './system-manager'\r\nimport { ISystemClass, ISystem, SystemPriority } from './system'\r\nimport { now } from './utils'\r\n\r\nexport class World {\r\n  private entityManager: EntityManager = new EntityManager(this)\r\n  private systemManager: SystemManager = new SystemManager(this, this.entityManager)\r\n  public singleton: Entity = Entity.singleton(this)\r\n  private enabled: boolean = false\r\n  private lastTimestamp: number = 0\r\n\r\n  /**\r\n   *  system\r\n   * @param systemClass system \r\n   * @param priority system \r\n   * @returns this\r\n   */\r\n  public registerSystem<T extends ISystem>(\r\n    systemClass: ISystemClass<T>,\r\n    priority: number = SystemPriority.Update\r\n  ) {\r\n    this.systemManager.registerSystem(systemClass, priority)\r\n    return this\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param alias \r\n   * @returns \r\n   */\r\n  public createEntity(alias?: string) {\r\n    return this.entityManager.createEntity(alias)\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   */\r\n  public removeEntity(entity: Entity) {\r\n    this.entityManager.removeEntity(entity)\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   */\r\n  public removeAllEntity() {\r\n    this.entityManager.clear()\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param entity \r\n   * @returns true  , false  \r\n   */\r\n  public hasEntity(entity: Entity) {\r\n    return this.entityManager.hasEntity(entity)\r\n  }\r\n\r\n  /**\r\n   *  id \r\n   * @param {string} id \r\n   * @returns {Entity | undefined}\r\n   */\r\n  public getEntity(id: string): Entity | undefined {\r\n    return this.entityManager.getEntity(id)\r\n  }\r\n\r\n  /**  */\r\n  public mandatoryUpdateEntityQuery() {\r\n    this.entityManager.updateEntityQuery()\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param {number} timestamp - \r\n   */\r\n  public execute(timestamp: number) {\r\n    if (typeof timestamp === 'undefined') {\r\n      timestamp = now()\r\n    }\r\n    let delta = 0\r\n    if (this.lastTimestamp !== 0) {\r\n      delta = timestamp - this.lastTimestamp\r\n    }\r\n    this.lastTimestamp = timestamp\r\n    if (this.enabled) {\r\n      this.systemManager.execute(delta, timestamp)\r\n    }\r\n  }\r\n\r\n  /**\r\n   *  world\r\n   */\r\n  public start() {\r\n    this.enabled = true\r\n    this.lastTimestamp = 0\r\n  }\r\n\r\n  /**\r\n   *  world\r\n   */\r\n  public stop() {\r\n    this.enabled = false\r\n  }\r\n\r\n  /**\r\n   *  world \r\n   */\r\n  public clear() {\r\n    this.entityManager.clear()\r\n    this.singleton.removeAllComponent()\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @returns \r\n   */\r\n  public serialize() {\r\n    const token = JSON.stringify({\r\n      entity: this.entityManager,\r\n      singleton: this.singleton\r\n    })\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.log(JSON.parse(token))\r\n    }\r\n    return token\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param token \r\n   */\r\n  public deserialize(token: string) {\r\n    this.clear()\r\n    const json = JSON.parse(token)\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.log(json)\r\n    }\r\n    this.entityManager.fromJSON(json.entity)\r\n    this.singleton.fromJSON(json.singleton)\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @returns \r\n   */\r\n  public stats() {\r\n    const { numEntities, numQueries, queries } = this.entityManager.stats()\r\n    const { numSystems, executeTime } = this.systemManager.stats()\r\n\r\n    return {\r\n      overview: {\r\n        numEntities,\r\n        numSystems,\r\n        numQueries\r\n      },\r\n      systems: executeTime,\r\n      queries,\r\n      pool: {\r\n        entity: Entity.poolStats(),\r\n        component: IComponent.poolStats()\r\n      }\r\n    }\r\n  }\r\n}\r\n","import * as PIXI from 'pixi.js'\r\n\r\nexport class Stage extends PIXI.Container {\r\n  public numLayer: number = 0\r\n  public layerMap: Map<string, PIXI.Container | PIXI.ParticleContainer> = new Map()\r\n\r\n  /**\r\n   *  Stage \r\n   * @param layer \r\n   * @param id \r\n   * @param index \r\n   * @private\r\n   */\r\n  private _addLayer(\r\n    layer: PIXI.Container | PIXI.ParticleContainer,\r\n    id: string,\r\n    index?: number\r\n  ) {\r\n    if (index) {\r\n      this.addChildAt(layer, index)\r\n    } else {\r\n      this.addChild(layer)\r\n    }\r\n    this.layerMap.set(id, layer)\r\n    this.numLayer++\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param id \r\n   * @param index \r\n   */\r\n  public createLayer(id: string, index?: number) {\r\n    const layer = new PIXI.Container()\r\n    this._addLayer(layer, id, index)\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param id \r\n   * @param index \r\n   */\r\n  public createParticleLayer(id: string, index?: number) {\r\n    const layer = new PIXI.ParticleContainer()\r\n    this._addLayer(layer, id, index)\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param id \r\n   */\r\n  public hasLayer(id: string) {\r\n    return this.layerMap.has(id)\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param id \r\n   */\r\n  public getLayer(id: string) {\r\n    if (!this.layerMap.has(id)) {\r\n      console.warn(`There is no layer whose id is \"${id}\".`)\r\n    }\r\n    return this.layerMap.get(id)\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param id \r\n   */\r\n  public removeLayer(id: string) {\r\n    if (this.layerMap.has(id)) {\r\n      const layer = this.layerMap.get(id)\r\n      this.removeChild(layer)\r\n      this.numLayer--\r\n    } else {\r\n      console.warn(`There is no layer whose id is \"${id}\".`)\r\n    }\r\n  }\r\n\r\n  /** */\r\n  public clearLayer() {\r\n    this.layerMap.forEach(layer => {\r\n      layer.removeChildren(0)\r\n    })\r\n  }\r\n}","import { World } from '../core'\r\nimport { Stage } from './stage'\r\n\r\nexport class Scene extends World {\r\n  public view: Stage\r\n\r\n  constructor() {\r\n    super()\r\n    this.view = new Stage()\r\n    // 11\r\n    for (let i = 0; i <= 10; i++) {\r\n      this.addLayer(`UserLayer${i}`)\r\n    }\r\n  }\r\n\r\n  public addLayer(id: string, index?: number) {\r\n    this.view.createLayer(id, index)\r\n  }\r\n\r\n  public addParticleLayer(id: string, index?: number) {\r\n    this.view.createParticleLayer(id, index)\r\n  }\r\n\r\n  public hasLayer(id: string) {\r\n    return this.view.hasLayer(id)\r\n  }\r\n\r\n  public getLayer(id: string) {\r\n    return this.view.getLayer(id)\r\n  }\r\n\r\n  public removeLayer(id: string) {\r\n    this.view.removeLayer(id)\r\n  }\r\n\r\n  public addSprite(layerId: string, sprite: PIXI.Container) {\r\n    const layer = this.getLayer(layerId)\r\n    layer?.addChild(sprite)\r\n  }\r\n\r\n  public removeSprite(layerId: string, sprite: PIXI.Container) {\r\n    const layer = this.getLayer(layerId)\r\n    layer?.removeChild(sprite)\r\n  }\r\n}\r\n","export type InteractivePointerEvent = PointerEvent | TouchEvent | MouseEvent\r\n\r\nexport class Point {\r\n  public x: number\r\n  public y: number\r\n\r\n  constructor(x: number = 0, y: number = x) {\r\n    this.x = x\r\n    this.y = y\r\n  }\r\n\r\n  public set(x: number, y: number = x) {\r\n    this.x = x\r\n    this.y = y\r\n  }\r\n}\r\n\r\n/**\r\n * Holds all information related to an Interaction event\r\n *\r\n * @class\r\n * @memberof PIXI\r\n */\r\nexport class InteractionData {\r\n  /**\r\n   * This point stores the global coords of where the touch/mouse event happened\r\n   *\r\n   * @member {Point}\r\n   */\r\n  public global: Point\r\n\r\n  /**\r\n   * When passed to an event handler, this will be the original DOM Event that was captured\r\n   *\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/TouchEvent\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent\r\n   * @member {MouseEvent|TouchEvent|PointerEvent}\r\n   */\r\n  public originalEvent: InteractivePointerEvent\r\n\r\n  /**\r\n   * Mouse or Touch is down?\r\n   * \r\n   * @member {boolean}\r\n   */\r\n  public isDown: boolean\r\n\r\n  /**\r\n   * Unique identifier for this interaction\r\n   *\r\n   * @member {number}\r\n   */\r\n  public identifier: number\r\n\r\n  /**\r\n   * Indicates whether or not the pointer device that created the event is the primary pointer.\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/isPrimary\r\n   * @type {Boolean}\r\n   */\r\n  public isPrimary: boolean\r\n\r\n  /**\r\n   * Indicates which button was pressed on the mouse or pointer device to trigger the event.\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button\r\n   * @type {number}\r\n   */\r\n  public button: number\r\n\r\n  /**\r\n   * Indicates which buttons are pressed on the mouse or pointer device when the event is triggered.\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/buttons\r\n   * @type {number}\r\n   */\r\n  public buttons: number\r\n\r\n  /**\r\n   * The width of the pointer's contact along the x-axis, measured in CSS pixels.\r\n   * radiusX of TouchEvents will be represented by this value.\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/width\r\n   * @type {number}\r\n   */\r\n  public width: number\r\n\r\n  /**\r\n   * The height of the pointer's contact along the y-axis, measured in CSS pixels.\r\n   * radiusY of TouchEvents will be represented by this value.\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/height\r\n   * @type {number}\r\n   */\r\n  public height: number\r\n\r\n  /**\r\n   * The angle, in degrees, between the pointer device and the screen.\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/tiltX\r\n   * @type {number}\r\n   */\r\n  public tiltX: number\r\n\r\n  /**\r\n   * The angle, in degrees, between the pointer device and the screen.\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/tiltY\r\n   * @type {number}\r\n   */\r\n  public tiltY: number\r\n\r\n  /**\r\n   * The type of pointer that triggered the event.\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pointerType\r\n   * @type {string}\r\n   */\r\n  public pointerType: string\r\n\r\n  /**\r\n   * Pressure applied by the pointing device during the event. A Touch's force property\r\n   * will be represented by this value.\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pressure\r\n   * @type {number}\r\n   */\r\n  public pressure: number\r\n\r\n  /**\r\n   * From TouchEvents (not PointerEvents triggered by touches), the rotationAngle of the Touch.\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/Touch/rotationAngle\r\n   * @type {number}\r\n   */\r\n  public rotationAngle: number\r\n\r\n  /**\r\n   * Twist of a stylus pointer.\r\n   * @see https://w3c.github.io/pointerevents/#pointerevent-interface\r\n   * @type {number}\r\n   */\r\n  public twist: number\r\n\r\n  /**\r\n   * Barrel pressure on a stylus pointer.\r\n   * @see https://w3c.github.io/pointerevents/#pointerevent-interface\r\n   * @type {number}\r\n   */\r\n  public tangentialPressure: number\r\n\r\n  constructor() {\r\n    this.global = new Point()\r\n    this.originalEvent = null\r\n    this.isDown = false\r\n\r\n    this.identifier = null\r\n    this.isPrimary = false\r\n    this.button = 0\r\n    this.buttons = 0\r\n    this.width = 0\r\n    this.height = 0\r\n    this.tiltX = 0\r\n    this.tiltY = 0\r\n    this.pointerType = null\r\n    this.pressure = 0\r\n    this.rotationAngle = 0\r\n    this.twist = 0\r\n    this.tangentialPressure = 0\r\n  }\r\n\r\n  /**\r\n   * The unique identifier of the pointer. It will be the same as `identifier`.\r\n   * @readonly\r\n   * @member {number}\r\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pointerId\r\n   */\r\n  get pointerId(): number {\r\n    return this.identifier\r\n  }\r\n\r\n  /**\r\n   * Copies properties from normalized event data.\r\n   *\r\n   * @param {Touch|MouseEvent|PointerEvent} event - The normalized event data\r\n   */\r\n  public copyEvent(event: Touch | InteractivePointerEvent): void {\r\n    // isPrimary should only change on touchstart/pointerdown, so we don't want to overwrite\r\n    // it with \"false\" on later events when our shim for it on touch events might not be\r\n    // accurate\r\n    if ('isPrimary' in event && event.isPrimary) {\r\n      this.isPrimary = true\r\n    }\r\n    this.button = 'button' in event && event.button\r\n    // event.buttons is not available in all browsers (ie. Safari), but it does have a non-standard\r\n    // event.which property instead, which conveys the same information.\r\n    const buttons = 'buttons' in event && event.buttons\r\n\r\n    this.buttons = Number.isInteger(buttons)\r\n      ? buttons\r\n      : 'which' in event && event.which\r\n    this.width = 'width' in event && event.width\r\n    this.height = 'height' in event && event.height\r\n    this.tiltX = 'tiltX' in event && event.tiltX\r\n    this.tiltY = 'tiltY' in event && event.tiltY\r\n    this.pointerType = 'pointerType' in event && event.pointerType\r\n    this.pressure = 'pressure' in event && event.pressure\r\n    this.rotationAngle = 'rotationAngle' in event && event.rotationAngle\r\n    this.twist = ('twist' in event && event.twist) || 0\r\n    this.tangentialPressure =\r\n      ('tangentialPressure' in event && event.tangentialPressure) || 0\r\n  }\r\n\r\n  /**\r\n   * Resets the data for pooling.\r\n   */\r\n  public reset(): void {\r\n    // isPrimary is the only property that we really need to reset - everything else is\r\n    // guaranteed to be overwritten\r\n    this.isPrimary = false\r\n  }\r\n}\r\n","import type { AbstractRenderer } from 'pixi.js'\r\nimport { InteractionData, Point } from './InteractionData'\r\nimport type { InteractivePointerEvent } from './InteractionData'\r\n\r\nconst MOUSE_POINTER_ID = 1\r\n\r\ninterface CrossCSSStyleDeclaration extends CSSStyleDeclaration {\r\n  msContentZooming: string\r\n  msTouchAction: string\r\n}\r\n\r\nexport class InteractionManager {\r\n  /**\r\n   * Does the device support touch events\r\n   * https://www.w3.org/TR/touch-events/\r\n   *\r\n   * @readonly\r\n   * @member {boolean}\r\n   */\r\n  public readonly supportsTouchEvents: boolean\r\n\r\n  /**\r\n   * Does the device support pointer events\r\n   * https://www.w3.org/Submission/pointer-events/\r\n   *\r\n   * @readonly\r\n   * @member {boolean}\r\n   */\r\n  public readonly supportsPointerEvents: boolean\r\n\r\n  /**\r\n   * The renderer this interaction manager works for.\r\n   *\r\n   * @member {PIXI.AbstractRenderer}\r\n   */\r\n  public renderer: AbstractRenderer\r\n\r\n  /**\r\n   * The mouse data\r\n   *\r\n   * @member {InteractionData}\r\n   */\r\n  public mouse: InteractionData\r\n\r\n  /**\r\n   * The current resolution / device pixel ratio.\r\n   *\r\n   * @member {number}\r\n   * @default 1\r\n   */\r\n  public resolution: number\r\n\r\n  /**\r\n   * The DOM element to bind to.\r\n   *\r\n   * @protected\r\n   * @member {HTMLElement}\r\n   */\r\n  protected interactionDOMElement: HTMLElement\r\n\r\n  /**\r\n   * Have events been attached to the dom element?\r\n   *\r\n   * @protected\r\n   * @member {boolean}\r\n   */\r\n  protected eventsAdded: boolean\r\n\r\n  /**\r\n   * @param {PIXI.CanvasRenderer|PIXI.Renderer} renderer - A reference to the current renderer\r\n   */\r\n  constructor(renderer: AbstractRenderer) {\r\n    this.renderer = renderer\r\n    this.mouse = new InteractionData()\r\n    this.mouse.identifier = MOUSE_POINTER_ID\r\n    this.mouse.global.set(-1)\r\n    this.interactionDOMElement = null\r\n    this.eventsAdded = false\r\n    this.supportsTouchEvents = 'ontouchstart' in window\r\n    this.supportsPointerEvents = !!window.PointerEvent\r\n    this.resolution = 1\r\n\r\n    // this will make it so that you don't have to call bind all the time\r\n    this.onPointerUp = this.onPointerUp.bind(this)\r\n    this.onPointerCancel = this.onPointerCancel.bind(this)\r\n    this.onPointerDown = this.onPointerDown.bind(this)\r\n    this.onPointerMove = this.onPointerMove.bind(this)\r\n    this.onPointerOut = this.onPointerOut.bind(this)\r\n    this.onPointerOver = this.onPointerOver.bind(this)\r\n\r\n    this.setTargetElement(this.renderer.view, this.renderer.resolution)\r\n  }\r\n\r\n  /**\r\n   * Sets the DOM element which will receive mouse/touch events. This is useful for when you have\r\n   * other DOM elements on top of the renderers Canvas element. With this you'll be bale to delegate\r\n   * another DOM element to receive those events.\r\n   *\r\n   * @param {HTMLElement} element - the DOM element which will receive mouse and touch events.\r\n   * @param {number} [resolution=1] - The resolution / device pixel ratio of the new element (relative to the canvas).\r\n   */\r\n  public setTargetElement(element: HTMLElement, resolution: number = 1): void {\r\n    this.removeEvents()\r\n\r\n    this.interactionDOMElement = element\r\n\r\n    this.resolution = resolution\r\n\r\n    this.addEvents()\r\n  }\r\n\r\n  /**\r\n   * Registers all the DOM events\r\n   *\r\n   * @private\r\n   */\r\n  private addEvents(): void {\r\n    if (this.eventsAdded || !this.interactionDOMElement) {\r\n      return\r\n    }\r\n\r\n    const style = this.interactionDOMElement.style as CrossCSSStyleDeclaration\r\n\r\n    if (window.navigator.msPointerEnabled) {\r\n      style.msContentZooming = 'none'\r\n      style.msTouchAction = 'none'\r\n    } else if (this.supportsPointerEvents) {\r\n      style.touchAction = 'none'\r\n    }\r\n\r\n    /*\r\n     * These events are added first, so that if pointer events are normalized, they are fired\r\n     * in the same order as non-normalized events. ie. pointer event 1st, mouse / touch 2nd\r\n     */\r\n    const dom = this.interactionDOMElement\r\n    if (this.supportsPointerEvents) {\r\n      window.document.addEventListener('pointermove', this.onPointerMove, true)\r\n      dom.addEventListener('pointerdown', this.onPointerDown, true)\r\n      // pointerout is fired in addition to pointerup (for touch events) and pointercancel\r\n      // we already handle those, so for the purposes of what we do in onPointerOut, we only\r\n      // care about the pointerleave event\r\n      dom.addEventListener('pointerleave', this.onPointerOut, true)\r\n      dom.addEventListener('pointerover', this.onPointerOver, true)\r\n      window.addEventListener('pointercancel', this.onPointerCancel, true)\r\n      window.addEventListener('pointerup', this.onPointerUp, true)\r\n    } else {\r\n      window.document.addEventListener('mousemove', this.onPointerMove, true)\r\n      dom.addEventListener('mousedown', this.onPointerDown, true)\r\n      dom.addEventListener('mouseout', this.onPointerOut, true)\r\n      dom.addEventListener('mouseover', this.onPointerOver, true)\r\n      window.addEventListener('mouseup', this.onPointerUp, true)\r\n    }\r\n\r\n    // always look directly for touch events so that we can provide original data\r\n    // In a future version we should change this to being just a fallback and rely solely on\r\n    // PointerEvents whenever available\r\n    if (this.supportsTouchEvents) {\r\n      dom.addEventListener('touchstart', this.onPointerDown, true)\r\n      dom.addEventListener('touchcancel', this.onPointerCancel, true)\r\n      dom.addEventListener('touchend', this.onPointerUp, true)\r\n      dom.addEventListener('touchmove', this.onPointerMove, true)\r\n    }\r\n\r\n    this.eventsAdded = true\r\n  }\r\n\r\n  /**\r\n   * Removes all the DOM events that were previously registered\r\n   *\r\n   * @private\r\n   */\r\n  private removeEvents(): void {\r\n    if (!this.eventsAdded || !this.interactionDOMElement) {\r\n      return\r\n    }\r\n\r\n    const style = this.interactionDOMElement.style as CrossCSSStyleDeclaration\r\n\r\n    if (window.navigator.msPointerEnabled) {\r\n      style.msContentZooming = ''\r\n      style.msTouchAction = ''\r\n    } else if (this.supportsPointerEvents) {\r\n      style.touchAction = ''\r\n    }\r\n\r\n    const dom = this.interactionDOMElement\r\n    if (this.supportsPointerEvents) {\r\n      window.document.removeEventListener('pointermove', this.onPointerMove, true)\r\n      dom.removeEventListener('pointerdown', this.onPointerDown, true)\r\n      dom.removeEventListener('pointerleave', this.onPointerOut, true)\r\n      dom.removeEventListener('pointerover', this.onPointerOver, true)\r\n      window.removeEventListener('pointercancel', this.onPointerCancel, true)\r\n      window.removeEventListener('pointerup', this.onPointerUp, true)\r\n    } else {\r\n      window.document.removeEventListener('mousemove', this.onPointerMove, true)\r\n      dom.removeEventListener('mousedown', this.onPointerDown, true)\r\n      dom.removeEventListener('mouseout', this.onPointerOut, true)\r\n      dom.removeEventListener('mouseover', this.onPointerOver, true)\r\n      window.removeEventListener('mouseup', this.onPointerUp, true)\r\n    }\r\n\r\n    if (this.supportsTouchEvents) {\r\n      dom.removeEventListener('touchstart', this.onPointerDown, true)\r\n      dom.removeEventListener('touchcancel', this.onPointerCancel, true)\r\n      dom.removeEventListener('touchend', this.onPointerUp, true)\r\n      dom.removeEventListener('touchmove', this.onPointerMove, true)\r\n    }\r\n\r\n    this.interactionDOMElement = null\r\n\r\n    this.eventsAdded = false\r\n  }\r\n\r\n  /**\r\n   * Maps x and y coords from a DOM object and maps them correctly to the PixiJS view. The\r\n   * resulting value is stored in the point. This takes into account the fact that the DOM\r\n   * element could be scaled and positioned anywhere on the screen.\r\n   *\r\n   * @param  {number} x - the x coord of the position to map\r\n   * @param  {number} y - the y coord of the position to map\r\n   */\r\n  public mapPositionToPoint(x: number, y: number): Point {\r\n    const point = new Point(0)\r\n    let rect\r\n\r\n    // IE 11 fix\r\n    if (!this.interactionDOMElement.parentElement) {\r\n      rect = { x: 0, y: 0, width: 0, height: 0 }\r\n    } else {\r\n      rect = this.interactionDOMElement.getBoundingClientRect()\r\n    }\r\n\r\n    const resolutionMultiplier = 1.0 / this.resolution\r\n\r\n    point.x =\r\n      (x - rect.left) *\r\n      ((this.interactionDOMElement as any).width / rect.width) *\r\n      resolutionMultiplier\r\n    point.y =\r\n      (y - rect.top) *\r\n      ((this.interactionDOMElement as any).height / rect.height) *\r\n      resolutionMultiplier\r\n\r\n    return point\r\n  }\r\n\r\n  /**\r\n   * Process mouse event.\r\n   * @param event \r\n   * @param isDown\r\n   */\r\n  public processInteractive(event: PointerEvent, isDown?: boolean): void {\r\n    const interactionData = this.getInteractionData(event)\r\n\r\n    if (typeof isDown === 'boolean') {\r\n      interactionData.isDown = isDown\r\n    } else {\r\n      interactionData.isDown = this.mouse.isDown\r\n    }\r\n\r\n    this.configureInteractionDataForDOMEvent(event, interactionData)\r\n\r\n    this.mouse = interactionData\r\n  }\r\n\r\n  /**\r\n   * Is called when the pointer button is pressed down on the renderer element\r\n   *\r\n   * @private\r\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer button being pressed down\r\n   */\r\n  private onPointerDown(originalEvent: InteractivePointerEvent): void {\r\n    // if we support touch events, then only use those for touch events, not pointer events\r\n    if (\r\n      this.supportsTouchEvents &&\r\n      (originalEvent as PointerEvent).pointerType === 'touch'\r\n    ) {\r\n      return\r\n    }\r\n\r\n    const events = this.normalizeToPointerData(originalEvent)\r\n\r\n    /*\r\n     * No need to prevent default on natural pointer events, as there are no side effects\r\n     * Normalized events, however, may have the double mousedown/touchstart issue on the native android browser,\r\n     * so still need to be prevented.\r\n     */\r\n\r\n    // Guaranteed that there will be at least one event in events, and all events must have the same pointer type\r\n\r\n    const event = events[0]\r\n\r\n    // if ((event as any).isNormalized) {\r\n    //   const cancelable =\r\n    //     originalEvent.cancelable || !('cancelable' in originalEvent)\r\n\r\n    //   if (cancelable) {\r\n    //     originalEvent.preventDefault()\r\n    //   }\r\n    // }\r\n\r\n    this.processInteractive(event, true)\r\n  }\r\n\r\n  /**\r\n   * Is called when the pointer button is released on the renderer element\r\n   *\r\n   * @private\r\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer button being released\r\n   */\r\n  private onPointerComplete(originalEvent: InteractivePointerEvent): void {\r\n    const events = this.normalizeToPointerData(originalEvent)\r\n\r\n    const event = events[0]\r\n\r\n    this.processInteractive(event, false)\r\n  }\r\n\r\n  /**\r\n   * Is called when the pointer button is cancelled\r\n   *\r\n   * @private\r\n   * @param {PointerEvent} event - The DOM event of a pointer button being released\r\n   */\r\n  private onPointerCancel(event: InteractivePointerEvent): void {\r\n    // if we support touch events, then only use those for touch events, not pointer events\r\n    if (\r\n      this.supportsTouchEvents &&\r\n      (event as PointerEvent).pointerType === 'touch'\r\n    ) {\r\n      return\r\n    }\r\n\r\n    this.onPointerComplete(event)\r\n  }\r\n\r\n  /**\r\n   * Is called when the pointer button is released on the renderer element\r\n   *\r\n   * @private\r\n   * @param {PointerEvent} event - The DOM event of a pointer button being released\r\n   */\r\n  private onPointerUp(event: InteractivePointerEvent): void {\r\n    // if we support touch events, then only use those for touch events, not pointer events\r\n    if (\r\n      this.supportsTouchEvents &&\r\n      (event as PointerEvent).pointerType === 'touch'\r\n    ) {\r\n      return\r\n    }\r\n\r\n    this.onPointerComplete(event)\r\n  }\r\n\r\n  /**\r\n   * Is called when the pointer moves across the renderer element\r\n   *\r\n   * @private\r\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer moving\r\n   */\r\n  private onPointerMove(originalEvent: InteractivePointerEvent): void {\r\n    // if we support touch events, then only use those for touch events, not pointer events\r\n    if (\r\n      this.supportsTouchEvents &&\r\n      (originalEvent as PointerEvent).pointerType === 'touch'\r\n    ) {\r\n      return\r\n    }\r\n\r\n    const events = this.normalizeToPointerData(originalEvent)\r\n\r\n    const event = events[0]\r\n\r\n    this.processInteractive(event)\r\n  }\r\n\r\n  /**\r\n   * Is called when the pointer is moved out of the renderer element\r\n   *\r\n   * @private\r\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer being moved out\r\n   */\r\n  private onPointerOut(originalEvent: InteractivePointerEvent): void {\r\n    // if we support touch events, then only use those for touch events, not pointer events\r\n    if (\r\n      this.supportsTouchEvents &&\r\n      (originalEvent as PointerEvent).pointerType === 'touch'\r\n    ) {\r\n      return\r\n    }\r\n\r\n    const events = this.normalizeToPointerData(originalEvent)\r\n\r\n    // Only mouse and pointer can call onPointerOut, so events will always be length 1\r\n    const event = events[0]\r\n\r\n    this.processInteractive(event)\r\n  }\r\n\r\n  /**\r\n   * Is called when the pointer is moved into the renderer element\r\n   *\r\n   * @private\r\n   * @param {PointerEvent} originalEvent - The DOM event of a pointer button being moved into the renderer view\r\n   */\r\n  private onPointerOver(originalEvent: InteractivePointerEvent): void {\r\n    const events = this.normalizeToPointerData(originalEvent)\r\n\r\n    // Only mouse and pointer can call onPointerOver, so events will always be length 1\r\n    const event = events[0]\r\n\r\n    this.processInteractive(event)\r\n  }\r\n\r\n  /**\r\n   * Get InteractionData.\r\n   *\r\n   * @private\r\n   * @param {PointerEvent} event - Normalized pointer event, output from normalizeToPointerData\r\n   * @return {InteractionData} - Interaction data for the given pointer identifier\r\n   */\r\n  private getInteractionData(event: PointerEvent): InteractionData {\r\n    const pointerId = event.pointerId\r\n\r\n    const interactionData = new InteractionData()\r\n    interactionData.identifier = pointerId\r\n\r\n    // copy properties from the event, so that we can make sure that touch/pointer specific\r\n    // data is available\r\n    interactionData.copyEvent(event)\r\n\r\n    return interactionData\r\n  }\r\n\r\n  /**\r\n   * Configure DOM PointerEvent and InteractionData\r\n   *\r\n   * @private\r\n   * @param {PointerEvent} pointerEvent - The DOM event that will be paired with the InteractionEvent\r\n   * @param {PIXI.InteractionData} interactionData - The InteractionData that will be paired\r\n   *        with the InteractionEvent\r\n   */\r\n  private configureInteractionDataForDOMEvent(\r\n    pointerEvent: PointerEvent,\r\n    interactionData: InteractionData\r\n  ): void {\r\n    interactionData.global = this.mapPositionToPoint(\r\n      pointerEvent.clientX,\r\n      pointerEvent.clientY\r\n    )\r\n\r\n    // Not really sure why this is happening, but it's how a previous version handled things\r\n    if (pointerEvent.pointerType === 'touch') {\r\n      ;(pointerEvent as any).globalX = interactionData.global.x\r\n      ;(pointerEvent as any).globalY = interactionData.global.y\r\n    }\r\n\r\n    interactionData.originalEvent = pointerEvent\r\n  }\r\n\r\n  /**\r\n   * Ensures that the original event object contains all data that a regular pointer event would have\r\n   *\r\n   * @private\r\n   * @param {TouchEvent|MouseEvent|PointerEvent} event - The original event data from a touch or mouse event\r\n   * @return {PointerEvent[]} An array containing a single normalized pointer event, in the case of a pointer\r\n   *  or mouse event, or a multiple normalized pointer events if there are multiple changed touches\r\n   */\r\n  private normalizeToPointerData(\r\n    event: InteractivePointerEvent\r\n  ): PointerEvent[] {\r\n    const normalizedEvents = []\r\n\r\n    if (this.supportsTouchEvents && event instanceof TouchEvent) {\r\n      for (let i = 0, li = event.changedTouches.length; i < li; i++) {\r\n        const touch = event.changedTouches[i] as TouchPointerEvent\r\n\r\n        if (typeof touch.button === 'undefined')\r\n          touch.button = event.touches.length ? 1 : 0\r\n        if (typeof touch.buttons === 'undefined')\r\n          touch.buttons = event.touches.length ? 1 : 0\r\n        if (typeof touch.isPrimary === 'undefined') {\r\n          touch.isPrimary =\r\n            event.touches.length === 1 && event.type === 'touchstart'\r\n        }\r\n        if (typeof touch.width === 'undefined') touch.width = touch.radiusX || 1\r\n        if (typeof touch.height === 'undefined')\r\n          touch.height = touch.radiusY || 1\r\n        if (typeof touch.tiltX === 'undefined') touch.tiltX = 0\r\n        if (typeof touch.tiltY === 'undefined') touch.tiltY = 0\r\n        if (typeof touch.pointerType === 'undefined')\r\n          touch.pointerType = 'touch'\r\n        if (typeof touch.pointerId === 'undefined')\r\n          touch.pointerId = touch.identifier || 0\r\n        if (typeof touch.pressure === 'undefined')\r\n          touch.pressure = touch.force || 0.5\r\n        if (typeof touch.twist === 'undefined') touch.twist = 0\r\n        if (typeof touch.tangentialPressure === 'undefined')\r\n          touch.tangentialPressure = 0\r\n        // TODO: Remove these, as layerX/Y is not a standard, is deprecated, has uneven\r\n        // support, and the fill ins are not quite the same\r\n        // offsetX/Y might be okay, but is not the same as clientX/Y when the canvas's top\r\n        // left is not 0,0 on the page\r\n        if (typeof touch.layerX === 'undefined')\r\n          touch.layerX = touch.offsetX = touch.clientX\r\n        if (typeof touch.layerY === 'undefined')\r\n          touch.layerY = touch.offsetY = touch.clientY\r\n\r\n        // mark the touch as normalized, just so that we know we did it\r\n        touch.isNormalized = true\r\n\r\n        normalizedEvents.push(touch)\r\n      }\r\n    }\r\n    // apparently PointerEvent subclasses MouseEvent, so yay\r\n    else if (\r\n      event instanceof MouseEvent &&\r\n      (!this.supportsPointerEvents || !(event instanceof window.PointerEvent))\r\n    ) {\r\n      const tempEvent = event as MousePointerEvent\r\n\r\n      if (typeof tempEvent.isPrimary === 'undefined') tempEvent.isPrimary = true\r\n      if (typeof tempEvent.width === 'undefined') tempEvent.width = 1\r\n      if (typeof tempEvent.height === 'undefined') tempEvent.height = 1\r\n      if (typeof tempEvent.tiltX === 'undefined') tempEvent.tiltX = 0\r\n      if (typeof tempEvent.tiltY === 'undefined') tempEvent.tiltY = 0\r\n      if (typeof tempEvent.pointerType === 'undefined')\r\n        tempEvent.pointerType = 'mouse'\r\n      if (typeof tempEvent.pointerId === 'undefined')\r\n        tempEvent.pointerId = MOUSE_POINTER_ID\r\n      if (typeof tempEvent.pressure === 'undefined') tempEvent.pressure = 0.5\r\n      if (typeof tempEvent.twist === 'undefined') tempEvent.twist = 0\r\n      if (typeof tempEvent.tangentialPressure === 'undefined')\r\n        tempEvent.tangentialPressure = 0\r\n\r\n      // mark the mouse event as normalized, just so that we know we did it\r\n      tempEvent.isNormalized = true\r\n\r\n      normalizedEvents.push(tempEvent)\r\n    } else {\r\n      normalizedEvents.push(event)\r\n    }\r\n\r\n    return normalizedEvents as PointerEvent[]\r\n  }\r\n\r\n  /**\r\n   * Destroys the interaction manager\r\n   *\r\n   */\r\n  public destroy(): void {\r\n    this.removeEvents()\r\n\r\n    this.renderer = null\r\n\r\n    this.mouse = null\r\n\r\n    this.interactionDOMElement = null\r\n\r\n    this.onPointerDown = null\r\n\r\n    this.onPointerUp = null\r\n\r\n    this.onPointerCancel = null\r\n\r\n    this.onPointerMove = null\r\n\r\n    this.onPointerOut = null\r\n\r\n    this.onPointerOver = null\r\n  }\r\n}\r\n\r\ninterface MousePointerEvent extends PointerEvent {\r\n  isPrimary: boolean\r\n  width: number\r\n  height: number\r\n  tiltX: number\r\n  tiltY: number\r\n  pointerType: string\r\n  pointerId: number\r\n  pressure: number\r\n  twist: number\r\n  tangentialPressure: number\r\n  isNormalized: boolean\r\n}\r\n\r\ninterface TouchPointerEvent extends Touch {\r\n  button: number\r\n  buttons: number\r\n  isPrimary: boolean\r\n  width: number\r\n  height: number\r\n  tiltX: number\r\n  tiltY: number\r\n  pointerType: string\r\n  pointerId: number\r\n  pressure: number\r\n  twist: number\r\n  tangentialPressure: number\r\n  layerX: number\r\n  layerY: number\r\n  offsetX: number\r\n  offsetY: number\r\n  isNormalized: boolean\r\n}\r\n","import { Sprite, Texture } from 'pixi.js'\r\n\r\nclass Flower extends Sprite {\r\n  constructor(texture, clientWidth, clientHeight, maxDist) {\r\n    super(texture)\r\n    this.x = Math.random() * (clientWidth + maxDist) - maxDist / 2\r\n    this.y = Math.random() * (clientHeight + maxDist) - maxDist / 2\r\n    this.z = Math.random() * 0.5 + 0.3\r\n    this.vx = (Math.random() * 1 + 1) * this.z\r\n    this.vy = (Math.random() * 0.5 + 1) * this.z\r\n    this.rotation = Math.random() * Math.PI * 2\r\n    this.anchor.set(0.5)\r\n    this.spin = this.rotation > Math.PI ? 1 : -1\r\n  }\r\n}\r\n\r\nexport default class FlowerFlyBackground {\r\n  constructor({ width, height, amount, maxDist, parent, textureId }) {\r\n    this.width = width\r\n    this.height = height\r\n    this.amount = amount\r\n    this.maxDist = maxDist\r\n    this.parent = parent\r\n    this.textureId = textureId\r\n    this.flowerArr = []\r\n\r\n    this.init()\r\n  }\r\n\r\n  init() {\r\n    const { width, height, amount, maxDist, parent } = this\r\n\r\n    for (let i = 0; i < amount; i++) {\r\n      const texture = Texture.from(`title_gold-${this.textureId}`)\r\n      const flower = new Flower(texture, width, height, maxDist)\r\n      this.flowerArr.push(flower)\r\n      parent.addChild(flower)\r\n    }\r\n  }\r\n\r\n  update(obj) {\r\n    const { width, height, maxDist } = this\r\n    obj.rotation += (0.003 * obj.spin)\r\n    obj.x += obj.vx\r\n    obj.y += obj.vy\r\n    if (obj.x > width + maxDist / 2) {\r\n      obj.x = -(maxDist / 2)\r\n    } else if (obj.xpos < -(maxDist / 2)) {\r\n      obj.x = width + maxDist / 2\r\n    }\r\n    if (obj.y > height + maxDist / 2) {\r\n      obj.y = -(maxDist / 2)\r\n    } else if (obj.y < -(maxDist / 2)) {\r\n      obj.y = height + maxDist / 2\r\n    }\r\n  }\r\n\r\n  tick() {\r\n    const { flowerArr } = this\r\n\r\n    flowerArr.forEach(obj => {\r\n      this.update(obj)\r\n    })\r\n  }\r\n}\r\n","import * as PIXI from 'pixi.js'\r\nimport { Signal } from 'signals'\r\nimport FlowerFlyBackground from './flower'\r\nimport { gameInfo, startMenuStyle } from '../../config'\r\nimport { Sound } from '../../../engine/sound'\r\n\r\nconst fontStyle = startMenuStyle\r\n\r\nconst btnDownStyle = {\r\n  fill: '#ffffff',\r\n  stroke: '#F9B541'\r\n}\r\n\r\nexport class Title {\r\n  static onStartClicked = new Signal()\r\n  static onLoadClicked = new Signal()\r\n  static onSettingClicked = new Signal()\r\n  static onAboutClicked = new Signal()\r\n\r\n  constructor() {\r\n    this.view = new PIXI.Container()\r\n    this.init()\r\n  }\r\n\r\n  init() {\r\n    this._bgmPlay()\r\n    this._addBackground()\r\n    this._addPtcLayer()\r\n    this._addMenu()\r\n  }\r\n\r\n  _addBackground() {\r\n    const background = PIXI.Sprite.from('title_background')\r\n    this.view.addChild(background)\r\n  }\r\n\r\n  _addPtcLayer() {\r\n    this.ptcLayer = new PIXI.Container()\r\n    this.view.addChild(this.ptcLayer)\r\n    this.flowerFly = []\r\n    for (let i = 0; i < 5; i++) {\r\n      let amount = 5\r\n      if (i === 2) {\r\n        amount = 2\r\n      }\r\n      this.flowerFly.push(new FlowerFlyBackground({\r\n        width: gameInfo.width,\r\n        height: gameInfo.height,\r\n        amount,\r\n        maxDist: 100,\r\n        parent: this.ptcLayer,\r\n        textureId: i\r\n      }))\r\n    }\r\n  }\r\n\r\n  _addMenu() {\r\n    const group = new PIXI.Container()\r\n    group.x = 365\r\n    group.y = 380\r\n    const start = this._createButton(0, '', () => {\r\n      this._bgmStop()\r\n      Title.onStartClicked.dispatch()\r\n    })\r\n    const load = this._createButton(1, '', () => {\r\n      this._bgmStop()\r\n      Title.onLoadClicked.dispatch()\r\n    })\r\n    const setup = this._createButton(2, '', () => {\r\n      Title.onSettingClicked.dispatch()\r\n    })\r\n    const about = this._createButton(3, '', () => {\r\n      Title.onAboutClicked.dispatch()\r\n    })\r\n    group.addChild(start, load, setup, about)\r\n    this.view.addChild(group)\r\n  }\r\n\r\n  _bgmPlay() {\r\n    Sound.play('system_title', {\r\n      loop: true\r\n    })\r\n  }\r\n\r\n  _bgmStop() {\r\n    Sound.stop('system_title')\r\n  }\r\n\r\n  _createButton(index, text, clickHandle) {\r\n    const btnSpace = 30\r\n    const btn = new PIXI.Text(text, fontStyle)\r\n    btn.y = btnSpace * index\r\n    btn.interactive = true\r\n    btn.buttonMode = true\r\n    // \r\n    btn.resolution = 2\r\n    btn.anchor.set(0.5)\r\n    btn\r\n      .on('pointerdown', onButtonDown)\r\n      .on('pointerup', onButtonUp)\r\n      .on('pointerupoutside', onButtonUp)\r\n      .on('pointerover', onButtonOver)\r\n      .on('pointerout', onButtonOut)\r\n      .on('pointertap', (e) => {\r\n        e.data.originalEvent.preventDefault()\r\n        clickHandle()\r\n      })\r\n    return btn\r\n  }\r\n\r\n  update() {\r\n    this.flowerFly.forEach(item => {\r\n      item.tick()\r\n    })\r\n  }\r\n}\r\n\r\nfunction onButtonDown() {\r\n  const btn = this\r\n  // console.log('pointerdown')\r\n  btn.isdown = true\r\n  btn.scale.set(0.95)\r\n}\r\n\r\nfunction onButtonUp() {\r\n  const btn = this\r\n  if (btn.isOver) {\r\n    btn.style.fill = btnDownStyle.fill\r\n    btn.style.stroke = btnDownStyle.stroke\r\n  } else {\r\n    btn.style.fill = fontStyle.fill\r\n    btn.style.stroke = fontStyle.stroke\r\n  }\r\n  if (!btn.isdown) {\r\n    return\r\n  }\r\n  // console.log('pointerup')\r\n  btn.isdown = false\r\n  btn.scale.set(1)\r\n}\r\n\r\nfunction onButtonOver() {\r\n  const btn = this\r\n  btn.isOver = true\r\n  // console.log('pointerover')\r\n  if (btn.isdown) {\r\n    return\r\n  }\r\n  btn.style.fill = btnDownStyle.fill\r\n  btn.style.stroke = btnDownStyle.stroke\r\n}\r\n\r\nfunction onButtonOut() {\r\n  const btn = this\r\n  btn.isOver = false\r\n  if (btn.isdown) {\r\n    return\r\n  }\r\n  // console.log('pointerout')\r\n  btn.style.fill = fontStyle.fill\r\n  btn.style.stroke = fontStyle.stroke\r\n}\r\n","import * as PIXI from 'pixi.js'\r\nimport { IComponent } from '../../core'\r\n\r\ntype Anchor = {\r\n  x: number\r\n  y: number\r\n}\r\n\r\nexport default class RenderComponent extends IComponent {\r\n  // serialize fields\r\n  public layer: string\r\n  /**  */\r\n  public anchor: Anchor\r\n  public visible: boolean\r\n  // temp fields\r\n  public view: PIXI.Container\r\n  public isRender: boolean\r\n\r\n  constructor() {\r\n    super()\r\n    this.layer = 'UserLayer0'\r\n    this.anchor = {\r\n      x: 0,\r\n      y: 0\r\n    }\r\n    this.visible = true\r\n\r\n    this.view = null\r\n    this.isRender = false\r\n  }\r\n\r\n  public revert() {\r\n    this.layer = 'UserLayer0'\r\n    this.anchor = {\r\n      x: 0,\r\n      y: 0\r\n    }\r\n    this.visible = true\r\n\r\n    if (this.view) {\r\n      this.view.destroy()\r\n      this.view = null\r\n    }\r\n    this.isRender = false\r\n  }\r\n\r\n  public getRenderJSON() {\r\n    const { layer, anchor, visible } = this\r\n    return { layer, anchor, visible }\r\n  }\r\n}\r\n","import { Sprite, Texture } from 'pixi.js'\r\nimport RenderComponent from './base/render'\r\nimport { componentRegister } from '../core'\r\n\r\nexport class SpriteComponent extends RenderComponent {\r\n  // serialize fields\r\n  public textureId: string\r\n  // temp fields\r\n  public texture: Texture\r\n\r\n  constructor() {\r\n    super()\r\n    this.textureId = null\r\n    this.texture = null\r\n  }\r\n\r\n  public init() {\r\n    if (this.textureId) {\r\n      this.texture = Texture.from(this.textureId)\r\n    } else {\r\n      this.texture = Texture.EMPTY\r\n    }\r\n    this.view = new Sprite(this.texture)\r\n  }\r\n\r\n  public clear() {\r\n    this.revert()\r\n    this.textureId = null\r\n    this.texture = null\r\n  }\r\n\r\n  public toJSON() {\r\n    const { textureId } = this\r\n    const render = this.getRenderJSON()\r\n\r\n    return {\r\n      textureId,\r\n      ...render\r\n    }\r\n  }\r\n}\r\n\r\ncomponentRegister('SpriteComponent')(SpriteComponent)\r\n","import { AnimatedSprite, Texture } from 'pixi.js'\r\nimport RenderComponent from './base/render'\r\nimport { componentRegister } from '../core'\r\n\r\nexport class AnimationComponent extends RenderComponent {\r\n  // serialize fields\r\n  public texturesId: string[]\r\n  public loop: boolean\r\n  public animationSpeed: number\r\n  public playing: boolean\r\n  /**  */\r\n  public cycle: number\r\n  // temp fields\r\n  public textures: Texture[]\r\n\r\n  constructor() {\r\n    super()\r\n    this.texturesId = null\r\n    this.loop = true\r\n    this.animationSpeed = 1\r\n    this.playing = true\r\n    this.cycle = 0\r\n\r\n    this.textures = null\r\n  }\r\n\r\n  public init() {\r\n    if (this.texturesId === null) {\r\n      this.textures = [Texture.EMPTY]\r\n    } else {\r\n      const count = this.texturesId.length\r\n      const fillFrames = this.getFillFrames()\r\n      this.textures = []\r\n\r\n      for (let i = 0; i < fillFrames - count; i++) {\r\n        const texture = Texture.from(this.texturesId[0])\r\n        this.textures.push(texture)\r\n      }\r\n      for (let i = 0; i < count; i++) {\r\n        const texture = Texture.from(this.texturesId[i])\r\n        this.textures.push(texture)\r\n      }\r\n    }\r\n\r\n    this.view = new AnimatedSprite(this.textures)\r\n  }\r\n\r\n  /**\r\n   * \r\n   * \r\n   * @returns {number}\r\n   */\r\n  public getFillFrames(): number {\r\n    return this.cycle * this.animationSpeed / 1000 * 60\r\n  }\r\n\r\n  public clear() {\r\n    this.revert()\r\n    this.texturesId = null\r\n    this.loop = true\r\n    this.animationSpeed = 1\r\n    this.playing = true\r\n    this.cycle = 0\r\n\r\n    this.textures = null\r\n  }\r\n\r\n  public toJSON() {\r\n    const { texturesId, loop, animationSpeed, playing, cycle } = this\r\n    const render = this.getRenderJSON()\r\n\r\n    return {\r\n      texturesId, loop, animationSpeed, playing, cycle,\r\n      ...render\r\n    }\r\n  }\r\n}\r\n\r\ncomponentRegister('AnimationComponent')(AnimationComponent)\r\n","/* eslint max-depth: [2, 8] */\r\nimport { Sprite } from '@pixi/sprite';\r\nimport { Texture } from '@pixi/core';\r\nimport { settings } from '@pixi/settings';\r\nimport { Rectangle } from '@pixi/math';\r\nimport { sign, trimCanvas, hex2rgb, string2hex } from '@pixi/utils';\r\nimport { TextStyle, TextMetrics } from '@pixi/text';\r\n\r\nconst TEXT_GRADIENT = {\r\n    LINEAR_VERTICAL: 0,\r\n    LINEAR_HORIZONTAL: 1,\r\n};\r\n\r\nconst defaultDestroyOptions = {\r\n    texture: true,\r\n    children: false,\r\n    baseTexture: true,\r\n};\r\n\r\nfunction processBbcode(tokens, token, i, magic) {\r\n    let type = 'none';\r\n    let index = i;\r\n    let params = {};\r\n    if (token === '[') {\r\n        index += magic; // magic should be 3 or 7\r\n        let bbcode = tokens.slice(i, index + 1).join('');\r\n        if (bbcode === '[style={') {\r\n            let json = '';\r\n            let tmp;\r\n            do {\r\n                tmp = tokens[index];\r\n                json += tmp;\r\n                index++;\r\n            } while (tmp !== '}')\r\n            params = JSON.parse(json);\r\n            type = 'open';\r\n        } else if (bbcode === '[/style]') {\r\n            type = 'close';\r\n        }\r\n    }\r\n\r\n    return {\r\n        type,\r\n        index,\r\n        params\r\n    };\r\n}\r\n\r\nTextMetrics.tokenize = function (text) {\r\n    const tokens = [];\r\n    let token = '';\r\n    if (typeof text !== 'string') {\r\n        return tokens;\r\n    }\r\n\r\n    for (let i = 0; i < text.length; i++) {\r\n        const char = text[i];\r\n        if (!/[a-z'-]/i.test(char)) {\r\n            if (token !== '') {\r\n                tokens.push(token);\r\n                token = '';\r\n            }\r\n            tokens.push(char);\r\n        } else {\r\n            token += char;\r\n        }\r\n    }\r\n\r\n    if (token !== '') {\r\n        tokens.push(token);\r\n    }\r\n\r\n    return tokens;\r\n}\r\n\r\nTextMetrics.wordWrap = function(text, style, canvas = TextMetrics._canvas) {\r\n    const context = canvas.getContext('2d');\r\n    let width = 0;\r\n    let line = '';\r\n    let lines = '';\r\n    const cache = {};\r\n    const { letterSpacing, whiteSpace } = style;\r\n    // How to handle whitespaces\r\n    const collapseSpaces = TextMetrics.collapseSpaces(whiteSpace);\r\n    const collapseNewlines = TextMetrics.collapseNewlines(whiteSpace);\r\n    // whether or not spaces may be added to the beginning of lines\r\n    let canPrependSpaces = !collapseSpaces;\r\n    // There is letterSpacing after every char except the last one\r\n    // t_h_i_s_' '_i_s_' '_a_n_' '_e_x_a_m_p_l_e_' '_!\r\n    // so for convenience the above needs to be compared to width + 1 extra letterSpace\r\n    // t_h_i_s_' '_i_s_' '_a_n_' '_e_x_a_m_p_l_e_' '_!_\r\n    // ________________________________________________\r\n    // And then the final space is simply no appended to each line\r\n    const wordWrapWidth = style.wordWrapWidth + letterSpacing;\r\n    // break text into words, spaces and newline chars\r\n    const tokens = TextMetrics.tokenize(text);\r\n    for (let i = 0; i < tokens.length; i++) {\r\n        // get the word, space or newlineChar\r\n        let token = tokens[i];\r\n        // parse bbcode and adjust index\r\n        const result = processBbcode(tokens, token, i, 3);\r\n        if (result.type !== 'none') {\r\n            i = result.index + 1;\r\n            if (i >= tokens.length) {\r\n                continue;\r\n            }\r\n            token = tokens[i];\r\n        }\r\n        // if word is a new line\r\n        if (TextMetrics.isNewline(token)) {\r\n            // keep the new line\r\n            if (!collapseNewlines) {\r\n                lines += TextMetrics.addLine(line);\r\n                canPrependSpaces = !collapseSpaces;\r\n                line = '';\r\n                width = 0;\r\n                continue;\r\n            }\r\n            // if we should collapse new lines\r\n            // we simply convert it into a space\r\n            token = ' ';\r\n        }\r\n        // if we should collapse repeated whitespaces\r\n        if (collapseSpaces) {\r\n            // check both this and the last tokens for spaces\r\n            const currIsBreakingSpace = TextMetrics.isBreakingSpace(token);\r\n            const lastIsBreakingSpace = TextMetrics.isBreakingSpace(line[line.length - 1]);\r\n            if (currIsBreakingSpace && lastIsBreakingSpace) {\r\n                continue;\r\n            }\r\n        }\r\n        // get word width from cache if possible\r\n        const tokenWidth = TextMetrics.getFromCache(token, letterSpacing, cache, context);\r\n        // word is longer than desired bounds\r\n        if (tokenWidth > wordWrapWidth) {\r\n            // if we are not already at the beginning of a line\r\n            if (line !== '') {\r\n                // start newlines for overflow words\r\n                lines += TextMetrics.addLine(line);\r\n                line = '';\r\n                width = 0;\r\n            }\r\n            // break large word over multiple lines\r\n            if (TextMetrics.canBreakWords(token, style.breakWords)) {\r\n                // break word into characters\r\n                const characters = TextMetrics.wordWrapSplit(token);\r\n                // loop the characters\r\n                for (let j = 0; j < characters.length; j++) {\r\n                    let char = characters[j];\r\n                    let k = 1;\r\n                    // we are not at the end of the token\r\n                    while (characters[j + k]) {\r\n                        const nextChar = characters[j + k];\r\n                        const lastChar = char[char.length - 1];\r\n                        // should not split chars\r\n                        if (!TextMetrics.canBreakChars(lastChar, nextChar, token, j, style.breakWords)) {\r\n                            // combine chars & move forward one\r\n                            char += nextChar;\r\n                        }\r\n                        else {\r\n                            break;\r\n                        }\r\n                        k++;\r\n                    }\r\n                    j += char.length - 1;\r\n                    const characterWidth = TextMetrics.getFromCache(char, letterSpacing, cache, context);\r\n                    if (characterWidth + width > wordWrapWidth) {\r\n                        lines += TextMetrics.addLine(line);\r\n                        canPrependSpaces = false;\r\n                        line = '';\r\n                        width = 0;\r\n                    }\r\n                    line += char;\r\n                    width += characterWidth;\r\n                }\r\n            }\r\n            // run word out of the bounds\r\n            else {\r\n                // if there are words in this line already\r\n                // finish that line and start a new one\r\n                if (line.length > 0) {\r\n                    lines += TextMetrics.addLine(line);\r\n                    line = '';\r\n                    width = 0;\r\n                }\r\n                const isLastToken = i === tokens.length - 1;\r\n                // give it its own line if it's not the end\r\n                lines += TextMetrics.addLine(token, !isLastToken);\r\n                canPrependSpaces = false;\r\n                line = '';\r\n                width = 0;\r\n            }\r\n        }\r\n        // word could fit\r\n        else {\r\n            // word won't fit because of existing words\r\n            // start a new line\r\n            if (tokenWidth + width > wordWrapWidth) {\r\n                // if its a space we don't want it\r\n                canPrependSpaces = false;\r\n                // add a new line\r\n                lines += TextMetrics.addLine(line);\r\n                // start a new line\r\n                line = '';\r\n                width = 0;\r\n            }\r\n            // don't add spaces to the beginning of lines\r\n            if (line.length > 0 || !TextMetrics.isBreakingSpace(token) || canPrependSpaces) {\r\n                // add the word to the current line\r\n                line += token;\r\n                // update width counter\r\n                width += tokenWidth;\r\n            }\r\n        }\r\n    }\r\n    lines += TextMetrics.addLine(line, false);\r\n    return lines;\r\n}\r\n\r\nexport class RainbowText extends Sprite {\r\n    /**\r\n     * @param {string} text - The string that you would like the text to display\r\n     * @param {object|PIXI.TextStyle} [style] - The style parameters\r\n     * @param {HTMLCanvasElement} [canvas] - The canvas element for drawing text\r\n     */\r\n    constructor(text, style, canvas) {\r\n        let ownCanvas = false;\r\n        if (!canvas) {\r\n            canvas = document.createElement('canvas');\r\n            ownCanvas = true;\r\n        }\r\n        canvas.width = 3;\r\n        canvas.height = 3;\r\n        const texture = Texture.from(canvas);\r\n        texture.orig = new Rectangle();\r\n        texture.trim = new Rectangle();\r\n        super(texture);\r\n        /**\r\n         * Keep track if this Text object created it's own canvas\r\n         * element (`true`) or uses the constructor argument (`false`).\r\n         * Used to workaround a GC issues with Safari < 13 when\r\n         * destroying Text. See `destroy` for more info.\r\n         *\r\n         * @member {boolean}\r\n         * @private\r\n         */\r\n        this._ownCanvas = ownCanvas;\r\n        /**\r\n         * The canvas element that everything is drawn to\r\n         *\r\n         * @member {HTMLCanvasElement}\r\n         */\r\n        this.canvas = canvas;\r\n        /**\r\n         * The canvas 2d context that everything is drawn with\r\n         * @member {CanvasRenderingContext2D}\r\n         */\r\n        this.context = this.canvas.getContext('2d');\r\n        /**\r\n         * The resolution / device pixel ratio of the canvas.\r\n         * This is set to automatically match the renderer resolution by default, but can be overridden by setting manually.\r\n         * @member {number}\r\n         * @default 1\r\n         */\r\n        this._resolution = settings.RESOLUTION;\r\n        this._autoResolution = true;\r\n        /**\r\n         * Private tracker for the current text.\r\n         *\r\n         * @member {string}\r\n         * @private\r\n         */\r\n        this._text = null;\r\n        /**\r\n         * Private tracker for the current style.\r\n         *\r\n         * @member {object}\r\n         * @private\r\n         */\r\n        this._style = null;\r\n        /**\r\n         * Private listener to track style changes.\r\n         *\r\n         * @member {Function}\r\n         * @private\r\n         */\r\n        this._styleListener = null;\r\n        /**\r\n         * Private tracker for the current font.\r\n         *\r\n         * @member {string}\r\n         * @private\r\n         */\r\n        this._font = '';\r\n        this.text = text;\r\n        this.style = style;\r\n        this.localStyleID = -1;\r\n        this.bbcodeFillIndex = 0;\r\n        this.bbcodeStrokeIndex = 0;\r\n    }\r\n    /**\r\n     * Renders text to its canvas, and updates its texture.\r\n     * By default this is used internally to ensure the texture is correct before rendering,\r\n     * but it can be used called externally, for example from this class to 'pre-generate' the texture from a piece of text,\r\n     * and then shared across multiple Sprites.\r\n     *\r\n     * @param {boolean} respectDirty - Whether to abort updating the text if the Text isn't dirty and the function is called.\r\n     */\r\n    updateText(respectDirty) {\r\n        const style = this._style;\r\n        // check if style has changed..\r\n        if (this.localStyleID !== style.styleID) {\r\n            this.dirty = true;\r\n            this.localStyleID = style.styleID;\r\n        }\r\n        if (!this.dirty && respectDirty) {\r\n            return;\r\n        }\r\n        this._font = this._style.toFontString();\r\n        const context = this.context;\r\n        const measured = TextMetrics.measureText(this._text || ' ', this._style, this._style.wordWrap, this.canvas);\r\n        const width = measured.width;\r\n        const height = measured.height;\r\n        const lines = measured.lines;\r\n        const lineHeight = measured.lineHeight;\r\n        const lineWidths = measured.lineWidths;\r\n        const maxLineWidth = measured.maxLineWidth;\r\n        const fontProperties = measured.fontProperties;\r\n        this.canvas.width = Math.ceil((Math.max(1, width) + (style.padding * 2)) * this._resolution);\r\n        this.canvas.height = Math.ceil((Math.max(1, height) + (style.padding * 2)) * this._resolution);\r\n        context.scale(this._resolution, this._resolution);\r\n        context.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n        context.font = this._font;\r\n        context.lineWidth = style.strokeThickness;\r\n        context.textBaseline = style.textBaseline;\r\n        context.lineJoin = style.lineJoin;\r\n        context.miterLimit = style.miterLimit;\r\n        let linePositionX;\r\n        let linePositionY;\r\n        // require 2 passes if a shadow; the first to draw the drop shadow, the second to draw the text\r\n        const passesCount = style.dropShadow ? 2 : 1;\r\n        // For v4, we drew text at the colours of the drop shadow underneath the normal text. This gave the correct zIndex,\r\n        // but features such as alpha and shadowblur did not look right at all, since we were using actual text as a shadow.\r\n        //\r\n        // For v5.0.0, we moved over to just use the canvas API for drop shadows, which made them look much nicer and more\r\n        // visually please, but now because the stroke is drawn and then the fill, drop shadows would appear on both the fill\r\n        // and the stroke; and fill drop shadows would appear over the top of the stroke.\r\n        //\r\n        // For v5.1.1, the new route is to revert to v4 style of drawing text first to get the drop shadows underneath normal\r\n        // text, but instead drawing text in the correct location, we'll draw it off screen (-paddingY), and then adjust the\r\n        // drop shadow so only that appears on screen (+paddingY). Now we'll have the correct draw order of the shadow\r\n        // beneath the text, whilst also having the proper text shadow styling.\r\n        for (let i = 0; i < passesCount; ++i) {\r\n            const isShadowPass = style.dropShadow && i === 0;\r\n            const dsOffsetText = isShadowPass ? height * 2 : 0; // we only want the drop shadow, so put text way off-screen\r\n            const dsOffsetShadow = dsOffsetText * this.resolution;\r\n            if (isShadowPass) {\r\n                // On Safari, text with gradient and drop shadows together do not position correctly\r\n                // if the scale of the canvas is not 1: https://bugs.webkit.org/show_bug.cgi?id=197689\r\n                // Therefore we'll set the styles to be a plain black whilst generating this drop shadow\r\n                context.fillStyle = 'black';\r\n                context.strokeStyle = 'black';\r\n                const dropShadowColor = style.dropShadowColor;\r\n                const rgb = hex2rgb(typeof dropShadowColor === 'number' ? dropShadowColor : string2hex(dropShadowColor));\r\n                context.shadowColor = `rgba(${rgb[0] * 255},${rgb[1] * 255},${rgb[2] * 255},${style.dropShadowAlpha})`;\r\n                context.shadowBlur = style.dropShadowBlur;\r\n                context.shadowOffsetX = Math.cos(style.dropShadowAngle) * style.dropShadowDistance;\r\n                context.shadowOffsetY = (Math.sin(style.dropShadowAngle) * style.dropShadowDistance) + dsOffsetShadow;\r\n            }\r\n            else {\r\n                // set canvas text styles\r\n                context.fillStyle = this._generateFillStyle(style, lines, measured);\r\n                // TODO: Can't have different types for getter and setter. The getter shouldn't have the number type as\r\n                //       the setter converts to string. See this thread for more details:\r\n                //       https://github.com/microsoft/TypeScript/issues/2521\r\n                context.strokeStyle = style.stroke;\r\n                context.shadowColor = '0';\r\n                context.shadowBlur = 0;\r\n                context.shadowOffsetX = 0;\r\n                context.shadowOffsetY = 0;\r\n            }\r\n            // draw lines line by line\r\n            const text = this._text.replace(/(?:\\r\\n|\\r|\\n)/g, '');\r\n            const originText = Array.from ? Array.from(text) : text.split('');\r\n            for (let i = 0; i < lines.length; i++) {\r\n                linePositionX = style.strokeThickness / 2;\r\n                linePositionY = ((style.strokeThickness / 2) + (i * lineHeight)) + fontProperties.ascent;\r\n                if (style.align === 'right') {\r\n                    linePositionX += maxLineWidth - lineWidths[i];\r\n                }\r\n                else if (style.align === 'center') {\r\n                    linePositionX += (maxLineWidth - lineWidths[i]) / 2;\r\n                }\r\n\r\n                if (style.stroke && style.strokeThickness) {\r\n                    this.drawLetterSpacing(originText, lines[i], linePositionX + style.padding, linePositionY + style.padding - dsOffsetText, true);\r\n                }\r\n                if (style.fill) {\r\n                    this.drawLetterSpacing(originText, lines[i], linePositionX + style.padding, linePositionY + style.padding - dsOffsetText);\r\n                }\r\n            }\r\n            this.bbcodeFillIndex = 0\r\n            this.bbcodeStrokeIndex = 0\r\n        }\r\n        this.updateTexture();\r\n    }\r\n    /**\r\n     * Render the text with letter-spacing.\r\n     * @param {string} text - The text to draw\r\n     * @param {number} x - Horizontal position to draw the text\r\n     * @param {number} y - Vertical position to draw the text\r\n     * @param {boolean} [isStroke=false] - Is this drawing for the outside stroke of the\r\n     *  text? If not, it's for the inside fill\r\n     * @private\r\n     */\r\n    drawLetterSpacing(originText, text, x, y, isStroke = false) {\r\n        const style = this._style;\r\n        // letterSpacing of 0 means normal\r\n        const letterSpacing = style.letterSpacing;\r\n        let currentPosition = x;\r\n        // Using Array.from correctly splits characters whilst keeping emoji together.\r\n        // This is not supported on IE as it requires ES6, so regular text splitting occurs.\r\n        // This also doesn't account for emoji that are multiple emoji put together to make something else.\r\n        // Handling all of this would require a big library itself.\r\n        // https://medium.com/@giltayar/iterating-over-emoji-characters-the-es6-way-f06e4589516\r\n        // https://github.com/orling/grapheme-splitter\r\n        const stringArray = Array.from ? Array.from(text) : text.split('');\r\n        let previousWidth = this.context.measureText(text).width;\r\n        let currentWidth = 0;\r\n        for (let i = 0; i < stringArray.length; ++i) {\r\n            const currentChar = stringArray[i];\r\n            if (isStroke) {\r\n                const result = processBbcode(originText, originText[this.bbcodeStrokeIndex], this.bbcodeStrokeIndex, 7);\r\n                if (result.type === 'open') {\r\n                    const params = result.params;\r\n                    if (params.fill) {\r\n                        this.context.strokeStyle = params.stroke;\r\n                    }\r\n                } else if (result.type === 'close') {\r\n                    this.context.strokeStyle = style.stroke;\r\n                }\r\n                if (result.type !== 'none') {\r\n                    const offset = result.index - this.bbcodeStrokeIndex;\r\n                    this.bbcodeStrokeIndex = this.bbcodeStrokeIndex + offset + 1;\r\n                    if (this.bbcodeStrokeIndex >= originText.length) {\r\n                        continue;\r\n                    }\r\n                }\r\n                this.bbcodeStrokeIndex++;\r\n                this.context.strokeText(currentChar, currentPosition, y);\r\n            }\r\n            else {\r\n                const result = processBbcode(originText, originText[this.bbcodeFillIndex], this.bbcodeFillIndex, 7);\r\n                if (result.type === 'open') {\r\n                    const params = result.params;\r\n                    if (params.fill) {\r\n                        this.context.fillStyle = params.fill;\r\n                    }\r\n                } else if (result.type === 'close') {\r\n                    this.context.fillStyle = style.fill;\r\n                }\r\n                if (result.type !== 'none') {\r\n                    const offset = result.index - this.bbcodeFillIndex;\r\n                    this.bbcodeFillIndex = this.bbcodeFillIndex + offset + 1;\r\n                    if (this.bbcodeFillIndex >= originText.length) {\r\n                        continue;\r\n                    }\r\n                }\r\n                this.bbcodeFillIndex++;\r\n                this.context.fillText(currentChar, currentPosition, y);\r\n            }\r\n            currentWidth = this.context.measureText(text.substring(i + 1)).width;\r\n            currentPosition += previousWidth - currentWidth + letterSpacing;\r\n            previousWidth = currentWidth;\r\n        }\r\n    }\r\n    /**\r\n     * Updates texture size based on canvas size\r\n     *\r\n     * @private\r\n     */\r\n    updateTexture() {\r\n        const canvas = this.canvas;\r\n        if (this._style.trim) {\r\n            const trimmed = trimCanvas(canvas);\r\n            if (trimmed.data) {\r\n                canvas.width = trimmed.width;\r\n                canvas.height = trimmed.height;\r\n                this.context.putImageData(trimmed.data, 0, 0);\r\n            }\r\n        }\r\n        const texture = this._texture;\r\n        const style = this._style;\r\n        const padding = style.trim ? 0 : style.padding;\r\n        const baseTexture = texture.baseTexture;\r\n        texture.trim.width = texture._frame.width = Math.ceil(canvas.width / this._resolution);\r\n        texture.trim.height = texture._frame.height = Math.ceil(canvas.height / this._resolution);\r\n        texture.trim.x = -padding;\r\n        texture.trim.y = -padding;\r\n        texture.orig.width = texture._frame.width - (padding * 2);\r\n        texture.orig.height = texture._frame.height - (padding * 2);\r\n        // call sprite onTextureUpdate to update scale if _width or _height were set\r\n        this._onTextureUpdate();\r\n        baseTexture.setRealSize(canvas.width, canvas.height, this._resolution);\r\n        // Recursively updates transform of all objects from the root to this one\r\n        this._recursivePostUpdateTransform();\r\n        this.dirty = false;\r\n    }\r\n    /**\r\n     * Renders the object using the WebGL renderer\r\n     *\r\n     * @protected\r\n     * @param {PIXI.Renderer} renderer - The renderer\r\n     */\r\n    _render(renderer) {\r\n        if (this._autoResolution && this._resolution !== renderer.resolution) {\r\n            this._resolution = renderer.resolution;\r\n            this.dirty = true;\r\n        }\r\n        this.updateText(true);\r\n        super._render(renderer);\r\n    }\r\n    /**\r\n     * Gets the local bounds of the text object.\r\n     *\r\n     * @param {PIXI.Rectangle} rect - The output rectangle.\r\n     * @return {PIXI.Rectangle} The bounds.\r\n     */\r\n    getLocalBounds(rect) {\r\n        this.updateText(true);\r\n        return super.getLocalBounds.call(this, rect);\r\n    }\r\n    /**\r\n     * calculates the bounds of the Text as a rectangle. The bounds calculation takes the worldTransform into account.\r\n     * @protected\r\n     */\r\n    _calculateBounds() {\r\n        this.updateText(true);\r\n        this.calculateVertices();\r\n        // if we have already done this on THIS frame.\r\n        this._bounds.addQuad(this.vertexData);\r\n    }\r\n    /**\r\n     * Generates the fill style. Can automatically generate a gradient based on the fill style being an array\r\n     *\r\n     * @private\r\n     * @param {object} style - The style.\r\n     * @param {string[]} lines - The lines of text.\r\n     * @return {string|number|CanvasGradient} The fill style\r\n     */\r\n    _generateFillStyle(style, lines, metrics) {\r\n        // TODO: Can't have different types for getter and setter. The getter shouldn't have the number type as\r\n        //       the setter converts to string. See this thread for more details:\r\n        //       https://github.com/microsoft/TypeScript/issues/2521\r\n        const fillStyle = style.fill;\r\n        if (!Array.isArray(fillStyle)) {\r\n            return fillStyle;\r\n        }\r\n        else if (fillStyle.length === 1) {\r\n            return fillStyle[0];\r\n        }\r\n        // the gradient will be evenly spaced out according to how large the array is.\r\n        // ['#FF0000', '#00FF00', '#0000FF'] would created stops at 0.25, 0.5 and 0.75\r\n        let gradient;\r\n        // a dropshadow will enlarge the canvas and result in the gradient being\r\n        // generated with the incorrect dimensions\r\n        const dropShadowCorrection = (style.dropShadow) ? style.dropShadowDistance : 0;\r\n        // should also take padding into account, padding can offset the gradient\r\n        const padding = style.padding || 0;\r\n        const width = Math.ceil(this.canvas.width / this._resolution) - dropShadowCorrection - (padding * 2);\r\n        const height = Math.ceil(this.canvas.height / this._resolution) - dropShadowCorrection - (padding * 2);\r\n        // make a copy of the style settings, so we can manipulate them later\r\n        const fill = fillStyle.slice();\r\n        const fillGradientStops = style.fillGradientStops.slice();\r\n        // wanting to evenly distribute the fills. So an array of 4 colours should give fills of 0.25, 0.5 and 0.75\r\n        if (!fillGradientStops.length) {\r\n            const lengthPlus1 = fill.length + 1;\r\n            for (let i = 1; i < lengthPlus1; ++i) {\r\n                fillGradientStops.push(i / lengthPlus1);\r\n            }\r\n        }\r\n        // stop the bleeding of the last gradient on the line above to the top gradient of the this line\r\n        // by hard defining the first gradient colour at point 0, and last gradient colour at point 1\r\n        fill.unshift(fillStyle[0]);\r\n        fillGradientStops.unshift(0);\r\n        fill.push(fillStyle[fillStyle.length - 1]);\r\n        fillGradientStops.push(1);\r\n        if (style.fillGradientType === TEXT_GRADIENT.LINEAR_VERTICAL) {\r\n            // start the gradient at the top center of the canvas, and end at the bottom middle of the canvas\r\n            gradient = this.context.createLinearGradient(width / 2, padding, width / 2, height + padding);\r\n            // we need to repeat the gradient so that each individual line of text has the same vertical gradient effect\r\n            // ['#FF0000', '#00FF00', '#0000FF'] over 2 lines would create stops at 0.125, 0.25, 0.375, 0.625, 0.75, 0.875\r\n            // There's potential for floating point precision issues at the seams between gradient repeats.\r\n            // The loop below generates the stops in order, so track the last generated one to prevent\r\n            // floating point precision from making us go the teeniest bit backwards, resulting in\r\n            // the first and last colors getting swapped.\r\n            let lastIterationStop = 0;\r\n            // Actual height of the text itself, not counting spacing for lineHeight/leading/dropShadow etc\r\n            const textHeight = metrics.fontProperties.fontSize + style.strokeThickness;\r\n            // textHeight, but as a 0-1 size in global gradient stop space\r\n            const gradStopLineHeight = textHeight / height;\r\n            for (let i = 0; i < lines.length; i++) {\r\n                const thisLineTop = metrics.lineHeight * i;\r\n                for (let j = 0; j < fill.length; j++) {\r\n                    // 0-1 stop point for the current line, multiplied to global space afterwards\r\n                    let lineStop = 0;\r\n                    if (typeof fillGradientStops[j] === 'number') {\r\n                        lineStop = fillGradientStops[j];\r\n                    }\r\n                    else {\r\n                        lineStop = j / fill.length;\r\n                    }\r\n                    const globalStop = (thisLineTop / height) + (lineStop * gradStopLineHeight);\r\n                    // Prevent color stop generation going backwards from floating point imprecision\r\n                    let clampedStop = Math.max(lastIterationStop, globalStop);\r\n                    clampedStop = Math.min(clampedStop, 1); // Cap at 1 as well for safety's sake to avoid a possible throw.\r\n                    gradient.addColorStop(clampedStop, fill[j]);\r\n                    lastIterationStop = clampedStop;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            // start the gradient at the center left of the canvas, and end at the center right of the canvas\r\n            gradient = this.context.createLinearGradient(padding, height / 2, width + padding, height / 2);\r\n            // can just evenly space out the gradients in this case, as multiple lines makes no difference\r\n            // to an even left to right gradient\r\n            const totalIterations = fill.length + 1;\r\n            let currentIteration = 1;\r\n            for (let i = 0; i < fill.length; i++) {\r\n                let stop;\r\n                if (typeof fillGradientStops[i] === 'number') {\r\n                    stop = fillGradientStops[i];\r\n                }\r\n                else {\r\n                    stop = currentIteration / totalIterations;\r\n                }\r\n                gradient.addColorStop(stop, fill[i]);\r\n                currentIteration++;\r\n            }\r\n        }\r\n        return gradient;\r\n    }\r\n    /**\r\n     * Destroys this text object.\r\n     * Note* Unlike a Sprite, a Text object will automatically destroy its baseTexture and texture as\r\n     * the majority of the time the texture will not be shared with any other Sprites.\r\n     *\r\n     * @param {object|boolean} [options] - Options parameter. A boolean will act as if all options\r\n     *  have been set to that value\r\n     * @param {boolean} [options.children=false] - if set to true, all the children will have their\r\n     *  destroy method called as well. 'options' will be passed on to those calls.\r\n     * @param {boolean} [options.texture=true] - Should it destroy the current texture of the sprite as well\r\n     * @param {boolean} [options.baseTexture=true] - Should it destroy the base texture of the sprite as well\r\n     */\r\n    destroy(options) {\r\n        if (typeof options === 'boolean') {\r\n            options = { children: options };\r\n        }\r\n        options = Object.assign({}, defaultDestroyOptions, options);\r\n        super.destroy(options);\r\n        // set canvas width and height to 0 to workaround memory leak in Safari < 13\r\n        // https://stackoverflow.com/questions/52532614/total-canvas-memory-use-exceeds-the-maximum-limit-safari-12\r\n        if (this._ownCanvas) {\r\n            this.canvas.height = this.canvas.width = 0;\r\n        }\r\n        // make sure to reset the the context and canvas.. dont want this hanging around in memory!\r\n        this.context = null;\r\n        this.canvas = null;\r\n        this._style = null;\r\n    }\r\n    /**\r\n     * The width of the Text, setting this will actually modify the scale to achieve the value set\r\n     *\r\n     * @member {number}\r\n     */\r\n    get width() {\r\n        this.updateText(true);\r\n        return Math.abs(this.scale.x) * this._texture.orig.width;\r\n    }\r\n    set width(value) {\r\n        this.updateText(true);\r\n        const s = sign(this.scale.x) || 1;\r\n        this.scale.x = s * value / this._texture.orig.width;\r\n        this._width = value;\r\n    }\r\n    /**\r\n     * The height of the Text, setting this will actually modify the scale to achieve the value set\r\n     *\r\n     * @member {number}\r\n     */\r\n    get height() {\r\n        this.updateText(true);\r\n        return Math.abs(this.scale.y) * this._texture.orig.height;\r\n    }\r\n    set height(value) {\r\n        this.updateText(true);\r\n        const s = sign(this.scale.y) || 1;\r\n        this.scale.y = s * value / this._texture.orig.height;\r\n        this._height = value;\r\n    }\r\n    /**\r\n     * Set the style of the text. Set up an event listener to listen for changes on the style\r\n     * object and mark the text as dirty.\r\n     *\r\n     * @member {object|PIXI.TextStyle}\r\n     */\r\n    get style() {\r\n        // TODO: Can't have different types for getter and setter. The getter shouldn't have the ITextStyle\r\n        //       since the setter creates the TextStyle. See this thread for more details:\r\n        //       https://github.com/microsoft/TypeScript/issues/2521\r\n        return this._style;\r\n    }\r\n    set style(style) {\r\n        style = style || {};\r\n        if (style instanceof TextStyle) {\r\n            this._style = style;\r\n        }\r\n        else {\r\n            this._style = new TextStyle(style);\r\n        }\r\n        this.localStyleID = -1;\r\n        this.dirty = true;\r\n    }\r\n    /**\r\n     * Set the copy for the text object. To split a line you can use '\\n'.\r\n     *\r\n     * @member {string}\r\n     */\r\n    get text() {\r\n        return this._text;\r\n    }\r\n    set text(text) {\r\n        text = String(text === null || text === undefined ? '' : text);\r\n        if (this._text === text) {\r\n            return;\r\n        }\r\n        this._text = text;\r\n        this.dirty = true;\r\n    }\r\n    /**\r\n     * The resolution / device pixel ratio of the canvas.\r\n     * This is set to automatically match the renderer resolution by default, but can be overridden by setting manually.\r\n     * @member {number}\r\n     * @default 1\r\n     */\r\n    get resolution() {\r\n        return this._resolution;\r\n    }\r\n    set resolution(value) {\r\n        this._autoResolution = false;\r\n        if (this._resolution === value) {\r\n            return;\r\n        }\r\n        this._resolution = value;\r\n        this.dirty = true;\r\n    }\r\n}\r\n","import { Sprite, Texture, Text, Container } from 'pixi.js'\r\nimport RenderComponent from './base/render'\r\nimport { componentRegister } from '../core'\r\nimport RainbowText from '../lib/rainbow-text'\r\n\r\ntype AxisPosition = {\r\n  x: 'left' | 'center' | 'right'\r\n  y: 'top' | 'center' | 'bottom'\r\n}\r\n\r\ntype TextStyle = {\r\n  fontFamily?: string | string[],\r\n  fontWeight?: string,\r\n  fontSize?: number,\r\n  fill?: string,\r\n  lineJoin?: 'round',\r\n  stroke?: string,\r\n  strokeThickness?: number,\r\n  wordWrap?: boolean,\r\n  wordWrapWidth?: number\r\n}\r\n\r\nexport class TextComponent extends RenderComponent {\r\n  // serialize fields\r\n  public text: string\r\n  public style: TextStyle\r\n  public position: AxisPosition\r\n  public bgTextureId: string\r\n  public padding: number\r\n  // temp fields\r\n  public bgTexture: Texture\r\n  public textView: Text\r\n  public btnView: Sprite\r\n\r\n  constructor() {\r\n    super()\r\n    this.text = ''\r\n    this.style = {}\r\n    this.position = {\r\n      x: 'left',\r\n      y: 'top'\r\n    }\r\n    this.bgTextureId = null\r\n    this.padding = 0\r\n\r\n    this.bgTexture = null\r\n    this.textView = null\r\n    this.btnView = null\r\n  }\r\n\r\n  public init() {\r\n    this.view = new Container()\r\n    if (this.bgTextureId) {\r\n      this.bgTexture = Texture.from(this.bgTextureId)\r\n    } else {\r\n      this.bgTexture = Texture.EMPTY\r\n    }\r\n    this.btnView = new Sprite(this.bgTexture)\r\n    if (this.bgTextureId) {\r\n      this.style = {\r\n        wordWrap: true,\r\n        wordWrapWidth: this.btnView.width - this.padding * 2,\r\n        ...this.style\r\n      }\r\n    }\r\n    this.textView = new RainbowText(this.text, this.style)\r\n    this.textView.resolution = 2\r\n    this.justifyContent()\r\n    this.view.addChild(this.btnView, this.textView)\r\n  }\r\n\r\n  public justifyContent() {\r\n    const { position } = this\r\n    const { width: btnW, height: btnH } = this.btnView\r\n    const { width: textW, height: textH } = this.textView\r\n\r\n    if (position.x === 'left') {\r\n      this.textView.x = this.padding\r\n    } else if (position.x === 'center') {\r\n      this.textView.x = Math.abs(btnW - textW) / 2\r\n    } else if (position.x === 'right') {\r\n      this.textView.x = Math.abs(btnW - textW) - this.padding\r\n    }\r\n    if (position.y === 'top') {\r\n      this.textView.y = this.padding\r\n    } else if (position.y === 'center') {\r\n      this.textView.y = Math.abs(btnH - textH) / 2\r\n    } else if (position.y === 'bottom') {\r\n      this.textView.y = Math.abs(btnH - textH) - this.padding\r\n    }\r\n  }\r\n\r\n  public clear() {\r\n    this.revert()\r\n    this.text = ''\r\n    this.style = {}\r\n    this.position = {\r\n      x: 'left',\r\n      y: 'top'\r\n    }\r\n    this.bgTextureId = null\r\n    this.padding = 0\r\n\r\n    this.textView?.destroy()\r\n    this.textView = null\r\n    this.btnView?.destroy()\r\n    this.btnView = null\r\n    this.bgTexture = null\r\n  }\r\n\r\n  public toJSON() {\r\n    const { text, style, position, bgTextureId, padding } = this\r\n    const render = this.getRenderJSON()\r\n\r\n    return { text, style, position, bgTextureId, padding,\r\n      ...render\r\n    }\r\n  }\r\n}\r\n\r\ncomponentRegister('TextComponent')(TextComponent)\r\n","import { IComponent, componentRegister } from '../core'\r\n\r\nexport class TypewriterComponent extends IComponent {\r\n  /**  */\r\n  public text: string\r\n  /**\r\n   * /\r\n   */\r\n  public speed: number\r\n  /**\r\n   * \r\n   */\r\n  public printDelay: number\r\n\r\n  public deltaTimer: number\r\n\r\n  constructor() {\r\n    super()\r\n    this.text = ''\r\n    this.speed = 10\r\n    this.printDelay = 0\r\n    this.deltaTimer = 0\r\n  }\r\n\r\n  clear() {\r\n    this.text = ''\r\n    this.speed = 10\r\n    this.printDelay = 0\r\n    this.deltaTimer = 0\r\n  }\r\n\r\n  toJSON() {\r\n    const { text, speed, printDelay } = this\r\n    return { text, speed, printDelay }\r\n  }\r\n}\r\n\r\ncomponentRegister('TypewriterComponent')(TypewriterComponent)\r\n","import { Texture, Container } from 'pixi.js'\r\nimport { IComponent, componentRegister } from '../core'\r\n\r\nexport class ButtonComponent extends IComponent {\r\n  // serialize fields\r\n  /** button  */\r\n  public tag: string\r\n  /** button down id */\r\n  public textureId: string\r\n  /**  */\r\n  public style: any\r\n  /**  */\r\n  public useAnimation: boolean\r\n  // temp fields\r\n  /**  */\r\n  public texture: Texture\r\n  /**  */\r\n  public isBind: boolean\r\n  /**  */\r\n  public isClick: boolean\r\n  /**  */\r\n  public origin: Container\r\n\r\n  /**  */\r\n  public clickEvent: boolean\r\n  /**  */\r\n  public deltaTimer: number\r\n\r\n  constructor() {\r\n    super()\r\n    this.tag = null\r\n    this.textureId = null\r\n    this.style = {}\r\n    this.useAnimation = true\r\n\r\n    this.texture = null\r\n    this.isBind = false\r\n    this.isClick = false\r\n    this.origin = null\r\n\r\n    this.clickEvent = false\r\n    this.deltaTimer = 0\r\n  }\r\n\r\n  public init() {\r\n    if (this.textureId) {\r\n      this.texture = Texture.from(this.textureId)\r\n    }\r\n  }\r\n\r\n  public clear() {\r\n    this.tag = null\r\n    this.textureId = null\r\n    this.style = {}\r\n    this.useAnimation = true\r\n\r\n    this.texture = null\r\n    this.isBind = false\r\n    this.isClick = false\r\n    if (this.origin) {\r\n      this.origin.interactive = false\r\n      this.origin.buttonMode = false\r\n      this.origin.removeAllListeners()\r\n    }\r\n    this.origin = null\r\n\r\n    this.clickEvent = false\r\n    this.deltaTimer = 0\r\n  }\r\n\r\n  public toJSON() {\r\n    const { tag, textureId, style, useAnimation } = this\r\n    return { tag, textureId, style, useAnimation }\r\n  }\r\n}\r\n\r\ncomponentRegister('ButtonComponent')(ButtonComponent)\r\n","import { IComponent, componentRegister } from '../core'\r\n\r\nexport class TransformComponent extends IComponent {\r\n  public x: number\r\n  public y: number\r\n  public angle: number\r\n  public scale: number\r\n\r\n  constructor() {\r\n    super()\r\n    this.x = 0\r\n    this.y = 0\r\n    this.angle = 0\r\n    this.scale = 1\r\n  }\r\n\r\n  clear() {\r\n    this.x = 0\r\n    this.y = 0\r\n    this.angle = 0\r\n    this.scale = 1\r\n  }\r\n\r\n  toJSON() {\r\n    const { x, y, angle, scale } = this\r\n    return { x, y, angle, scale }\r\n  }\r\n}\r\n\r\ncomponentRegister('TransformComponent')(TransformComponent)\r\n","import { IComponent, componentRegister } from '../core'\r\n\r\nexport class TransparentComponent extends IComponent {\r\n  public alpha : number\r\n\r\n  constructor() {\r\n    super()\r\n    this.alpha = 0\r\n  }\r\n\r\n  clear() {\r\n    this.alpha = 0\r\n  }\r\n\r\n  toJSON() {\r\n    const { alpha } = this\r\n    return { alpha }\r\n  }\r\n}\r\n\r\ncomponentRegister('TransparentComponent')(TransparentComponent)\r\n","import { IComponent, componentRegister } from '../core'\r\nimport { Sound } from '../sound'\r\n\r\ntype PlayOptions = {\r\n  start?: number\r\n  end?: number\r\n  speed?: number\r\n  loop?: boolean\r\n  sprite?: string\r\n  muted?: boolean\r\n}\r\n\r\nexport class SoundComponent extends IComponent {\r\n  public alias: string\r\n  public options: PlayOptions\r\n\r\n  public firstPlay: boolean\r\n  public isPlaying: boolean\r\n  public sound: Sound\r\n\r\n  constructor() {\r\n    super()\r\n    this.alias = null\r\n    this.options = {}\r\n\r\n    this.firstPlay = true\r\n    this.isPlaying = false\r\n    this.sound = null\r\n  }\r\n\r\n  init() {\r\n    this.sound = new Sound(this.alias)\r\n  }\r\n\r\n  clear() {\r\n    this.alias = null\r\n    this.options = {}\r\n\r\n    this.firstPlay = true\r\n    this.isPlaying = false\r\n    this.sound.stop()\r\n    this.sound = null\r\n  }\r\n\r\n  toJSON() {\r\n    const { alias, options } = this\r\n    return { alias, options }\r\n  }\r\n}\r\n\r\ncomponentRegister('SoundComponent')(SoundComponent)\r\n","import { IComponent, componentRegister } from '../core'\r\n\r\ntype Vars = {\r\n  x?: number\r\n  y?: number\r\n  angle?: number\r\n  scale?: number\r\n}\r\n\r\n/**\r\n * \r\n */\r\nexport class DisplacementComponent extends IComponent {\r\n  public start: Vars\r\n  public end: Vars\r\n  public duration: number\r\n\r\n  constructor() {\r\n    super()\r\n    this.start = {}\r\n    this.end = {}\r\n    this.duration = 0\r\n  }\r\n\r\n  public clear() {\r\n    this.start = {}\r\n    this.end = {}\r\n    this.duration = 0\r\n  }\r\n\r\n  public toJSON() {\r\n    const { start, end, duration } = this\r\n    return { start, end, duration }\r\n  }\r\n}\r\n\r\ncomponentRegister('DisplacementComponent')(DisplacementComponent)\r\n","import { IComponent, componentRegister } from '../core'\r\n\r\ntype Vars = {\r\n  alpha?: number\r\n}\r\n\r\n/**\r\n * \r\n */\r\nexport class FadeComponent extends IComponent {\r\n  public start: Vars\r\n  public end: Vars\r\n  public duration: number\r\n\r\n  constructor() {\r\n    super()\r\n    this.start = {}\r\n    this.end = {}\r\n    this.duration = 0\r\n  }\r\n\r\n  public clear() {\r\n    this.start = {}\r\n    this.end = {}\r\n    this.duration = 0\r\n  }\r\n\r\n  public toJSON() {\r\n    const { start, end, duration } = this\r\n    return { start, end, duration }\r\n  }\r\n}\r\n\r\ncomponentRegister('FadeComponent')(FadeComponent)\r\n","import { IComponentClass, ISystem } from '../core'\r\nimport { Entity } from '../core/entity'\r\nimport {\r\n  SpriteComponent,\r\n  AnimationComponent,\r\n  TextComponent,\r\n  TransformComponent,\r\n  TransparentComponent\r\n} from '../components'\r\nimport RenderComponent from '../components/base/render'\r\nimport { Scene } from '../render'\r\n\r\nexport class PIXIRenderSystem extends ISystem {\r\n  public execute() {\r\n    const entities = this.queries.entities.results\r\n\r\n    for (const entity of entities) {\r\n      this.match(entity, SpriteComponent)\r\n      this.match(entity, AnimationComponent)\r\n      this.match(entity, TextComponent)\r\n    }\r\n  }\r\n\r\n  private match<T extends RenderComponent>(\r\n    entity: Entity,\r\n    componentClass: IComponentClass<T>\r\n  ) {\r\n    if (entity.hasComponent(componentClass)) {\r\n      const sprite = entity.getComponent(componentClass)\r\n      this.configureSprite(sprite)\r\n      this.transform(entity, sprite)\r\n      this.transparent(entity, sprite)\r\n    }\r\n  }\r\n\r\n  private configureSprite(sprite: RenderComponent) {\r\n    sprite.view.visible = sprite.visible\r\n    const anchor = {\r\n      x: sprite.anchor.x * sprite.view.width,\r\n      y: sprite.anchor.y * sprite.view.height\r\n    }\r\n    sprite.view.pivot.set(anchor.x, anchor.y)\r\n    if (!sprite.isRender) {\r\n      const scene = this.world as Scene\r\n      sprite.isRender = true\r\n      scene.addSprite(sprite.layer, sprite.view)\r\n    }\r\n  }\r\n\r\n  private transform(entity: Entity, sprite: RenderComponent) {\r\n    if (entity.hasComponent(TransformComponent)) {\r\n      const transform = entity.getComponent(TransformComponent)\r\n      sprite.view.x = transform.x\r\n      sprite.view.y = transform.y\r\n      sprite.view.angle = transform.angle\r\n      sprite.view.scale.set(transform.scale)\r\n    }\r\n  }\r\n\r\n  private transparent(entity: Entity, sprite: RenderComponent) {\r\n    if (entity.hasComponent(TransparentComponent)) {\r\n      const transparent = entity.getComponent(TransparentComponent)\r\n      sprite.view.alpha = transparent.alpha\r\n    }\r\n  }\r\n}\r\n\r\nPIXIRenderSystem.queries = {\r\n  entities: {\r\n    type: 'any',\r\n    components: [SpriteComponent, AnimationComponent, TextComponent]\r\n  }\r\n}\r\n","import { ISystem } from '../core'\r\nimport { TextComponent } from '../components'\r\n\r\nexport class TextUpdateSystem extends ISystem {\r\n  public execute() {\r\n    const entities = this.queries.entities.results\r\n\r\n    for (const entity of entities) {\r\n      const Text = entity.getComponent(TextComponent)\r\n      if (Text.textView.text !== Text.text) {\r\n        Text.textView.text = Text.text\r\n        Text.justifyContent()\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nTextUpdateSystem.queries = {\r\n  entities: [TextComponent]\r\n}\r\n","import { ISystem } from '../core'\r\nimport { AnimationComponent } from '../components'\r\n\r\nexport class AnimationSystem extends ISystem {\r\n  public execute() {\r\n    const entities = this.queries.entities.results\r\n\r\n    for (const entity of entities) {\r\n      const animation = entity.getComponent(AnimationComponent)\r\n      const view = animation.view as PIXI.AnimatedSprite\r\n\r\n      if (view.loop !== animation.loop) {\r\n        view.loop = animation.loop\r\n      }\r\n\r\n      if (view.animationSpeed !== animation.animationSpeed) {\r\n        view.animationSpeed = animation.animationSpeed\r\n      }\r\n\r\n      if (animation.playing === true) {\r\n        if (view.playing === false) {\r\n          view.play()\r\n        }\r\n      } else {\r\n        if (view.playing === true) {\r\n          view.gotoAndStop(0)\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nAnimationSystem.queries = {\r\n  entities: [AnimationComponent]\r\n}\r\n","import { ISystem } from '../core'\r\nimport { TextComponent, TypewriterComponent } from '../components'\r\n\r\nexport class TypewriterSystem extends ISystem {\r\n  public execute(delta: number) {\r\n    const entities = this.queries.entities.results\r\n\r\n    for (const entity of entities) {\r\n      const Text = entity.getComponent(TextComponent)\r\n      const typewriter = entity.getComponent(TypewriterComponent)\r\n      if (typewriter.text.length > Text.text.length) {\r\n        if (typewriter.speed <= 0) {\r\n          typewriter.speed = 10\r\n        }\r\n        typewriter.deltaTimer += delta\r\n        let time = 1000 / typewriter.speed\r\n        if (Text.text.length === 0 && typewriter.printDelay >= 0) {\r\n          // \r\n          time = typewriter.printDelay\r\n        }\r\n        if (typewriter.deltaTimer >= time) {\r\n          let char\r\n          do {\r\n            char = typewriter.text.charAt(Text.text.length)\r\n            //  bbcode \r\n            const result = processBbcode(typewriter.text, char, Text.text.length, 7)\r\n            if (result.type === 'tag') {\r\n              Text.text +=  result.bbcode\r\n              char = typewriter.text.charAt(Text.text.length)\r\n            }\r\n            Text.text += char\r\n            // \r\n          } while (char === ' ')\r\n          // Text.text += typewriter.text.charAt(Text.text.length)\r\n          typewriter.deltaTimer = 0\r\n        }\r\n      } else {\r\n        entity.removeComponent(TypewriterComponent)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nTypewriterSystem.queries = {\r\n  entities: [TextComponent, TypewriterComponent]\r\n}\r\n\r\nfunction processBbcode(string: string, char: string, i: number, magic: number) {\r\n  let type = 'none'\r\n  let bbcode = ''\r\n  if (char === '[') {\r\n    let index = i\r\n    index += magic // magic should be 7\r\n    bbcode = string.slice(i, index + 1)\r\n    if (bbcode === '[style={') {\r\n      let tmp\r\n      do {\r\n        index++\r\n        tmp = string.charAt(index)\r\n        bbcode += tmp\r\n      } while (tmp !== ']')\r\n      type = 'tag'\r\n    } else if (bbcode === '[/style]') {\r\n      type = 'tag'\r\n    }\r\n  }\r\n\r\n  return {\r\n    type,\r\n    bbcode\r\n  }\r\n}\r\n","import { ISystem } from '../core'\r\nimport { Entity } from '../core/entity'\r\nimport { TextComponent, ButtonComponent, TransformComponent } from '../components'\r\n\r\nexport class TextButtonSystem extends ISystem {\r\n  public execute(delta: number) {\r\n    const entities = this.queries.entities.results\r\n\r\n    for (const entity of entities) {\r\n      const text = entity.getComponent(TextComponent)\r\n      const button = entity.getComponent(ButtonComponent)\r\n\r\n      if (button.isBind === false) {\r\n        button.isBind = true\r\n        text.view.interactive = true\r\n        text.view.buttonMode = true\r\n        text.view\r\n          .on('pointerdown', this.processButtonDown(entity))\r\n          .on('pointerup', this.processButtonUp(entity))\r\n          .on('pointerupoutside', this.processButtonUp(entity))\r\n          .on('pointertap', () => {\r\n            button.clickEvent = true\r\n            button.deltaTimer = 0\r\n          })\r\n        button.origin = text.view\r\n      }\r\n\r\n      button.isClick = false\r\n      if (button.clickEvent === true) {\r\n        if (button.deltaTimer >= 10) {\r\n          button.isClick = true\r\n          button.clickEvent = false\r\n          button.deltaTimer = 0\r\n        } else {\r\n          button.deltaTimer += delta\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  private processButtonUp(entity: Entity) {\r\n    const text = entity.getComponent(TextComponent)\r\n    const button = entity.getComponent(ButtonComponent)\r\n    const view = text.view\r\n\r\n    return () => {\r\n      if (button.useAnimation === true) {\r\n        if (entity.hasComponent(TransformComponent)) {\r\n          entity.getComponent(TransformComponent).scale = 1\r\n        } else {\r\n          view.scale.set(1)\r\n        }\r\n        text.anchor = { x: 0, y: 0 }\r\n      }\r\n\r\n      this.onButtonUp(text)\r\n    }\r\n  }\r\n\r\n  private processButtonDown(entity: Entity) {\r\n    const text = entity.getComponent(TextComponent)\r\n    const button = entity.getComponent(ButtonComponent)\r\n    const view = text.view\r\n\r\n    return () => {\r\n      if (button.useAnimation === true) {\r\n        if (entity.hasComponent(TransformComponent)) {\r\n          entity.getComponent(TransformComponent).scale = 0.95\r\n        } else {\r\n          view.scale.set(0.95)\r\n        }\r\n        // 0.025 = (1 - 0.95) / 2\r\n        text.anchor = { x: -0.025, y: -0.025 }\r\n      }\r\n\r\n      this.onButtonDown(text, button)\r\n    }\r\n  }\r\n\r\n  private onButtonUp(textC: TextComponent) {\r\n    textC.btnView.texture = textC.bgTexture\r\n    Object.assign(textC.textView.style, textC.style)\r\n  }\r\n\r\n  private onButtonDown(textC: TextComponent, btnC: ButtonComponent) {\r\n    if (btnC.texture) {\r\n      textC.btnView.texture = btnC.texture\r\n    }\r\n    Object.assign(textC.textView.style, btnC.style)\r\n  }\r\n}\r\n\r\nTextButtonSystem.queries = {\r\n  entities: [TextComponent, ButtonComponent]\r\n}\r\n","import { IComponent, ISystem } from '../core'\r\nimport {\r\n  TransformComponent,\r\n  TransparentComponent,\r\n  DisplacementComponent,\r\n  FadeComponent\r\n} from '../components'\r\n\r\nexport class TransformSystem extends ISystem {\r\n  public execute(delta: number) {\r\n    const disp = this.queries.disp.results\r\n\r\n    for (const entity of disp) {\r\n      const Transform = entity.getComponent(TransformComponent)\r\n      const Displacement = entity.getComponent(DisplacementComponent)\r\n      const result = this.transform(Transform, Displacement, delta)\r\n      if (result === true) {\r\n        entity.removeComponent(DisplacementComponent)\r\n      }\r\n    }\r\n\r\n    const fade = this.queries.fade.results\r\n\r\n    for (const entity of fade) {\r\n      const Transparent = entity.getComponent(TransparentComponent)\r\n      const Fade = entity.getComponent(FadeComponent)\r\n      const result = this.transform(Transparent, Fade, delta)\r\n      if (result === true) {\r\n        entity.removeComponent(FadeComponent)\r\n      }\r\n    }\r\n  }\r\n\r\n  public transform(\r\n    target: IComponent,\r\n    method: IComponent,\r\n    delta: number\r\n  ): boolean {\r\n    const component = target as any\r\n    const { start, end, duration } = method as any\r\n\r\n    for (const key in end) {\r\n      const offset = end[key] - start[key]\r\n      if (component[key] !== end[key]) {\r\n        component[key] += (offset / duration * delta)\r\n        if (offset >= 0) {\r\n          if (component[key] >= end[key]) {\r\n            component[key] = end[key]\r\n            return true\r\n          }\r\n        } else {\r\n          if (component[key] <= end[key]) {\r\n            component[key] = end[key]\r\n            return true\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return false\r\n  }\r\n}\r\n\r\nTransformSystem.queries = {\r\n  disp: [TransformComponent, DisplacementComponent],\r\n  fade: [TransparentComponent, FadeComponent]\r\n}\r\n","import { ISystem } from '../core'\r\nimport { SoundComponent } from '../components'\r\n\r\nexport class SoundSystem extends ISystem {\r\n  public execute() {\r\n    const entities = this.queries.entities.results\r\n\r\n    for (const entity of entities) {\r\n      const Sound = entity.getComponent(SoundComponent)\r\n\r\n      if (Sound.firstPlay === true) {\r\n        // \r\n        Sound.sound.play(Sound.options)\r\n        Sound.firstPlay = false\r\n        Sound.isPlaying = true\r\n      } else {\r\n        if (Sound.isPlaying === true) {\r\n          if (Sound.sound.isPlaying === false) {\r\n            // \r\n            entity.removeComponent(SoundComponent)\r\n          }\r\n        } else {\r\n          // \r\n          Sound.sound.stop()\r\n          entity.removeComponent(SoundComponent)\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nSoundSystem.queries = {\r\n  entities: [SoundComponent]\r\n}\r\n","import { IComponent, componentRegister } from '../../../engine/core'\r\n\r\nconst BtnTypes = {\r\n  letf: 0,\r\n  center: 1,\r\n  right: 2\r\n}\r\n\r\nexport class InputComponent extends IComponent {\r\n  constructor() {\r\n    super()\r\n    this.curEvent = {\r\n      isDown: false,\r\n      buttons: 0,\r\n      x: -1,\r\n      y: -1\r\n    }\r\n    this.preEvent = {\r\n      isDown: false,\r\n      buttons: 0,\r\n      x: -1,\r\n      y: -1\r\n    }\r\n\r\n    /**  */\r\n    this.downPoint = { x: 0, y: 0 }\r\n    /**  */\r\n    this.isClick = false\r\n    /** isClick */\r\n    this.readyClick = false\r\n    /**  */\r\n    this.deltaTimer = 0\r\n  }\r\n\r\n  clear() {\r\n    this.curEvent = {\r\n      isDown: false,\r\n      buttons: 0,\r\n      x: -1,\r\n      y: -1\r\n    }\r\n    this.preEvent = {\r\n      isDown: false,\r\n      buttons: 0,\r\n      x: -1,\r\n      y: -1\r\n    }\r\n\r\n    this.downPoint = { x: 0, y: 0 }\r\n    this.isClick = false\r\n    this.readyClick = false\r\n    this.deltaTimer = 0\r\n  }\r\n\r\n  isMouseUp(btnType) {\r\n    const { isDown, buttons: button } = this.curEvent\r\n\r\n    if (isDown) {\r\n      return false\r\n    }\r\n    if (btnType === BtnTypes.letf) {\r\n      return button === 0\r\n    } else if (btnType === BtnTypes.center) {\r\n      return button === 1\r\n    } else if (btnType === BtnTypes.right) {\r\n      return button === 2\r\n    } else {\r\n      return false\r\n    }\r\n  }\r\n\r\n  isMouseDown(btnType) {\r\n    const { isDown, buttons: button } = this.curEvent\r\n\r\n    if (!isDown) {\r\n      return false\r\n    }\r\n    if (btnType === BtnTypes.letf) {\r\n      return button === 0\r\n    } else if (btnType === BtnTypes.center) {\r\n      return button === 1\r\n    } else if (btnType === BtnTypes.right) {\r\n      return button === 2\r\n    } else {\r\n      return false\r\n    }\r\n  }\r\n}\r\n\r\ncomponentRegister('InputComponent')(InputComponent)\r\n","import { IComponent, componentRegister } from '../../../engine/core'\r\n\r\nexport class StoryComponent extends IComponent {\r\n  constructor() {\r\n    super()\r\n    this.entities = {}\r\n    this.curChapter = null\r\n    this.initialed = false\r\n    this.nodeIndex = 0\r\n    this.subIndex = 0\r\n  }\r\n\r\n  clear() {\r\n    this.entities = {}\r\n    this.curChapter = null\r\n    this.initialed = false\r\n    this.nodeIndex = 0\r\n    this.subIndex = 0\r\n  }\r\n\r\n  toJSON() {\r\n    const { entities, curChapter, initialed, nodeIndex, subIndex } = this\r\n    return { entities, curChapter, initialed, nodeIndex, subIndex }\r\n  }\r\n}\r\n\r\ncomponentRegister('StoryComponent')(StoryComponent)\r\n","import { ISystem } from '../../engine/core'\r\nimport { InputComponent } from '../components/singleton'\r\n\r\nexport class InputSystem extends ISystem {\r\n  execute(delta) {\r\n    const singleton = this.world.singleton\r\n    const input = singleton.getComponent(InputComponent)\r\n\r\n    if (this.world.interaction) {\r\n      const interaction = this.world.interaction.mouse\r\n      input.preEvent = {\r\n        ...input.curEvent\r\n      }\r\n\r\n      // \r\n      input.curEvent.x = interaction.global.x\r\n      input.curEvent.y = interaction.global.y\r\n\r\n      // \r\n      input.curEvent.buttons = interaction.buttons\r\n\r\n      // \r\n      if (interaction.isDown) {\r\n        if (input.curEvent.isDown === false) {\r\n          input.downPoint.x = input.curEvent.x\r\n          input.downPoint.y = input.curEvent.y\r\n        }\r\n        input.curEvent.isDown = true\r\n      } else {\r\n        input.curEvent.isDown = false\r\n      }\r\n\r\n      if (\r\n        input.preEvent.isDown === true &&\r\n        input.preEvent.buttons === 1 &&\r\n        input.curEvent.isDown === false &&\r\n        Math.abs(input.downPoint.x - input.curEvent.x) <= 50 &&\r\n        Math.abs(input.downPoint.y - input.curEvent.y) <= 50\r\n      ) {\r\n        input.readyClick = true\r\n        input.deltaTimer = 0\r\n      }\r\n\r\n      input.isClick = false\r\n      if (input.readyClick === true) {\r\n        if (input.deltaTimer >= 10) {\r\n          input.isClick = true\r\n          input.readyClick = false\r\n          input.deltaTimer = 0\r\n        } else {\r\n          input.deltaTimer += delta\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { ISystem } from '../../engine/core'\r\nimport { InputComponent } from '../components/singleton'\r\n\r\nexport class StorySystem extends ISystem {\r\n  execute(delta) {\r\n    const singleton = this.world.singleton\r\n\r\n    if (this.world.systemData && this.world.storyScript) {\r\n      const Input = singleton.getComponent(InputComponent)\r\n      let result = true\r\n      while (result) {\r\n        result = this.processStory(delta)\r\n        //  input \r\n        Input.isClick = false\r\n      }\r\n    }\r\n  }\r\n\r\n  processStory(delta) {\r\n    if (typeof this.world.storyScript === 'undefined') {\r\n      return false\r\n    }\r\n\r\n    const system = this.world.systemData\r\n    const chapter = this.world.storyScript[system.chapter]\r\n\r\n    if (typeof chapter === 'undefined') {\r\n      return false\r\n    }\r\n\r\n    const nodeCount = chapter.length\r\n    const node = chapter[system.nodeIndex]\r\n\r\n    if (typeof node === 'undefined') {\r\n      return false\r\n    }\r\n\r\n    if (system.initialed === false && node.init) {\r\n      node.init(this.world)\r\n      system.initialed = true\r\n    }\r\n\r\n    const result = node.process(this.world, delta)\r\n\r\n    if (result === true) {\r\n      if (node.goto) {\r\n        //  goto \r\n        const goto = node.goto(this.world)\r\n\r\n        if (\r\n          goto && (\r\n          typeof goto.chapter !== 'undefined' ||\r\n          typeof goto.node !== 'undefined')\r\n        ) {\r\n          system.initialed = false\r\n          system.subIndex = 0\r\n\r\n          if (\r\n            typeof goto.chapter !== 'undefined' &&\r\n            goto.chapter !== system.chapter\r\n          ) {\r\n            // \r\n            this.world.removeAllEntity()\r\n            system.entities = {}\r\n\r\n            system.nodeIndex = 0\r\n            system.chapter = goto.chapter\r\n          }\r\n          if (typeof goto.node !== 'undefined') {\r\n            system.nodeIndex = goto.node\r\n          }\r\n        } else if (system.nodeIndex < nodeCount) {\r\n          system.nodeIndex++\r\n          system.subIndex = 0\r\n          system.initialed = false\r\n        }\r\n\r\n      } else if (system.nodeIndex < nodeCount) {\r\n        system.nodeIndex++\r\n        system.subIndex = 0\r\n        system.initialed = false\r\n      }\r\n    }\r\n\r\n    return result\r\n  }\r\n}\r\n","import { IComponent, componentRegister } from '../../../engine/core'\r\n\r\n/**  */\r\nexport class BackgroundComponent extends IComponent { }\r\ncomponentRegister('BackgroundComponent')(BackgroundComponent)\r\n\r\n/** CG  */\r\nexport class CGComponent extends IComponent { }\r\ncomponentRegister('CGComponent')(CGComponent)\r\n\r\n/** BGM  */\r\nexport class BGMComponent extends IComponent { }\r\ncomponentRegister('BGMComponent')(BGMComponent)\r\n\r\n/**  */\r\nexport class CharacterComponent extends IComponent { }\r\ncomponentRegister('CharacterComponent')(CharacterComponent)\r\n\r\n/**  */\r\nexport class DialogComponent extends IComponent { }\r\ncomponentRegister('DialogComponent')(DialogComponent)\r\n\r\n/**  */\r\nexport class NameComponent extends IComponent { }\r\ncomponentRegister('NameComponent')(NameComponent)\r\n\r\n/**  */\r\nexport class ChoiceComponent extends IComponent { }\r\ncomponentRegister('ChoiceComponent')(ChoiceComponent)\r\n\r\n/**  */\r\nexport class RemoveComponent extends IComponent { }\r\ncomponentRegister('RemoveComponent')(RemoveComponent)\r\n","import { ISystem } from '../../engine/core'\r\nimport { DisplacementComponent, FadeComponent, SoundComponent } from '../../engine/components'\r\nimport { BGMComponent, RemoveComponent } from '../components/tag'\r\n\r\nexport class RemoveSystem extends ISystem {\r\n  execute() {\r\n    const removed = this.queries.removed.results\r\n\r\n    for (const entity of removed) {\r\n      if (entity.hasAnyComponent([DisplacementComponent, FadeComponent])) {\r\n        continue\r\n      }\r\n      this.world.removeEntity(entity)\r\n    }\r\n\r\n    const bgm = this.queries.bgm.results\r\n\r\n    for (const entity of bgm) {\r\n      if (!entity.hasComponent(SoundComponent)) {\r\n        this.world.removeEntity(entity)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nRemoveSystem.queries = {\r\n  removed: [RemoveComponent],\r\n  bgm: [BGMComponent]\r\n}\r\n","export class GroupMap {\r\n  constructor(group) {\r\n    this.group = group\r\n  }\r\n\r\n  getGroup(world) {\r\n    if (typeof world.systemData.entities[this.group] === 'undefined') {\r\n      world.systemData.entities[this.group] = {}\r\n    }\r\n  \r\n    return world.systemData.entities[this.group]\r\n  }\r\n\r\n  set(world, id, value) {\r\n    this.getGroup(world)[id] = value\r\n  }\r\n\r\n  get(world, id) {\r\n    return this.getGroup(world)[id]\r\n  }\r\n\r\n  delete(world, id) {\r\n    this.set(world, id, undefined)\r\n  }\r\n}\r\n\r\nexport function colorText(texts, color) {\r\n  if (Array.isArray(texts)) {\r\n    return texts.map(text => (`[style={\"fill\": \"${color}\"}]${text}[/style]`))\r\n  } else {\r\n    return `[style={\"fill\": \"${color}\"}]${texts}[/style]`\r\n  }\r\n}\r\n","import { GroupMap } from '../util'\r\n\r\nexport const group = new GroupMap('stage')\r\n","import {\r\n  SpriteComponent,\r\n  TransparentComponent,\r\n  FadeComponent\r\n} from '../../../../engine/components'\r\nimport { group } from './util'\r\n\r\nfunction createCurtain(world, duration, alpha) {\r\n  const entity = world.createEntity()\r\n    .addComponent(SpriteComponent, {\r\n      layer: 'UserLayer10',\r\n      textureId: 'curtain'\r\n    })\r\n  \r\n  if (duration > 0) {\r\n    entity\r\n      .addComponent(TransparentComponent, {\r\n        alpha: 1 - alpha\r\n      })\r\n      .addComponent(FadeComponent, {\r\n        targetId: 'TransparentComponent',\r\n        start: {\r\n          alpha: 1 - alpha\r\n        },\r\n        end: {\r\n          alpha\r\n        },\r\n        duration\r\n      })\r\n  } else {\r\n    entity\r\n      .addComponent(TransparentComponent, {\r\n        alpha\r\n      })\r\n  }\r\n\r\n  return entity\r\n}\r\n\r\nexport function up(duration = 0) {\r\n  function init(world) {\r\n    const entityId = group.get(world, 'curtain')\r\n    if (!entityId) {\r\n      const entity = createCurtain(world, duration, 0)\r\n      group.set(world, 'curtain', entity.id)\r\n      return\r\n    }\r\n\r\n    const entity = world.getEntity(entityId)\r\n    if (entity.hasComponent(FadeComponent)) {\r\n      entity.removeComponent(FadeComponent)\r\n    }\r\n    const Transparent = entity.getComponent(TransparentComponent)\r\n\r\n    if (duration > 0) {\r\n      Transparent.alpha = 1\r\n      entity.addComponent(FadeComponent, {\r\n        targetId: 'TransparentComponent',\r\n        start: {\r\n          alpha: 1\r\n        },\r\n        end: {\r\n          alpha: 0\r\n        },\r\n        duration\r\n      })\r\n    } else {\r\n      Transparent.alpha = 0\r\n    }\r\n  }\r\n\r\n  function process(world) {\r\n    const entityId = group.get(world, 'curtain')\r\n\r\n    if (!entityId) {\r\n      return true\r\n    }\r\n\r\n    const entity = world.getEntity(entityId)\r\n    if (entity.hasComponent(FadeComponent)) {\r\n      return false\r\n    } else {\r\n      group.delete(world, 'curtain')\r\n      world.removeEntity(entity)\r\n      return true\r\n    }\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process\r\n  }\r\n}\r\n\r\nexport function down(duration = 0) {\r\n  function init(world) {\r\n    const entityId = group.get(world, 'curtain')\r\n    if (entityId) {\r\n      return\r\n    }\r\n\r\n    const entity = createCurtain(world, duration, 1)\r\n    group.set(world, 'curtain', entity.id)\r\n  }\r\n\r\n  function process(world) {\r\n    const entityId = group.get(world, 'curtain')\r\n\r\n    if (!entityId) {\r\n      return true\r\n    }\r\n\r\n    const entity = world.getEntity(entityId)\r\n    if (entity.hasComponent(FadeComponent)) {\r\n      return false\r\n    } else {\r\n      return true\r\n    }\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process\r\n  }\r\n}\r\n","import {\r\n  TextComponent,\r\n  TypewriterComponent\r\n} from '../../../../engine/components'\r\nimport { InputComponent } from '../../../components/singleton'\r\nimport { voiceoverStyle } from '../../../config'\r\nimport { group } from './util'\r\n\r\nconst typewriterOptions = {\r\n  speed: 22\r\n}\r\n\r\nfunction createVoiceover(world, text) {\r\n  const entityId = group.get(world, 'voiceover')\r\n  if (entityId) {\r\n    changeVoiceover(world.getEntity(entityId), text)\r\n    return\r\n  }\r\n\r\n  const entity = world.createEntity('voiceover')\r\n    .addComponent(TextComponent, {\r\n      layer: 'UserLayer9',\r\n      style: voiceoverStyle,\r\n      bgTextureId: 'voiceover',\r\n      padding: 22,\r\n      position: {\r\n        x: 'left',\r\n        y: 'center'\r\n      }\r\n    })\r\n    .addComponent(TypewriterComponent, { text, ...typewriterOptions })\r\n  \r\n  group.set(world, 'voiceover', entity.id)\r\n}\r\n\r\nfunction changeVoiceover(entity, text) {\r\n  const Text = entity.getComponent(TextComponent)\r\n  Text.text = ''\r\n\r\n  if (entity.hasComponent(TypewriterComponent)) {\r\n    const Typewriter = entity.getComponent(TypewriterComponent)\r\n    Typewriter.text = text\r\n  } else {\r\n    entity.addComponent(TypewriterComponent, { text, ...typewriterOptions })\r\n  }\r\n}\r\n\r\nexport function show(texts) {\r\n  function init(world) {\r\n    let text\r\n\r\n    if (Array.isArray(texts)) {\r\n      world.systemData.subIndex = 0\r\n      text = texts[0]\r\n      world.systemData.subIndex++\r\n    } else {\r\n      text = texts\r\n    }\r\n    createVoiceover(world, text)\r\n  }\r\n\r\n  function process(world) {\r\n    const entityId = group.get(world, 'voiceover')\r\n    const voiceover = world.getEntity(entityId)\r\n    const input = world.singleton.getComponent(InputComponent)\r\n\r\n    if (input.isClick === false) {\r\n      return false\r\n    }\r\n\r\n    if (voiceover.hasComponent(TypewriterComponent)) {\r\n      const text = voiceover.getComponent(TypewriterComponent).text\r\n      voiceover.getComponent(TextComponent).text = text\r\n      return false\r\n    }\r\n\r\n    if (\r\n      Array.isArray(texts) &&\r\n      world.systemData.subIndex < texts.length\r\n    ) {\r\n      const text = texts[world.systemData.subIndex]\r\n      world.systemData.subIndex++\r\n      changeVoiceover(voiceover, text)\r\n      return false\r\n    } else {\r\n      return true\r\n    }\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process\r\n  }\r\n}\r\n\r\nexport function hide() {\r\n  function process(world) {\r\n    const entityId = group.get(world, 'voiceover')\r\n    if (entityId) {\r\n      const voiceover = world.getEntity(entityId)\r\n      group.delete(world, 'voiceover')\r\n      world.removeEntity(voiceover)\r\n    }\r\n\r\n    return true\r\n  }\r\n\r\n  return { process }\r\n}\r\n","import { up, down } from './curtain'\r\nimport { show, hide } from './voiceover'\r\n\r\nexport default {\r\n  curtain: { up, down },\r\n  voiceover: { show, hide }\r\n}\r\n","import { InputComponent } from '../../../components/singleton'\r\n\r\nfunction wait(delay) {\r\n  let timer = 0\r\n  function process(world, delta) {\r\n    if (timer >= delay) {\r\n      timer = 0\r\n      return true\r\n    } else {\r\n      timer += delta\r\n      return false\r\n    }\r\n  }\r\n\r\n  return { process }\r\n}\r\n\r\nfunction waitClick() {\r\n  function process(world) {\r\n    const input = world.singleton.getComponent(InputComponent)\r\n\r\n    if (input.isClick === false) {\r\n      return false\r\n    } else {\r\n      return true\r\n    }\r\n  }\r\n\r\n  return {\r\n    process\r\n  }\r\n}\r\n\r\n/**\r\n * \r\n * @param {string | Function} chapter \r\n * @param {number} node \r\n */\r\nfunction goto(chapter, node = 0) {\r\n  function process() {\r\n    return true\r\n  }\r\n\r\n  function goto(world) {\r\n    if (typeof chapter === 'function') {\r\n      return chapter(world.storyData, world.systemData.nodeIndex)\r\n    } else {\r\n      return {\r\n        chapter,\r\n        node\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    process,\r\n    goto\r\n  }\r\n}\r\n\r\nfunction data(callback) {\r\n  function init(world) {\r\n    callback(world.storyData, world.systemData.nodeIndex)\r\n  }\r\n\r\n  function process() {\r\n    return true\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process\r\n  }\r\n}\r\n\r\nexport default { wait, waitClick, goto, data }","import { GroupMap } from '../util'\r\n\r\nexport const group = new GroupMap('scene')\r\n\r\nexport function addTransform(entity, componentClass, start, end, duration) {\r\n  if (entity.hasComponent(componentClass)) {\r\n    entity.removeComponent(componentClass)\r\n  }\r\n\r\n  entity.addComponent(componentClass, {\r\n    start,\r\n    end,\r\n    duration\r\n  })\r\n}\r\n\r\n\r\nexport const fadeIn = {\r\n  render: {\r\n    alpha: 0\r\n  },\r\n  animation: {\r\n    duration: 1000,\r\n    alpha: 1\r\n  }\r\n}\r\n\r\nexport const fadeOut = {\r\n  render: {\r\n    alpha: 1\r\n  },\r\n  animation: {\r\n    duration: 1000,\r\n    alpha: 0\r\n  }\r\n}\r\n\r\nexport const baseShake = {\r\n  amplitude: 10,\r\n  duration: 100\r\n}\r\n","import {\r\n  SpriteComponent,\r\n  TransformComponent,\r\n  TransparentComponent,\r\n  DisplacementComponent,\r\n  FadeComponent\r\n} from '../../../../engine/components'\r\nimport { BackgroundComponent } from '../../../components/tag'\r\nimport { group, addTransform } from './util'\r\n\r\nfunction configOption(options) {\r\n  options = options || {}\r\n\r\n  options.render = {\r\n    alpha: 1,\r\n    ...options.render\r\n  }\r\n\r\n  if (options.animation) {\r\n    options.animation = {\r\n      duration: 1000,\r\n      ...options.animation\r\n    }\r\n  }\r\n\r\n  return options\r\n}\r\n\r\nfunction createEntity(world, id, resource, options) {\r\n  options = configOption(options)\r\n  const entityId = group.get(world, id)\r\n  if (entityId) {\r\n    return\r\n  }\r\n\r\n  const { render, animation } = options\r\n  const entity = world.createEntity(id)\r\n    .addComponent(BackgroundComponent)\r\n    .addComponent(SpriteComponent, {\r\n      layer: 'UserLayer0',\r\n      textureId: resource\r\n    })\r\n    .addComponent(TransformComponent, {\r\n      ...render.position\r\n    })\r\n    .addComponent(TransparentComponent, {\r\n      alpha: render.alpha\r\n    })\r\n\r\n  group.set(world, id, entity.id)\r\n\r\n  if (typeof animation === 'undefined') {\r\n    return\r\n  }\r\n\r\n  const { position, alpha, duration = 1000 } = animation\r\n\r\n  if (position) {\r\n    addTransform(\r\n      entity,\r\n      DisplacementComponent,\r\n      render.position,\r\n      position,\r\n      duration\r\n    )\r\n  }\r\n\r\n  if (typeof alpha === 'number') {\r\n    addTransform(\r\n      entity,\r\n      FadeComponent,\r\n      { alpha: render.alpha },\r\n      { alpha },\r\n      duration\r\n    )\r\n  }\r\n}\r\n\r\nexport function show(id, resource, options) {\r\n  function init(world) {\r\n    createEntity(world, id, resource, options)\r\n  }\r\n\r\n  function process() {\r\n    return true\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process\r\n  }\r\n}\r\n\r\nexport function show_async(id, resource, options) {\r\n  function init(world) {\r\n    createEntity(world, id, resource, options)\r\n  }\r\n\r\n  function process(world) {\r\n    const entityId = group.get(world, id)\r\n    if (entityId) {\r\n      const entity = world.getEntity(entityId)\r\n      if (\r\n        entity.hasComponent(DisplacementComponent) ||\r\n        entity.hasComponent(FadeComponent)\r\n      ) {\r\n        return false\r\n      } else {\r\n        return true\r\n      }\r\n    } else {\r\n      return true\r\n    }\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process\r\n  }\r\n}","import {\r\n  TransformComponent,\r\n  TransparentComponent,\r\n  DisplacementComponent,\r\n  FadeComponent\r\n} from '../../../../engine/components'\r\nimport { RemoveComponent } from '../../../components/tag'\r\nimport { group, addTransform } from './util'\r\n\r\nfunction configOption(options) {\r\n  options = options || {}\r\n\r\n  if (options.animation) {\r\n    options.animation = {\r\n      duration: 1000,\r\n      ...options.animation\r\n    }\r\n  }\r\n\r\n  return options\r\n}\r\n\r\nfunction getEntity(world, id) {\r\n  const entityId = group.get(world, id)\r\n\r\n  if (!entityId) {\r\n    return null\r\n  }\r\n\r\n  const entity = world.getEntity(entityId)\r\n\r\n  if (!entity) {\r\n    return null\r\n  }\r\n\r\n  return entity\r\n}\r\n\r\nfunction setEntity(world, id, options) {\r\n  options = configOption(options)\r\n  let { render, animation } = options\r\n  const entity = getEntity(world, id)\r\n\r\n  if (entity === null) {\r\n    return\r\n  }\r\n\r\n  const Transform = entity.getComponent(TransformComponent)\r\n  const Transparent = entity.getComponent(TransparentComponent)\r\n\r\n  render = {\r\n    position: {\r\n      x: Transform.x,\r\n      y: Transform.y,\r\n    },\r\n    alpha: Transparent.alpha,\r\n    ...render\r\n  }\r\n\r\n  if (!animation) {\r\n    return\r\n  }\r\n\r\n  const { position, alpha, duration = 1000 } = animation\r\n\r\n  if (position) {\r\n    addTransform(\r\n      entity,\r\n      DisplacementComponent,\r\n      render.position,\r\n      position,\r\n      duration\r\n    )\r\n  }\r\n\r\n  if (typeof alpha === 'number') {\r\n    addTransform(\r\n      entity,\r\n      FadeComponent,\r\n      { alpha: render.alpha },\r\n      { alpha },\r\n      duration\r\n    )\r\n  }\r\n}\r\n\r\nexport function hide(id, options) {\r\n  function init(world) {\r\n    setEntity(world, id, options)\r\n  }\r\n\r\n  function process(world) {\r\n    const entity = getEntity(world, id)\r\n\r\n    if (entity === null) {\r\n      return true\r\n    } else {\r\n      group.delete(world, id)\r\n      entity.addComponent(RemoveComponent)\r\n      return true\r\n    }\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process\r\n  }\r\n}\r\n\r\nexport function hide_async(id, options) {\r\n  function init(world) {\r\n    setEntity(world, id, options)\r\n  }\r\n\r\n  function process(world) {\r\n    const entity = getEntity(world, id)\r\n\r\n    if (entity === null) {\r\n      return true\r\n    } else {\r\n      if (\r\n        entity.hasComponent(DisplacementComponent) ||\r\n        entity.hasComponent(FadeComponent)\r\n      ) {\r\n        return false\r\n      } else {\r\n        group.delete(world, id)\r\n        world.removeEntity(entity)\r\n        return true\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process\r\n  }\r\n}\r\n","import { show, show_async } from './show'\r\nimport { hide, hide_async } from './hide'\r\nimport { shake } from './shake'\r\nimport { fadeIn, fadeOut, baseShake } from './util'\r\n\r\nexport default { show, hide, show_async, hide_async, shake, fadeIn, fadeOut, baseShake }\r\n","import {\r\n  TransformComponent\r\n} from '../../../../engine/components'\r\nimport { group } from './util'\r\n\r\nfunction getEntity(world, id) {\r\n  const entityId = group.get(world, id)\r\n\r\n  if (!entityId) {\r\n    return null\r\n  }\r\n\r\n  const entity = world.getEntity(entityId)\r\n\r\n  if (!entity) {\r\n    return null\r\n  }\r\n\r\n  return entity\r\n}\r\n\r\nexport function shake(id, options) {\r\n  let timer = 0\r\n  options = options || {}\r\n\r\n  function process(world) {\r\n    const { amplitude = 0, duration = 0 } = options\r\n    const entity = getEntity(world, id)\r\n\r\n    if (entity === null) {\r\n      timer = 0\r\n      return true\r\n    } else {\r\n      const Transform = entity.getComponent(TransformComponent)\r\n      if (duration <= timer) {\r\n        Transform.x = 0\r\n        Transform.y = 0\r\n        timer = 0\r\n        return true\r\n      }\r\n      Transform.x = Math.round(Math.random() * amplitude * 2) - amplitude\r\n      Transform.y = Math.round(Math.random() * amplitude * 2) - amplitude\r\n      timer++\r\n      return false\r\n    }\r\n  }\r\n\r\n  return {\r\n    process\r\n  }\r\n}\r\n","import { GroupMap } from '../util'\r\n\r\nexport const group = new GroupMap('dialog')\r\n","import {\r\n  TextComponent,\r\n  TransformComponent,\r\n  TypewriterComponent\r\n} from '../../../../engine/components'\r\nimport { InputComponent } from '../../../components/singleton'\r\nimport { DialogComponent, NameComponent } from '../../../components/tag'\r\nimport { gameInfo, nameStyle, dialogStyle, textBackground } from '../../../config'\r\nimport { group } from './util'\r\n\r\nconst typewriterOptions = {\r\n  speed: 22\r\n}\r\n\r\nfunction createDialog(world, text) {\r\n  const entityId = group.get(world, 'text')\r\n  if (entityId) {\r\n    changeDialog(world.getEntity(entityId), text)\r\n    return\r\n  }\r\n\r\n  const entity = world.createEntity('dialog')\r\n    .addComponent(DialogComponent)\r\n    .addComponent(TextComponent, {\r\n      layer: 'UserLayer8',\r\n      style: dialogStyle,\r\n      bgTextureId: textBackground.dialog.id,\r\n      padding: textBackground.dialog.padding\r\n    })\r\n    .addComponent(TransformComponent, {\r\n      x: 0,\r\n      y: gameInfo.height - textBackground.dialog.height\r\n    })\r\n    .addComponent(TypewriterComponent, { text, ...typewriterOptions })\r\n\r\n  group.set(world, 'text', entity.id)\r\n}\r\n\r\nfunction changeDialog(entity, text) {\r\n  const Text = entity.getComponent(TextComponent)\r\n  Text.text = ''\r\n\r\n  if (entity.hasComponent(TypewriterComponent)) {\r\n    const Typewriter = entity.getComponent(TypewriterComponent)\r\n    Typewriter.text = text\r\n  } else {\r\n    entity.addComponent(TypewriterComponent, { text, ...typewriterOptions })\r\n  }\r\n}\r\n\r\nfunction createName(world, text) {\r\n  const entityId = group.get(world, 'name')\r\n  if (entityId) {\r\n    const Text = world.getEntity(entityId).getComponent(TextComponent)\r\n    Text.text = text\r\n    return\r\n  }\r\n\r\n  const entity = world.createEntity('name')\r\n    .addComponent(TextComponent, {\r\n      layer: 'UserLayer8',\r\n      text,\r\n      style: nameStyle,\r\n      bgTextureId: textBackground.name.id,\r\n      padding: textBackground.name.padding,\r\n      position: {\r\n        x: 'center',\r\n        y: 'center'\r\n      }\r\n    })\r\n    .addComponent(TransformComponent, {\r\n      x: 0,\r\n      y: gameInfo.height - textBackground.name.height - textBackground.dialog.height\r\n    })\r\n    .addComponent(NameComponent)\r\n\r\n  group.set(world, 'name', entity.id)\r\n}\r\n\r\nfunction removeName(world) {\r\n  const entityId = group.get(world, 'name')\r\n  if (entityId) {\r\n    const name = world.getEntity(entityId)\r\n    world.removeEntity(name)\r\n    group.delete(world, 'name')\r\n  }\r\n}\r\n\r\nexport function show(texts, name, auto = false) {\r\n  function init(world) {\r\n    let text\r\n\r\n    if (Array.isArray(texts)) {\r\n      world.systemData.subIndex = 0\r\n      text = texts[0]\r\n      world.systemData.subIndex++\r\n    } else {\r\n      text = texts\r\n    }\r\n    createDialog(world, text)\r\n\r\n    if (name) {\r\n      createName(world, name)\r\n    } else {\r\n      removeName(world)\r\n    }\r\n  }\r\n\r\n  function process(world) {\r\n    const dialog = world.getEntity(group.get(world, 'text'))\r\n    const input = world.singleton.getComponent(InputComponent)\r\n    const isClick = auto ? true : input.isClick\r\n\r\n    if (dialog.hasComponent(TypewriterComponent)) {\r\n      if (input.isClick) {\r\n        const text = dialog.getComponent(TypewriterComponent).text\r\n        dialog.getComponent(TextComponent).text = text\r\n        dialog.removeComponent(TypewriterComponent)\r\n      }\r\n      return false\r\n    }\r\n\r\n    if (isClick === false) {\r\n      return false\r\n    }\r\n\r\n    if (\r\n      Array.isArray(texts) &&\r\n      world.systemData.subIndex < texts.length\r\n    ) {\r\n      const text = texts[world.systemData.subIndex]\r\n      world.systemData.subIndex++\r\n      changeDialog(dialog, text)\r\n      return false\r\n    } else {\r\n      return true\r\n    }\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process\r\n  }\r\n}\r\n","import { show } from './show'\r\nimport { hide } from './hide'\r\n\r\nexport default { show, hide }\r\n","import { group } from './util'\r\n\r\nexport function hide() {\r\n  function process(world) {\r\n    let entityId = group.get(world, 'text')\r\n    if (entityId) {\r\n      const dialog = world.getEntity(entityId)\r\n      group.delete(world, 'text')\r\n      world.removeEntity(dialog)\r\n    }\r\n\r\n    entityId = group.get(world, 'name')\r\n    if (entityId) {\r\n      const name = world.getEntity(entityId)\r\n      group.delete(world, 'name')\r\n      world.removeEntity(name)\r\n    }\r\n\r\n    return true\r\n  }\r\n\r\n  return { process }\r\n}\r\n","import {\r\n  SpriteComponent,\r\n  AnimationComponent,\r\n  TransformComponent,\r\n  TransparentComponent,\r\n  FadeComponent\r\n} from '../../../../engine/components'\r\nimport { CharacterComponent } from '../../../components/tag'\r\nimport { GroupMap } from '../util'\r\n\r\nexport const group = new GroupMap('character')\r\n\r\nexport function createComponent(world, component) {\r\n  const entity = world.createEntity()\r\n    .addComponent(CharacterComponent)\r\n    .addComponent(TransformComponent, {\r\n      x: component.x,\r\n      y: component.y\r\n    })\r\n    .addComponent(TransparentComponent, {\r\n      alpha: 1\r\n    })\r\n\r\n  if (Array.isArray(component.res)) {\r\n    entity.addComponent(AnimationComponent, {\r\n      layer: `UserLayer${component.layer + 2}`,\r\n      texturesId: component.res,\r\n      cycle: 5000,\r\n      animationSpeed: 0.2\r\n    })\r\n  } else {\r\n    entity.addComponent(SpriteComponent, {\r\n      layer: `UserLayer${component.layer + 2}`,\r\n      textureId: component.res\r\n    })\r\n  }\r\n\r\n  return entity\r\n}\r\n\r\n/**\r\n * \r\n * \r\n * TODO: \r\n * \r\n * \r\n * @param {Entity} entity \r\n * @param {number} alpha \r\n * @param {number} duration \r\n * @returns {Entity}\r\n */\r\nexport function addFade(entity, alpha, duration = 0) {\r\n  const Transparent = entity.getComponent(TransparentComponent)\r\n  if (duration > 0) {\r\n    Transparent.alpha = 1 - alpha\r\n    entity.addComponent(FadeComponent, {\r\n      targetId: 'TransparentComponent',\r\n      start: {\r\n        alpha: 1 - alpha\r\n      },\r\n      end: {\r\n        alpha\r\n      },\r\n      duration\r\n    })\r\n  } else {\r\n    Transparent.alpha = alpha\r\n  }\r\n\r\n  return entity\r\n}\r\n\r\n/**\r\n * \r\n * @param {Entity} entity \r\n * @returns {boolean}\r\n */\r\nexport function fadeCompleted(entity) {\r\n  return !entity.hasComponent(FadeComponent)\r\n}\r\n","import { eyes, mouth, head, body, hand, map } from './components'\r\n\r\n// \r\n// \r\nexport const xing_nai_1 = [\r\n  eyes['1001_e'],\r\n  mouth['1001_m-01'],\r\n  body['1001_b'],\r\n  head['1001_he'],\r\n  hand['1001_ha'],\r\n  hand['1002_ha']\r\n]\r\n\r\n// -\r\nexport const xing_nai_2 = [\r\n  eyes['1006_e'],\r\n  mouth['1001_m-04'],\r\n  body['1001_b'],\r\n  head['1001_he'],\r\n  hand['1007_ha'],\r\n  hand['1002_ha']\r\n]\r\n\r\n// -\r\nexport const xing_nai_2_1 = [\r\n  eyes['1010_e'],\r\n  mouth['1003_m'],\r\n  body['1001_b'],\r\n  head['1001_he'],\r\n  hand['1007_ha'],\r\n  hand['1002_ha']\r\n]\r\n\r\n// -//\r\nexport const xing_nai_3 = [\r\n  eyes['1007_e'],\r\n  mouth['1001_m-07'],\r\n  body['1001_b'],\r\n  head['1001_he'],\r\n  hand['1005_ha']\r\n]\r\n\r\n// -\r\nexport const xing_nai_4 = [\r\n  eyes['1005_e'],\r\n  mouth['1001_m-03'],\r\n  body['1001_b'],\r\n  head['1001_he'],\r\n  hand['1007_ha'],\r\n  hand['1002_ha']\r\n]\r\n\r\n// -\r\nexport const xing_nai_5 = [\r\n  eyes['1004_e'],\r\n  mouth['1001_m-02'],\r\n  body['1001_b'],\r\n  head['1001_he'],\r\n  hand['1007_ha'],\r\n  hand['1002_ha']\r\n]\r\n\r\n// -/\r\nexport const xing_nai_6 = [\r\n  eyes['1008_e'],\r\n  mouth['1001_m-06'],\r\n  body['1001_b'],\r\n  head['1001_he'],\r\n  hand['1005_ha']\r\n]\r\n\r\n// -//\r\nexport const xing_nai_7 = [\r\n  eyes['1002_e'],\r\n  mouth['1001_m-05'],\r\n  body['1001_b'],\r\n  head['1001_he'],\r\n  hand['1007_ha'],\r\n  hand['1002_ha']\r\n]\r\n\r\n// --\r\nexport const xing_nai_map_1 = [\r\n  map['map02001f'],\r\n  map['map02001']\r\n]\r\n\r\n// --\r\nexport const xing_nai_map_2 = [\r\n  map['map02001d'],\r\n  map['map02001']\r\n]\r\n\r\n// Sawa\r\n// -\r\nexport const sawa_1 = [\r\n  head['3001_he'],\r\n  eyes['3005_e'],\r\n  mouth['3002_m'],\r\n  body['3001_b']\r\n]\r\n\r\n// -\r\nexport const sawa_2 = [\r\n  head['3001_he'],\r\n  eyes['3001_e'],\r\n  mouth['3001_m-01'],\r\n  body['3001_b']\r\n]\r\n\r\n// -\r\nexport const sawa_3 = [\r\n  head['3001_he'],\r\n  eyes['3003_e'],\r\n  mouth['3001_m-03'],\r\n  body['3001_b']\r\n]\r\n\r\n// -\r\nexport const sawa_4 = [\r\n  head['3001_he'],\r\n  eyes['3002_e'],\r\n  mouth['3001_m-02'],\r\n  body['3001_b']\r\n]\r\n\r\n// -\r\nexport const sawa_5 = [\r\n  head['3001_he'],\r\n  eyes['3004_e'],\r\n  mouth['3001_m-04'],\r\n  body['3001_b']\r\n]\r\n\r\n// -\r\nexport const sawa_6 = [\r\n  head['3001_he'],\r\n  eyes['3003_e'],\r\n  mouth['3001_m-03'],\r\n  body['3002_b']\r\n]\r\n\r\n// -\r\nexport const sawa_7 = [\r\n  head['3001_he'],\r\n  eyes['3001_e'],\r\n  mouth['3001_m-01'],\r\n  body['3002_b']\r\n]\r\n\r\n// -\r\nexport const sawa_8 = [\r\n  head['3001_he'],\r\n  eyes['3002_e'],\r\n  mouth['3001_m-02'],\r\n  body['3002_b']\r\n]\r\n\r\n// \r\n// \r\nexport const xing_sha_1 = [\r\n  eyes['2003_e'],\r\n  mouth['2001_m-03'],\r\n  body['2001_b']\r\n]\r\n\r\n// \r\nexport const xing_sha_2 = [\r\n  eyes['2001_e'],\r\n  mouth['2001_m-01'],\r\n  body['2001_b']\r\n]\r\n\r\n//\r\n// \r\nexport const liu_man_1 = [\r\n  head['4002_he'],\r\n  eyes['4002_e'],\r\n  body['4001_b']\r\n]\r\n\r\n// \r\nexport const liu_man_2 = [\r\n  head['4001_he'],\r\n  eyes['4001_e'],\r\n  body['4001_b']\r\n]\r\n","import { createComponent, addFade, fadeCompleted, group } from './util'\r\nimport * as character from '../../../config/character'\r\n\r\n/**\r\n * \r\n * @param {*} world engin world\r\n * @param {string} id id\r\n * @param {string | any[]} key config  key\r\n */\r\nfunction createChar(world, id, key) {\r\n  let char\r\n  if (Array.isArray(key)) {\r\n    char = key\r\n  } else {\r\n    char = character[key]\r\n  }\r\n\r\n  if (typeof char === 'undefined') {\r\n    return\r\n  }\r\n\r\n  if (typeof group.get(world, id) !== 'undefined') {\r\n    return\r\n  }\r\n\r\n  const entityIdList = []\r\n  for (const comp of char) {\r\n    const entity = createComponent(world, comp)\r\n    addFade(entity, 1)\r\n    entityIdList.push(entity.id)\r\n  }\r\n  group.set(world, id, entityIdList)\r\n}\r\n\r\nexport function show(id, key = id) {\r\n  function init(world) {\r\n    createChar(world, id, key)\r\n  }\r\n\r\n  function process(world) {\r\n    const entityIdList = group.get(world, id)\r\n    let flag = true\r\n\r\n    if (typeof entityIdList !== 'undefined') {\r\n      entityIdList.forEach(item => {\r\n        const entity = world.getEntity(item)\r\n        if (!fadeCompleted(entity)) {\r\n          flag = false\r\n        }\r\n      })\r\n    }\r\n\r\n    return flag\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process\r\n  }\r\n}","import { show } from './show'\r\nimport { hide } from './hide'\r\nimport { update } from './update'\r\n\r\nexport default { show, hide, update }\r\n","import { group, addFade, fadeCompleted } from './util'\r\n\r\nexport function hide(id) {\r\n  function init(world) {\r\n    const entityIdList = group.get(world, id)\r\n  \r\n    if (typeof entityIdList !== 'undefined') {\r\n      entityIdList.forEach(item => {\r\n        const entity = world.getEntity(item)\r\n        addFade(entity, 0)\r\n      })\r\n    }\r\n  }\r\n\r\n  function process(world) {\r\n    const entityIdList = group.get(world, id)\r\n    let flag = true\r\n\r\n    if (typeof entityIdList !== 'undefined') {\r\n      entityIdList.forEach(item => {\r\n        const entity = world.getEntity(item)\r\n        if (fadeCompleted(entity)) {\r\n          group.delete(world, id)\r\n          world.removeEntity(entity)\r\n        } else {\r\n          flag = false\r\n        }\r\n      })\r\n    }\r\n\r\n    return flag\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process\r\n  }\r\n}\r\n","import { createComponent, group } from './util'\r\n\r\nexport function update(id, index, component) {\r\n  function init(world) {\r\n    const entityIdList = group.get(world, id)\r\n  \r\n    if (typeof entityIdList !== 'undefined') {\r\n      const item = entityIdList[index]\r\n      let entity = world.getEntity(item)\r\n      world.removeEntity(entity)\r\n      entity = createComponent(world, component)\r\n      entityIdList[index] = entity.id\r\n    }\r\n  }\r\n\r\n  function process() {\r\n    return true\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process\r\n  }\r\n}","import { GroupMap } from '../util'\r\n\r\nexport const group = new GroupMap('choice')\r\n","import { select } from './select'\r\nimport { button } from './button'\r\nexport default {\r\n  select,\r\n  button\r\n}\r\n","import {\r\n  TextComponent,\r\n  ButtonComponent,\r\n  TransformComponent\r\n} from '../../../../engine/components'\r\nimport { ChoiceComponent } from '../../../components/tag'\r\nimport { gameInfo, buttonStyle, textBackground } from '../../../config'\r\nimport { group } from './util'\r\n\r\nfunction createButton(world, text, x, y) {\r\n  const entity = world.createEntity()\r\n    .addComponent(ChoiceComponent)\r\n    .addComponent(ButtonComponent)\r\n    .addComponent(TransformComponent, { x, y })\r\n    .addComponent(TextComponent, {\r\n      layer: 'UserLayer8',\r\n      text,\r\n      style: buttonStyle,\r\n      bgTextureId: textBackground.button.id,\r\n      padding: textBackground.button.padding,\r\n      position: {\r\n        x: 'center',\r\n        y: 'center'\r\n      }\r\n    })\r\n  \r\n  return entity\r\n}\r\n\r\nexport function select(options, actions) {\r\n  let gotoResult = {}\r\n  options = options || []\r\n  actions = actions || []\r\n\r\n  function init(world) {\r\n    let entityIdList = group.get(world, 'select')\r\n\r\n    if (entityIdList || options.length <= 0) {\r\n      return\r\n    }\r\n\r\n    const x = (gameInfo.width - textBackground.button.width) / 2\r\n    let y = (gameInfo.height - (textBackground.button.height * options.length + 15 * (options.length - 1))) / 2\r\n\r\n    entityIdList = []\r\n    options.forEach(item => {\r\n      const entity = createButton(world, item, x, y)\r\n      y = y + textBackground.button.height + 15\r\n      entityIdList.push(entity.id)\r\n    })\r\n    group.set(world, 'select', entityIdList)\r\n  }\r\n\r\n  function process(world) {\r\n    let entityIdList = group.get(world, 'select')\r\n\r\n    if (typeof entityIdList === 'undefined') {\r\n      return true\r\n    }\r\n\r\n    const count = entityIdList.length\r\n\r\n    for (let i = 0; i < count; i++) {\r\n      const entity = world.getEntity(entityIdList[i])\r\n      const btn = entity.getComponent(ButtonComponent)\r\n      if (btn.isClick === true) {\r\n        const action = actions[i]\r\n        gotoResult = {}\r\n        if (typeof action === 'number') {\r\n          gotoResult.node = action\r\n        } else if (typeof action === 'function') {\r\n          gotoResult = action(world.storyData, world.systemData.nodeIndex)\r\n        } else {\r\n          gotoResult = null\r\n        }\r\n\r\n        entityIdList.forEach(item => {\r\n          const entity = world.getEntity(item)\r\n          world.removeEntity(entity)\r\n        })\r\n        group.delete(world, 'select')\r\n        return true\r\n      }\r\n    }\r\n    return false\r\n  }\r\n\r\n  function goto() {\r\n    return gotoResult\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process,\r\n    goto\r\n  }\r\n}","import {\r\n  TextComponent,\r\n  ButtonComponent,\r\n  TransformComponent\r\n} from '../../../../engine/components'\r\nimport { ChoiceComponent } from '../../../components/tag'\r\nimport { group } from './util'\r\n\r\nfunction createButton(world, textureId, x = 0, y = 0) {\r\n  const entity = world.createEntity()\r\n    .addComponent(ChoiceComponent)\r\n    .addComponent(TransformComponent, { x, y })\r\n    .addComponent(ButtonComponent, { useAnimation: false })\r\n    .addComponent(TextComponent, {\r\n      layer: 'UserLayer8',\r\n      text: '',\r\n      bgTextureId: textureId\r\n    })\r\n  \r\n  return entity\r\n}\r\n\r\nexport function button(list) {\r\n  let gotoResult = {}\r\n  if (!Array.isArray(list)) {\r\n    list = [list]\r\n  }\r\n\r\n  function init(world) {\r\n    list.forEach(item => {\r\n      const { id, resource, options } = item\r\n      const entityId = group.get(world, id)\r\n\r\n      if (entityId) {\r\n        return\r\n      }\r\n  \r\n      const { x, y } = options\r\n      const entity = createButton(world, resource, x, y)\r\n      group.set(world, id, entity.id)\r\n    })\r\n  }\r\n\r\n  function process(world) {\r\n    const count = list.length\r\n\r\n    for (let i = 0; i < count; i++) {\r\n      const { id, options } = list[i]\r\n      const entityId = group.get(world, id)\r\n\r\n      if (!entityId) {\r\n        continue\r\n      }\r\n\r\n      const entity = world.getEntity(entityId)\r\n      const btn = entity.getComponent(ButtonComponent)\r\n      if (btn.isClick === true) {\r\n        const { action } = options\r\n        gotoResult = {}\r\n        if (typeof action === 'number') {\r\n          gotoResult.node = action\r\n        } else if (typeof action === 'function') {\r\n          gotoResult = action(world.storyData, world.systemData.nodeIndex)\r\n        } else {\r\n          gotoResult = null\r\n        }\r\n\r\n        list.forEach(item => {\r\n          const entityId = group.get(world, item.id)\r\n          const entity = world.getEntity(entityId)\r\n          world.removeEntity(entity)\r\n          group.delete(world, item.id)\r\n        })\r\n        return true\r\n      }\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n  function goto() {\r\n    return gotoResult\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process,\r\n    goto\r\n  }\r\n}\r\n\r\n// export function button(id, resource, options) {\r\n//   let gotoResult = {}\r\n\r\n//   function init(world) {\r\n//     const entityId = group.get(world, id)\r\n\r\n//     if (entityId) {\r\n//       return\r\n//     }\r\n\r\n//     const { x, y } = options\r\n//     const entity = createButton(world, resource, x, y)\r\n//     group.set(world, id, entity.id)\r\n//   }\r\n\r\n//   function process(world) {\r\n//     const entityId = group.get(world, id)\r\n\r\n//     if (!entityId) {\r\n//       return true\r\n//     }\r\n\r\n//     const entity = world.getEntity(entityId)\r\n//     const btn = entity.getComponent(ButtonComponent)\r\n//     if (btn.isClick === true) {\r\n//       const { action } = options\r\n//       gotoResult = {}\r\n//       if (typeof action === 'number') {\r\n//         gotoResult.node = action\r\n//       } else if (typeof action === 'undefined') {\r\n//         gotoResult = null\r\n//       } else {\r\n//         gotoResult = action(world.storyData, world.systemData)\r\n//       }\r\n\r\n//       // world.removeEntity(entity)\r\n//       // group.delete(world, id)\r\n//       return true\r\n//     } else {\r\n//       return false\r\n//     }\r\n//   }\r\n\r\n//   function goto() {\r\n//     return gotoResult\r\n//   }\r\n\r\n//   return {\r\n//     init,\r\n//     process,\r\n//     goto\r\n//   }\r\n// }\r\n","import { GroupMap } from '../util'\r\n\r\nexport const group = new GroupMap('bgm')\r\n","import { SoundComponent } from '../../../../engine/components'\r\nimport { BGMComponent } from '../../../components/tag'\r\nimport { group } from './util'\r\n\r\nfunction play(alias, options) {\r\n  options = options || {}\r\n\r\n  function init(world) {\r\n    const entityId = group.get(world, alias)\r\n\r\n    if (entityId) {\r\n      return\r\n    }\r\n\r\n    const entity = world.createEntity()\r\n      .addComponent(BGMComponent)\r\n      .addComponent(SoundComponent, {\r\n        alias,\r\n        options\r\n      })\r\n\r\n    group.set(world, alias, entity.id)\r\n  }\r\n\r\n  function process() {\r\n    return true\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process\r\n  }\r\n}\r\n\r\nfunction stop(alias) {\r\n  function init(world) {\r\n    const entityId = group.get(world, alias)\r\n\r\n    if (entityId) {\r\n      const entity = world.getEntity(entityId)\r\n      const Sound = entity.getComponent(SoundComponent)\r\n      Sound.isPlaying = false\r\n      group.delete(world, alias)\r\n    }\r\n  }\r\n\r\n  function process() {\r\n    return true\r\n  }\r\n\r\n  return {\r\n    init,\r\n    process\r\n  }\r\n}\r\n\r\nexport default {\r\n  play,\r\n  stop\r\n}\r\n","import { colorText } from './util'\r\n\r\nexport { default as stage } from './stage'\r\nexport { default as flow } from './flow'\r\nexport { default as scene } from './scene'\r\nexport { default as dialog } from './dialog'\r\nexport { default as character } from './character'\r\nexport { default as choice } from './choice'\r\nexport { default as bgm } from './bgm'\r\nexport const util = {\r\n  colorText\r\n}\r\n","import { flow, character } from '../api'\r\n\r\nexport const chapter1 = [\r\n  flow.goto('chapter1_1')\r\n]\r\n","import { bgm, stage, scene, dialog, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\nexport const chapter1_1 = [\r\n  stage.voiceover.show([\r\n    ...util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    ),\r\n    util.colorText('       ', color.burlywood),\r\n    util.colorText('', color.deepskyblue)\r\n  ]),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.show('hai_bian_d', 'map01001'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      '',\r\n      '\\n',\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      '\\n'\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '~'\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  scene.shake('hai_bian_d', scene.baseShake),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  bgm.stop('shopping'),\r\n  bgm.play('funny', {\r\n    loop: true\r\n  }),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '\\n',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter1_2')\r\n]\r\n","import { bgm, stage, scene, dialog, character, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\nexport const chapter1_2 = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  scene.show('gong_yuan', 'map01008'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '..',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  bgm.stop('shopping'),\r\n  bgm.play('night', {\r\n    loop: true\r\n  }),\r\n\r\n  character.show('xing_nai_1'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  dialog.hide(),\r\n  character.hide('xing_nai_1'),\r\n  character.show('xing_nai_map_1'),\r\n  flow.waitClick(),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('xing_nai_map_1'),\r\n  character.show('xing_nai_1'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('xing_nai_1'),\r\n  character.show('xing_nai_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '!',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_2'),\r\n  character.show('xing_nai_3'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_3'),\r\n  character.show('xing_nai_2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  bgm.stop('night'),\r\n  bgm.play('funny', {\r\n    loop: true\r\n  }),\r\n\r\n  character.hide('xing_nai_2'),\r\n  character.show('xing_nai_2_1'),\r\n\r\n  dialog.show(\r\n    '~~',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_2_1'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.show('xing_nai_2_1'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_2_1'),\r\n  dialog.hide(),\r\n  scene.shake('gong_yuan', scene.baseShake),\r\n  scene.hide('gong_yuan'),\r\n  scene.show('cg03001', 'map03001'),\r\n  flow.waitClick(),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '~~~~~~',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  dialog.hide(),\r\n  scene.shake('cg03001', scene.baseShake),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  dialog.hide(),\r\n  scene.hide('cg03001'),\r\n  scene.show('gong_yuan', 'map01008'),\r\n  scene.shake('gong_yuan', scene.baseShake),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '\\n',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  bgm.stop('funny'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter1_3')\r\n]\r\n","/**\r\n * \r\n * @param {string} chapter\r\n * @param {number} [index] \r\n */\r\nexport function initRoadSignData(chapter, index = 0) {\r\n  return {\r\n    /**\r\n     * \r\n     * @type {string}\r\n     */\r\n    chapter,\r\n\r\n    /**\r\n     * \r\n     * @type {number}\r\n     */\r\n    index,\r\n\r\n    /**\r\n     * \r\n     * @type {number}\r\n     */\r\n    target: 0,\r\n\r\n    /**\r\n     * \r\n     * @type {number}\r\n     */\r\n    seaside: 0,\r\n\r\n    /**\r\n     * \r\n     * @type {number}\r\n     */\r\n    shopping: 0,\r\n\r\n    /**\r\n     * \r\n     * @type {number}\r\n     */\r\n    temple: 0,\r\n\r\n    /**\r\n     * \r\n     * @type {number}\r\n     */\r\n    park: 0,\r\n\r\n    /**\r\n     * \r\n     * @type {number}\r\n     */\r\n    hostel: 0\r\n  }\r\n}\r\n","import { scene, choice, dialog } from './api'\r\n\r\n// \r\nexport const townStreet = [\r\n  scene.show('da_jie', 'map01010'),\r\n  scene.show('lu_pai', 'map01010a', {\r\n    render: {\r\n      position: {\r\n        x: 0,\r\n        y: 48\r\n      }\r\n    }\r\n  }),\r\n]\r\n\r\n// \r\nexport function roomEvent(length1 = 0, length2 = 0) {\r\n  return [\r\n    choice.button(\r\n      {\r\n        id: 'door',\r\n        resource: 'map01011-0',\r\n        options: {\r\n          x: 188,\r\n          y: 107\r\n        }\r\n      },\r\n    ),\r\n  \r\n    dialog.show(''),\r\n    choice.select(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      [\r\n        (data, index) => {\r\n          return {\r\n            node: index + 1 + length1\r\n          }\r\n        },\r\n        (data, index) => {\r\n          return {\r\n            node: index + 1 + length2\r\n          }\r\n        },\r\n        data => {\r\n          return {\r\n            node: data.room\r\n          }\r\n        }\r\n      ]\r\n    ),\r\n  ]\r\n}","import { bgm, stage, scene, dialog, choice, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\nimport { initRoadSignData } from '../../utils'\r\nimport { townStreet } from '../../common'\r\n\r\nconst option11 = [\r\n  dialog.show(`[style={\"fill\": \"${color.tomato}\"}][/style]`),\r\n  flow.goto(data => {\r\n    return {\r\n      node: data.roadSign.index\r\n    }\r\n  })\r\n]\r\nconst option12 = [\r\n  dialog.show(`[style={\"fill\": \"${color.tomato}\"}][/style]`),\r\n  flow.goto(data => {\r\n    return {\r\n      node: data.roadSign.index\r\n    }\r\n  })\r\n]\r\nconst option21 = [\r\n  dialog.show(`[style={\"fill\": \"${color.tomato}\"}][/style]`),\r\n  flow.goto(data => {\r\n    return {\r\n      node: data.roadSign.index\r\n    }\r\n  })\r\n]\r\nconst option22 = [\r\n  dialog.show(`[style={\"fill\": \"${color.tomato}\"}][/style]`),\r\n  flow.goto(data => {\r\n    return {\r\n      node: data.roadSign.index\r\n    }\r\n  })\r\n]\r\nconst option23 = [\r\n  dialog.show(`[style={\"fill\": \"${color.tomato}\"}][/style]`),\r\n  bgm.stop('shopping'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter1_4'),\r\n]\r\n\r\nconst option1 = [\r\n  choice.select(\r\n    [\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    [\r\n      (data, index) => {\r\n        data.roadSign.seaside++\r\n        return {\r\n          node: index + 1\r\n        }\r\n      },\r\n      (data, index) => {\r\n        data.roadSign.shopping++\r\n        return {\r\n          node: index + option11.length + 1\r\n        }\r\n      },\r\n      data => {\r\n        return {\r\n          node: data.roadSign.index\r\n        }\r\n      }\r\n    ]\r\n  ),\r\n\r\n  ...option11,\r\n  ...option12\r\n]\r\n\r\nconst option2 = [\r\n  choice.select(\r\n    [\r\n      '',\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    [\r\n      (data, index) => {\r\n        data.roadSign.temple++\r\n        return {\r\n          node: index + 1\r\n        }\r\n      },\r\n      (data, index) => {\r\n        data.roadSign.park++\r\n        return {\r\n          node: index + 1 + option21.length\r\n        }\r\n      },\r\n      (data, index) => {\r\n        data.roadSign.hostel++\r\n        return {\r\n          node: index + 1 + option21.length + option21.length\r\n        }\r\n      },\r\n      data => {\r\n        return {\r\n          node: data.roadSign.index\r\n        }\r\n      }\r\n    ]\r\n  ),\r\n\r\n  ...option21,\r\n  ...option22,\r\n  ...option23\r\n]\r\n\r\nexport const chapter1_3 = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  ...townStreet,\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      `[style={\"fill\": \"${color.tomato}\"}][/style][style={\"fill\": \"${color.tomato}\"}][/style]`,\r\n      `~[style={\"fill\": \"${color.tomato}\"}][/style]`,\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n\r\n  flow.data((data, index) => {\r\n    if (data.roadSign.chapter !== 'chapter1_3') {\r\n      data.roadSign = initRoadSignData('chapter1_3', index + 1)\r\n    }\r\n  }),\r\n\r\n  dialog.show(\r\n    `[style={\"fill\": \"${color.tomato}\"}][/style]`,\r\n    '',\r\n    true\r\n  ),\r\n\r\n  choice.button([\r\n    {\r\n      id: 'left',\r\n      resource: 'map01010a-0',\r\n      options: {\r\n        x: 32,\r\n        y: 134,\r\n        action: data => {\r\n          data.roadSign.target = 1\r\n        }\r\n      }\r\n    },\r\n    {\r\n      id: 'right',\r\n      resource: 'map01010a-1',\r\n      options: {\r\n        x: 253,\r\n        y: 168,\r\n        action: data => {\r\n          data.roadSign.target = 2\r\n        }\r\n      }\r\n    }\r\n  ]),\r\n\r\n  dialog.show(''),\r\n  flow.goto((data, index) => {\r\n    const roadSign = data.roadSign\r\n\r\n    if (roadSign.target === 1) {\r\n      return {\r\n        node: index + 1\r\n      }\r\n    } else {\r\n      return {\r\n        node: index + 1 + option1.length\r\n      }\r\n    }\r\n  }),\r\n\r\n  ...option1,\r\n  ...option2\r\n]\r\n","import { bgm, stage, scene, dialog, character, choice, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\nconst option11 = [\r\n  dialog.show(\r\n    'Sawa',\r\n    ''\r\n  ),\r\n  flow.goto(data => {\r\n    return {\r\n      node: data.room\r\n    }\r\n  })\r\n]\r\n\r\nexport const chapter1_4 = [\r\n  stage.curtain.down(),\r\n  scene.show('hostel', 'map01003'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '~'\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  scene.shake('hostel', scene.baseShake),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.show('sawa1', 'sawa_1'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa1'),\r\n  character.show('sawa2', 'sawa_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa2'),\r\n  character.show('sawa3', 'sawa_3'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('sawa3'),\r\n  character.show('sawa1', 'sawa_1'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa1'),\r\n  character.show('sawa2', 'sawa_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '~',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        'LOGO'\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.show('sawa4', 'sawa_4'),\r\n\r\n  dialog.show(\r\n    '~!T',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa4'),\r\n  character.show('sawa2', 'sawa_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.show('sawa2', 'sawa_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa2'),\r\n  character.show('sawa4', 'sawa_4'),\r\n\r\n  dialog.show(\r\n    'Sawa',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '267',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n\r\n  character.hide('sawa4'),\r\n  character.show('sawa2', 'sawa_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa2'),\r\n  character.show('sawa4', 'sawa_4'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n\r\n  character.hide('sawa4'),\r\n  character.show('sawa1', 'sawa_1'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa1'),\r\n  character.show('sawa2', 'sawa_2'),\r\n\r\n  dialog.show(\r\n    '~',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa2'),\r\n  character.show('sawa5', 'sawa_5'),\r\n\r\n  dialog.show(\r\n    '~',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa5'),\r\n  character.show('sawa4', 'sawa_4'),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      '~'\r\n    ],\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    'Sawa'\r\n  ),\r\n\r\n  character.hide('sawa4'),\r\n  character.show('sawa2', 'sawa_2'),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  dialog.hide(),\r\n  scene.hide('hostel'),\r\n  scene.show('room', 'map01011'),\r\n  stage.curtain.up(500),\r\n\r\n  dialog.show(\r\n    'View',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '~',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.show('sawa4', 'sawa_4'),\r\n\r\n  dialog.show(\r\n    '~',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa4'),\r\n  character.show('sawa2', 'sawa_2'),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa2'),\r\n  character.show('sawa4', 'sawa_4'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa4'),\r\n  character.show('sawa2', 'sawa_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    `[style={\"fill\": \"${color.tomato}\"}][/style]`,\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    `[style={\"fill\": \"${color.tomato}\"}][/style][style={\"fill\": \"${color.tomato}\"}][/style]`,\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      `[style={\"fill\": \"${color.tomato}\"}][/style]`\r\n    ],\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  dialog.hide(),\r\n  character.hide('sawa2'),\r\n  stage.curtain.up(500),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  flow.data((data, index) => {\r\n    data.room = index + 1\r\n  }),\r\n\r\n  dialog.show(\r\n    `[style={\"fill\": \"${color.tomato}\"}][/style]`,\r\n    '',\r\n    true\r\n  ),\r\n\r\n  choice.button(\r\n    {\r\n      id: 'door',\r\n      resource: 'map01011-0',\r\n      options: {\r\n        x: 188,\r\n        y: 107\r\n      }\r\n    },\r\n  ),\r\n\r\n  dialog.show(''),\r\n  choice.select(\r\n    [\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    [\r\n      (data, index) => {\r\n        return {\r\n          node: index + 1 + option11.length\r\n        }\r\n      },\r\n      (data, index) => {\r\n        return {\r\n          node: index + 1\r\n        }\r\n      },\r\n      data => {\r\n        return {\r\n          node: data.room\r\n        }\r\n      }\r\n    ]\r\n  ),\r\n\r\n  ...option11,\r\n\r\n  dialog.hide(),\r\n  stage.curtain.down(500),\r\n  scene.hide('room'),\r\n  scene.show('hostel', 'map01003'),\r\n  character.show('sawa2', 'sawa_2'),\r\n  stage.curtain.up(500),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa2'),\r\n  character.show('sawa4', 'sawa_4'),\r\n\r\n  dialog.show(\r\n    '~Sawa',\r\n    'Sawa'\r\n  ),\r\n\r\n  character.hide('sawa4'),\r\n  character.show('sawa2', 'sawa_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa2'),\r\n  character.show('sawa4', 'sawa_4'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa4'),\r\n  character.show('sawa2', 'sawa_2'),\r\n\r\n  dialog.show(\r\n    `[style={\"fill\": \"${color.tomato}\"}][/style][style={\"fill\": \"${color.tomato}\"}][/style][style={\"fill\": \"${color.tomato}\"}][/style]`,\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '~',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa2'),\r\n  character.show('sawa1', 'sawa_1'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      'Sawa',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa1'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  bgm.stop('shopping'),\r\n  stage.curtain.down(500),\r\n\r\n  flow.goto('chapter1_5')\r\n]\r\n","import { bgm, stage, dialog, choice, flow } from '../../api'\r\n\r\nconst seaside = [\r\n  bgm.stop('shopping'),\r\n  stage.curtain.down(500),\r\n  flow.goto(data => {\r\n    if (data.roadSign.seaside > 1) {\r\n      return {\r\n        chapter: 'chapter1_5_2end'\r\n      }\r\n    } else {\r\n      return {\r\n        chapter: 'chapter1_5_2'\r\n      }\r\n    }\r\n  })\r\n]\r\n\r\nconst shopping = [\r\n  dialog.show(''),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  flow.goto(data => {\r\n    return {\r\n      node: data.roadSign.index\r\n    }\r\n  })\r\n]\r\n\r\n// \r\nexport const east = [\r\n  choice.select(\r\n    [\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    [\r\n      (data, index) => {\r\n        data.roadSign.seaside++\r\n        return {\r\n          node: index + 1\r\n        }\r\n      },\r\n      (data, index) => {\r\n        data.roadSign.shopping++\r\n        return {\r\n          node: index + 1 + seaside.length\r\n        }\r\n      },\r\n      data => {\r\n        return {\r\n          node: data.roadSign.index\r\n        }\r\n      }\r\n    ]\r\n  ),\r\n\r\n  ...seaside,\r\n  ...shopping\r\n]\r\n","import { bgm, stage, choice, flow } from '../../api'\r\n\r\nconst common = [\r\n  bgm.stop('shopping'),\r\n  stage.curtain.down(500),\r\n]\r\n\r\nconst temple = [\r\n  ...common,\r\n\r\n  flow.goto(data => {\r\n    if (data.roadSign.temple > 1) {\r\n      return {\r\n        chapter: 'chapter1_5_3end'\r\n      }\r\n    } else {\r\n      return {\r\n        chapter: 'chapter1_5_3'\r\n      }\r\n    }\r\n  })\r\n]\r\n\r\nconst park = [\r\n  ...common,\r\n\r\n  flow.goto('chapter1_5_4')\r\n]\r\n\r\nconst hostel = [\r\n  ...common,\r\n  flow.goto(data => {\r\n    if (data.roadSign.temple > 0) {\r\n      // \r\n      return {\r\n        chapter: 'chapter1_6'\r\n      }\r\n    } else {\r\n      return {\r\n        chapter: 'chapter1_5_1'\r\n      }\r\n    }\r\n  })\r\n]\r\n\r\n// \r\nexport const west = [\r\n  choice.select(\r\n    [\r\n      '',\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    [\r\n      (data, index) => {\r\n        data.roadSign.temple++\r\n        return {\r\n          node: index + 1\r\n        }\r\n      },\r\n      (data, index) => {\r\n        data.roadSign.park++\r\n        return {\r\n          node: index + 1 + temple.length\r\n        }\r\n      },\r\n      (data, index) => {\r\n        data.roadSign.hostel++\r\n        return {\r\n          node: index + 1 + temple.length + park.length\r\n        }\r\n      },\r\n      data => {\r\n        return {\r\n          node: data.roadSign.index\r\n        }\r\n      }\r\n    ]\r\n  ),\r\n\r\n  ...temple,\r\n  ...park,\r\n  ...hostel\r\n]\r\n","import { bgm, stage, scene, dialog, choice, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\nimport { townStreet } from '../../common'\r\nimport { initRoadSignData } from '../../utils'\r\nimport { east } from './east'\r\nimport { west } from './west'\r\n\r\nexport const chapter1_5 = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  ...townStreet,\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n\r\n  flow.data((data, index) => {\r\n    if (data.roadSign.chapter !== 'chapter1_5') {\r\n      data.roadSign = initRoadSignData('chapter1_5', index + 1)\r\n    }\r\n  }),\r\n\r\n  dialog.hide(),\r\n  choice.button([\r\n    {\r\n      id: 'left',\r\n      resource: 'map01010a-0',\r\n      options: {\r\n        x: 32,\r\n        y: 134,\r\n        action: data => {\r\n          data.roadSign.target = 1\r\n        }\r\n      }\r\n    },\r\n    {\r\n      id: 'right',\r\n      resource: 'map01010a-1',\r\n      options: {\r\n        x: 253,\r\n        y: 168,\r\n        action: data => {\r\n          data.roadSign.target = 2\r\n        }\r\n      }\r\n    }\r\n  ]),\r\n\r\n  dialog.show(''),\r\n  flow.goto((data, index) => {\r\n    const roadSign = data.roadSign\r\n\r\n    if (roadSign.target === 1) {\r\n      return {\r\n        node: index + 1\r\n      }\r\n    } else {\r\n      return {\r\n        node: index + 1 + east.length\r\n      }\r\n    }\r\n  }),\r\n\r\n  ...east,\r\n  ...west\r\n]\r\n","import { bgm, stage, scene, dialog, character, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\n// \r\nexport const chapter1_5_1 = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  scene.show('hostel', 'map01003'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n\r\n  character.show('sawa2', 'sawa_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      'Sawa',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  bgm.stop('shopping'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter1_5')\r\n]\r\n","import { bgm, stage, scene, dialog, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\nconst commonStart = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  scene.show('seaside', 'map01001'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n]\r\n\r\nconst commonEnd = [\r\n  bgm.stop('shopping'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter1_5')\r\n]\r\n\r\n// \r\nexport const chapter1_5_2 = [\r\n  ...commonStart,\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '~'\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '~'\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '~',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  ...commonEnd\r\n]\r\n\r\nexport const chapter1_5_2end = [\r\n  ...commonStart,\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n\r\n  ...commonEnd\r\n]","import { bgm, stage, scene, dialog, character, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\nconst commonStart1 = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n]\r\nconst commonStart2 = [\r\n  stage.voiceover.show(\r\n      util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  scene.show('temple', 'map01004'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n]\r\n\r\nconst commonEnd = [\r\n  bgm.stop('shopping'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter1_5')\r\n]\r\n\r\n// \r\nexport const chapter1_5_3 = [\r\n  ...commonStart1,\r\n  \r\n  // NOTE: \r\n  stage.voiceover.show(\r\n    util.colorText('    ', color.burlywood),\r\n  ),\r\n\r\n  ...commonStart2,\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(''),\r\n\r\n  scene.shake('temple', scene.baseShake),\r\n\r\n  dialog.show(\r\n    '~',\r\n    ''\r\n  ),\r\n\r\n  character.show('xing_sha_1'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  ...commonEnd\r\n]\r\n\r\nexport const chapter1_5_3end = [\r\n  ...commonStart1,\r\n  ...commonStart2,\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      '~'\r\n    ],\r\n    ''\r\n  ),\r\n\r\n  ...commonEnd\r\n]","import { bgm, stage, scene, dialog, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\nconst commonStart = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  scene.show('park', 'map01008'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n]\r\n\r\nconst commonEnd = [\r\n  bgm.stop('shopping'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter1_5')\r\n]\r\n\r\n// \r\nexport const chapter1_5_4 = [\r\n  ...commonStart,\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  dialog.hide(),\r\n  scene.hide('park'),\r\n  scene.show('cg03001', 'map03001'),\r\n  stage.curtain.up(500),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  ...commonEnd\r\n]\r\n\r\n","import { bgm, stage, scene, dialog, character, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\nexport const chapter1_6 = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  scene.show('hostel', 'map01003'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n\r\n  character.show('sawa_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa_2'),\r\n  character.show('sawa_4'),\r\n\r\n  dialog.show(\r\n    '\\n~',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  dialog.hide(),\r\n  character.hide('sawa_4'),\r\n  scene.hide('hostel'),\r\n  scene.show('room', 'map01011'),\r\n  stage.curtain.up(500),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  bgm.stop('shopping'),\r\n\r\n  stage.curtain.down(500),\r\n  dialog.hide(),\r\n  scene.hide('room'),\r\n  scene.show('seaside_night', 'map01002'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('system_title', {\r\n    loop: true\r\n  }),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '~',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  dialog.hide(),\r\n  scene.hide('seaside_night'),\r\n  scene.show('room', 'map01011'),\r\n  stage.curtain.up(500),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        '',\r\n        '',\r\n        '',\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  bgm.stop('system_title'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter2_1')\r\n]\r\n","import { dialog, character, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\nexport const event0_1 = [\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  )\r\n]\r\n\r\nexport const event0_2 = [\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      'T',\r\n      color.lightskyblue\r\n    )\r\n  )\r\n]\r\n\r\nexport const event0_1next = [\r\n  character.hide('sawa_7'),\r\n  character.show('sawa_8'),\r\n\r\n  dialog.show(\r\n    'T',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '~',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      'Sawa',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('sawa_8'),\r\n  character.show('sawa_7')\r\n]\r\n\r\nexport const event0_2next = [\r\n  character.hide('sawa_7'),\r\n  character.show('sawa_8'),\r\n\r\n  dialog.show(\r\n    '~',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa_8'),\r\n  character.show('sawa_7'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa_7'),\r\n  character.show('sawa_8'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa_8'),\r\n  character.show('sawa_7'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      'Sawa',\r\n      color.lightskyblue\r\n    )\r\n  )\r\n]","import { bgm, stage, scene, dialog, character, choice, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\nimport { roomEvent } from '../../common'\r\nimport { event0_1, event0_2, event0_1next, event0_2next } from './event0'\r\n\r\nconst next = [\r\n  bgm.stop('shopping'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter2_2')\r\n]\r\n\r\nexport const chapter2_1 = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('    T', color.burlywood),\r\n  ),\r\n  stage.voiceover.hide(),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  dialog.hide(),\r\n  scene.hide('voiceover'),\r\n  scene.show('room', 'map01011'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n\r\n  dialog.show(\r\n    [\r\n      '~~~',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        'T'\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    'Sawa',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    [\r\n      'T',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      'T',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  choice.select(\r\n    [\r\n      'T',\r\n      ''\r\n    ],\r\n    [\r\n      (data, index) => {\r\n        data.eventSelected = data.eventSelected || {}\r\n        data.eventSelected['0'] = 0\r\n        return {\r\n          node: index + 1\r\n        }\r\n      },\r\n      (data, index) => {\r\n        data.eventSelected = data.eventSelected || {}\r\n        data.eventSelected['0'] = 1\r\n        return {\r\n          node: index + 2 + event0_1.length\r\n        }\r\n      },\r\n    ]\r\n  ),\r\n\r\n  ...event0_1,\r\n  flow.goto((data, index) => {\r\n    return {\r\n      node: index + 1 + event0_2.length\r\n    }\r\n  }),\r\n  ...event0_2,\r\n\r\n  dialog.show(\r\n    '~',\r\n    ''\r\n  ),\r\n\r\n  dialog.hide(),\r\n  flow.data(data => {\r\n    data.checked = false\r\n  }),\r\n  ...roomEvent(next.length, 0),\r\n\r\n  ...next,\r\n\r\n  flow.data(data => {\r\n    data.checked = true\r\n  }),\r\n  stage.curtain.down(500),\r\n  dialog.hide(),\r\n  scene.hide('room'),\r\n  scene.show('hostel', 'map01003'),\r\n  stage.curtain.up(500),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.show('sawa_6'),\r\n\r\n  dialog.show(\r\n    '~~',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    'SaSawa',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('sawa_6'),\r\n  character.show('sawa_7'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  flow.goto((data, index) => {\r\n    if (data.eventSelected['0'] === 0) {\r\n      return {\r\n        node: index + 1\r\n      }\r\n    } else {\r\n      return {\r\n        node: index + 1 + event0_1next.length\r\n      }\r\n    }\r\n  }),\r\n\r\n  ...event0_1next,\r\n  ...event0_2next,\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa_7'),\r\n  character.show('sawa_8'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa_8'),\r\n  character.show('sawa_6'),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa_6'),\r\n  character.show('sawa_7'),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      `[style={\"fill\": \"${color.tomato}\"}][/style][style={\"fill\": \"${color.tomato}\"}][/style][style={\"fill\": \"${color.tomato}\"}][/style]`\r\n    ],\r\n    'Sawa'\r\n  ),\r\n\r\n  character.hide('sawa_7'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      'Sawa',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  dialog.hide(),\r\n  stage.curtain.up(500),\r\n\r\n  dialog.show(\r\n    '10',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      `[style={\"fill\": \"${color.tomato}\"}][/style][style={\"fill\": \"${color.tomato}\"}][/style][style={\"fill\": \"${color.tomato}\"}][/style]`\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  ...next\r\n]\r\n","import { bgm, stage, dialog, choice, flow } from '../../api'\r\n\r\nconst seaside = [\r\n  bgm.stop('shopping'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter2_2_1')\r\n]\r\n\r\nconst shopping = [\r\n  dialog.show(\r\n    'Sawa',\r\n    ''\r\n  ),\r\n  flow.goto(data => {\r\n    return {\r\n      node: data.roadSign.index\r\n    }\r\n  })\r\n]\r\n\r\n// \r\nexport const east = [\r\n  choice.select(\r\n    [\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    [\r\n      (data, index) => {\r\n        data.roadSign.seaside++\r\n        return {\r\n          node: index + 1\r\n        }\r\n      },\r\n      (data, index) => {\r\n        data.roadSign.shopping++\r\n        return {\r\n          node: index + 1 + seaside.length\r\n        }\r\n      },\r\n      data => {\r\n        return {\r\n          node: data.roadSign.index\r\n        }\r\n      }\r\n    ]\r\n  ),\r\n\r\n  ...seaside,\r\n  ...shopping\r\n]\r\n","import { bgm, stage, choice, flow } from '../../api'\r\n\r\nconst common = [\r\n  bgm.stop('shopping'),\r\n  stage.curtain.down(500),\r\n]\r\n\r\nconst temple = [\r\n  ...common,\r\n\r\n  flow.goto(data => {\r\n    if (data.roadSign.temple > 1) {\r\n      return {\r\n        chapter: 'chapter2_2_3end'\r\n      }\r\n    } else {\r\n      return {\r\n        chapter: 'chapter2_2_3'\r\n      }\r\n    }\r\n  })\r\n]\r\n\r\nconst park = [\r\n  ...common,\r\n\r\n  flow.goto('chapter2_3')\r\n]\r\n\r\nconst hostel = [\r\n  ...common,\r\n  flow.goto(data => {\r\n    if (data.checked === true) {\r\n      return {\r\n        chapter: 'chapter2_2_5next'\r\n      }\r\n    } else {\r\n      return {\r\n        chapter: 'chapter2_2_5'\r\n      }\r\n    }\r\n  })\r\n]\r\n\r\n// \r\nexport const west = [\r\n  choice.select(\r\n    [\r\n      '',\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    [\r\n      (data, index) => {\r\n        data.roadSign.temple++\r\n        return {\r\n          node: index + 1\r\n        }\r\n      },\r\n      (data, index) => {\r\n        data.roadSign.park++\r\n        return {\r\n          node: index + 1 + temple.length\r\n        }\r\n      },\r\n      (data, index) => {\r\n        data.roadSign.hostel++\r\n        return {\r\n          node: index + 1 + temple.length + park.length\r\n        }\r\n      },\r\n      data => {\r\n        return {\r\n          node: data.roadSign.index\r\n        }\r\n      }\r\n    ]\r\n  ),\r\n\r\n  ...temple,\r\n  ...park,\r\n  ...hostel\r\n]\r\n","import { bgm, stage, scene, dialog, choice, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\nimport { townStreet } from '../../common'\r\nimport { initRoadSignData } from '../../utils'\r\nimport { east } from './east'\r\nimport { west } from './west'\r\n\r\nexport const chapter2_2 = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  ...townStreet,\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n\r\n  flow.data((data, index) => {\r\n    if (data.roadSign.chapter !== 'chapter2_2') {\r\n      data.roadSign = initRoadSignData('chapter2_2', index + 1)\r\n    }\r\n  }),\r\n\r\n  dialog.hide(),\r\n  choice.button([\r\n    {\r\n      id: 'left',\r\n      resource: 'map01010a-0',\r\n      options: {\r\n        x: 32,\r\n        y: 134,\r\n        action: data => {\r\n          data.roadSign.target = 1\r\n        }\r\n      }\r\n    },\r\n    {\r\n      id: 'right',\r\n      resource: 'map01010a-1',\r\n      options: {\r\n        x: 253,\r\n        y: 168,\r\n        action: data => {\r\n          data.roadSign.target = 2\r\n        }\r\n      }\r\n    }\r\n  ]),\r\n\r\n  dialog.show(''),\r\n  flow.goto((data, index) => {\r\n    const roadSign = data.roadSign\r\n\r\n    if (roadSign.target === 1) {\r\n      return {\r\n        node: index + 1\r\n      }\r\n    } else {\r\n      return {\r\n        node: index + 1 + east.length\r\n      }\r\n    }\r\n  }),\r\n\r\n  ...east,\r\n  ...west\r\n]","import { bgm, stage, scene, dialog, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\nconst commonStart = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  scene.show('seaside', 'map01001'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n]\r\n\r\nconst commonEnd = [\r\n  bgm.stop('shopping'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter2_2')\r\n]\r\n\r\n// \r\nexport const chapter2_2_1 = [\r\n  ...commonStart,\r\n\r\n  dialog.show(\r\n    '~',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  ...commonEnd\r\n]\r\n","import { bgm, stage, scene, dialog, character, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\nconst commonStart = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  scene.show('temple', 'map01004'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n]\r\n\r\nconst commonEnd = [\r\n  bgm.stop('shopping'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter2_2')\r\n]\r\n\r\n// \r\nexport const chapter2_2_3 = [\r\n  ...commonStart,\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.show('xing_sha_1'),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('xing_sha_1'),\r\n\r\n  dialog.show(\r\n    '~',\r\n    ''\r\n  ),\r\n\r\n  character.show('xing_sha_2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('xing_sha_2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  dialog.hide(),\r\n  scene.hide('temple'),\r\n  scene.show('seaside', 'map01001'),\r\n  stage.curtain.up(500),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        'TSawa'\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      'T',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  ...commonEnd\r\n]\r\n\r\nexport const chapter2_2_3end = [\r\n  ...commonStart,\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  dialog.hide(),\r\n  scene.hide('temple'),\r\n  scene.show('seaside', 'map01001'),\r\n  stage.curtain.up(500),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  ...commonEnd\r\n]\r\n","import { bgm, stage, scene, dialog, character, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\nimport { event0_1next, event0_2next } from '../chapter2-1/event0'\r\n\r\nconst commonStart = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  scene.show('hostel', 'map01003'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n]\r\n\r\nconst commonEnd = [\r\n  bgm.stop('shopping'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter2_2')\r\n]\r\n\r\n// \r\nexport const chapter2_2_5 = [\r\n  ...commonStart,\r\n\r\n  flow.data(data => {\r\n    data.checked = true\r\n  }),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.show('sawa_6'),\r\n\r\n  dialog.show(\r\n    '~~',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    'SaSawa',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('sawa_6'),\r\n  character.show('sawa_7'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  flow.goto((data, index) => {\r\n    if (data.eventSelected['0'] === 0) {\r\n      return {\r\n        node: index + 1\r\n      }\r\n    } else {\r\n      return {\r\n        node: index + 1 + event0_1next.length\r\n      }\r\n    }\r\n  }),\r\n\r\n  ...event0_1next,\r\n  ...event0_2next,\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa_7'),\r\n  character.show('sawa_8'),\r\n\r\n  dialog.show(\r\n    '',\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa_8'),\r\n  character.show('sawa_6'),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    'Sawa'\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('sawa_6'),\r\n  character.show('sawa_7'),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      `[style={\"fill\": \"${color.tomato}\"}][/style][style={\"fill\": \"${color.tomato}\"}][/style][style={\"fill\": \"${color.tomato}\"}][/style]`\r\n    ],\r\n    'Sawa'\r\n  ),\r\n\r\n  character.hide('sawa_7'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      'Sawa',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  dialog.hide(),\r\n  stage.curtain.up(500),\r\n\r\n  dialog.show(\r\n    '10',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      `[style={\"fill\": \"${color.tomato}\"}][/style][style={\"fill\": \"${color.tomato}\"}][/style][style={\"fill\": \"${color.tomato}\"}][/style]`\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  ...commonEnd\r\n]\r\n\r\nexport const chapter2_2_5next = [\r\n  ...commonStart,\r\n\r\n  dialog.show(\r\n    [\r\n      'Sawa',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n\r\n  ...commonEnd\r\n]\r\n\r\nexport const chapter2_2_5end = [\r\n  ...commonStart,\r\n\r\n  dialog.show(\r\n    [\r\n      'end',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n\r\n  ...commonEnd\r\n]","import { scene, dialog, character, choice, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\nfunction commomOptions(next1 = 0, next2 = 0, next3 = 0) {\r\n  return [\r\n    choice.select(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      [\r\n        (data, index) => {\r\n          return {\r\n            node: index + 1 + next1\r\n          }\r\n        },\r\n        (data, index) => {\r\n          return {\r\n            node: index + 1 + next2\r\n          }\r\n        },\r\n        (data, index) => {\r\n          return {\r\n            node: index + 1 + next3\r\n          }\r\n        }\r\n      ]\r\n    )\r\n  ]\r\n}\r\n\r\nconst attack1 = [\r\n  scene.shake('park', scene.baseShake),\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '584'\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  dialog.show(\r\n    '~',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('xing_nai_6'),\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  dialog.hide(),\r\n  character.hide('liu_man_2'),\r\n  flow.goto((data, index) => {\r\n    return {\r\n      node: index + 1 + defense1.length + run1.length\r\n    }\r\n  })\r\n]\r\n\r\nconst attack2 = [\r\n  scene.shake('park', scene.baseShake),\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        'MISS'\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  dialog.hide(),\r\n  character.hide('liu_man_2'),\r\n  flow.goto((data, index) => {\r\n    return {\r\n      node: index + 1 + defense2.length + run2.length\r\n    }\r\n  })\r\n]\r\n\r\nconst attack3 = [\r\n  scene.shake('park', scene.baseShake),\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  flow.goto((data, index) => {\r\n    return {\r\n      node: index + 1 + defense3.length + run3.length\r\n    }\r\n  })\r\n]\r\n\r\nconst defense1 = [\r\n  scene.shake('park', scene.baseShake),\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('liu_man_2'),\r\n  character.show('xing_nai_5'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_5'),\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  dialog.hide(),\r\n  character.hide('liu_man_2'),\r\n  flow.goto((data, index) => {\r\n    return {\r\n      node: index + 1 + run1.length\r\n    }\r\n  })\r\n]\r\n\r\nconst defense2 = [\r\n  scene.shake('park', scene.baseShake),\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        'MISS'\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  dialog.hide(),\r\n  character.hide('liu_man_2'),\r\n  flow.goto((data, index) => {\r\n    return {\r\n      node: index + 1 + run2.length\r\n    }\r\n  })\r\n]\r\n\r\nconst defense3 = [\r\n  scene.shake('park', scene.baseShake),\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        'MISS'\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  flow.goto((data, index) => {\r\n    return {\r\n      node: index + 1 + run3.length\r\n    }\r\n  })\r\n]\r\n\r\nconst run1 = [\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '327'\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('liu_man_2'),\r\n  character.show('xing_nai_2_1'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_2_1'),\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  dialog.hide(),\r\n  character.hide('liu_man_2')\r\n]\r\n\r\nconst run2 = [\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  dialog.hide(),\r\n  character.hide('liu_man_2')\r\n]\r\n\r\nconst run3 = [\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  )\r\n]\r\n\r\nexport const battle = [\r\n  ...commomOptions(\r\n    0,\r\n    attack1.length,\r\n    attack1.length + defense1.length\r\n  ),\r\n  ...attack1,\r\n  ...defense1,\r\n  ...run1,\r\n  ...commomOptions(\r\n    0,\r\n    attack2.length,\r\n    attack2.length + defense2.length\r\n  ),\r\n  ...attack2,\r\n  ...defense2,\r\n  ...run2,\r\n  ...commomOptions(\r\n    0,\r\n    attack3.length,\r\n    attack3.length + defense3.length\r\n  ),\r\n  ...attack3,\r\n  ...defense3,\r\n  ...run3,\r\n]\r\n","import { bgm, stage, scene, dialog, character, choice, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\nimport { battle } from './battle'\r\n\r\nexport const chapter2_3 = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show([\r\n    util.colorText('    ', color.burlywood),\r\n    util.colorText('', color.deepskyblue)\r\n  ]),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  scene.show('park', 'map01008'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('shopping', {\r\n    loop: true\r\n  }),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '~',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  bgm.stop('shopping'),\r\n  // stage.curtain.down(500),\r\n  // stage.curtain.up(500),\r\n  bgm.play('nerves', {\r\n    loop: true\r\n  }),\r\n\r\n  character.show('xing_nai_2_1'),\r\n\r\n  dialog.show(\r\n    '~',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_2_1'),\r\n  character.show('liu_man_1'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('liu_man_1'),\r\n  character.show('xing_nai_2_1'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_2_1'),\r\n  character.show('liu_man_1'),\r\n\r\n  dialog.show(\r\n    '~',\r\n    ''\r\n  ),\r\n\r\n  character.hide('liu_man_1'),\r\n  character.show('xing_nai_4'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('xing_nai_4'),\r\n  character.show('liu_man_1'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('liu_man_1'),\r\n  character.show('xing_nai_2_1'),\r\n\r\n  dialog.show(\r\n    '~',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_2_1'),\r\n  character.show('xing_nai_4'),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_4'),\r\n  character.show('liu_man_1'),\r\n\r\n  dialog.show(\r\n    '~',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  dialog.hide(),\r\n  character.hide('liu_man_1'),\r\n\r\n  choice.select(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    [\r\n      (data, index) => {\r\n        data.eventSelected = data.eventSelected || {}\r\n        data.eventSelected['1'] = 0\r\n        return {\r\n          node: index + 1\r\n        }\r\n      },\r\n      (data, index) => {\r\n        data.eventSelected = data.eventSelected || {}\r\n        data.eventSelected['1'] = 1\r\n        return {\r\n          node: index + 2\r\n        }\r\n      }\r\n    ]\r\n  ),\r\n\r\n  // event1 - 1\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n\r\n  // event1 - 2\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.show('xing_nai_3'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  dialog.hide(),\r\n  character.hide('xing_nai_3'),\r\n  bgm.stop('nerves'),\r\n  bgm.play('night', {\r\n    loop: true\r\n  }),\r\n\r\n  character.show('xing_nai_map_2'),\r\n  flow.waitClick(),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  bgm.stop('night'),\r\n  bgm.play('nerves', {\r\n    loop: true\r\n  }),\r\n\r\n  character.hide('xing_nai_map_2'),\r\n  character.show('xing_nai_2_1'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_2_1'),\r\n  character.show('liu_man_1'),\r\n\r\n  dialog.show(\r\n    '~~',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('liu_man_1'),\r\n  character.show('xing_nai_5'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_5'),\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('liu_man_2'),\r\n  character.show('xing_nai_5'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_5'),\r\n  character.show('liu_man_1'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('liu_man_1'),\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('liu_man_2'),\r\n  character.show('xing_nai_2_1'),\r\n\r\n  dialog.show(\r\n    '~~~',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_2_1'),\r\n  character.show('xing_nai_5'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('xing_nai_5'),\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.hide('liu_man_2'),\r\n  character.show('xing_nai_5'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_5'),\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    [\r\n      '',\r\n      ''\r\n    ],\r\n    ''\r\n  ),\r\n\r\n  dialog.hide(),\r\n  character.hide('liu_man_2'),\r\n\r\n  ...battle,\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('liu_man_2'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      [\r\n        '',\r\n        '',\r\n        '',\r\n        ''\r\n      ],\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  character.show('xing_nai_5'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_5'),\r\n  character.show('xing_nai_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_2'),\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  bgm.stop('nerves'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter2_4')\r\n]\r\n","import { bgm, stage, dialog, choice, flow } from '../../api'\r\n\r\nconst seaside = [\r\n  bgm.stop('nerves'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter2_4_1')\r\n]\r\n\r\nconst shopping = [\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  flow.goto(data => {\r\n    return {\r\n      node: data.roadSign.index\r\n    }\r\n  })\r\n]\r\n\r\n// \r\nexport const east = [\r\n  choice.select(\r\n    [\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    [\r\n      (data, index) => {\r\n        data.roadSign.seaside++\r\n        return {\r\n          node: index + 1\r\n        }\r\n      },\r\n      (data, index) => {\r\n        data.roadSign.shopping++\r\n        return {\r\n          node: index + 1 + seaside.length\r\n        }\r\n      },\r\n      data => {\r\n        return {\r\n          node: data.roadSign.index\r\n        }\r\n      }\r\n    ]\r\n  ),\r\n\r\n  ...seaside,\r\n  ...shopping\r\n]\r\n","import { bgm, stage, choice, flow } from '../../api'\r\n\r\nconst common = [\r\n  bgm.stop('nerves'),\r\n  stage.curtain.down(500),\r\n]\r\n\r\nconst temple = [\r\n  ...common,\r\n  flow.goto('chapter2_5')\r\n]\r\n\r\nconst park = [\r\n  ...common,\r\n  flow.goto('chapter2_4_4')\r\n]\r\n\r\nconst hostel = [\r\n  ...common,\r\n  flow.goto('chapter2_4_5')\r\n]\r\n\r\n// \r\nexport const west = [\r\n  choice.select(\r\n    [\r\n      '',\r\n      '',\r\n      '',\r\n      ''\r\n    ],\r\n    [\r\n      (data, index) => {\r\n        data.roadSign.temple++\r\n        return {\r\n          node: index + 1\r\n        }\r\n      },\r\n      (data, index) => {\r\n        data.roadSign.park++\r\n        return {\r\n          node: index + 1 + temple.length\r\n        }\r\n      },\r\n      (data, index) => {\r\n        data.roadSign.hostel++\r\n        return {\r\n          node: index + 1 + temple.length + park.length\r\n        }\r\n      },\r\n      data => {\r\n        return {\r\n          node: data.roadSign.index\r\n        }\r\n      }\r\n    ]\r\n  ),\r\n\r\n  ...temple,\r\n  ...park,\r\n  ...hostel\r\n]\r\n","import { bgm, stage, scene, dialog, character, choice, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\nimport { townStreet } from '../../common'\r\nimport { initRoadSignData } from '../../utils'\r\nimport { east } from './east'\r\nimport { west } from './west'\r\n\r\nconst firstEnter = [\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('liu_man_2'),\r\n  dialog.hide(),\r\n]\r\n\r\nexport const chapter2_4 = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  ...townStreet,\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('nerves', {\r\n    loop: true\r\n  }),\r\n\r\n  flow.goto((data, index) => {\r\n    if (data.roadSign.chapter === 'chapter2_4') {\r\n      return {\r\n        node: index + 1 + firstEnter.length\r\n      }\r\n    } else {\r\n      return {\r\n        node: index + 1\r\n      }\r\n    }\r\n  }),\r\n\r\n  ...firstEnter,\r\n\r\n  flow.data((data, index) => {\r\n    if (data.roadSign.chapter !== 'chapter2_4') {\r\n      data.roadSign = initRoadSignData('chapter2_4', index + 1)\r\n    }\r\n  }),\r\n\r\n  dialog.hide(),\r\n  choice.button([\r\n    {\r\n      id: 'left',\r\n      resource: 'map01010a-0',\r\n      options: {\r\n        x: 32,\r\n        y: 134,\r\n        action: data => {\r\n          data.roadSign.target = 1\r\n        }\r\n      }\r\n    },\r\n    {\r\n      id: 'right',\r\n      resource: 'map01010a-1',\r\n      options: {\r\n        x: 253,\r\n        y: 168,\r\n        action: data => {\r\n          data.roadSign.target = 2\r\n        }\r\n      }\r\n    }\r\n  ]),\r\n\r\n  dialog.show(''),\r\n  flow.goto((data, index) => {\r\n    const roadSign = data.roadSign\r\n\r\n    if (roadSign.target === 1) {\r\n      return {\r\n        node: index + 1\r\n      }\r\n    } else {\r\n      return {\r\n        node: index + 1 + east.length\r\n      }\r\n    }\r\n  }),\r\n\r\n  ...east,\r\n  ...west\r\n]","import { bgm, stage, scene, dialog, character, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\nconst commonStart = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  scene.show('seaside', 'map01001'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('nerves', {\r\n    loop: true\r\n  }),\r\n]\r\n\r\nconst commonEnd = [\r\n  bgm.stop('nerves'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter2_4')\r\n]\r\n\r\n// \r\nexport const chapter2_4_1 = [\r\n  ...commonStart,\r\n\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  ...commonEnd\r\n]\r\n","import { bgm, stage, scene, dialog, character, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\nconst commonStart = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  scene.show('park', 'map01008'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('nerves', {\r\n    loop: true\r\n  }),\r\n]\r\n\r\nconst commonEnd = [\r\n  bgm.stop('nerves'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter2_4')\r\n]\r\n\r\n// \r\nexport const chapter2_4_4 = [\r\n  ...commonStart,\r\n\r\n  character.show('liu_man_2'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('liu_man_2'),\r\n  character.show('xing_nai_5'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_5'),\r\n  character.show('xing_nai_7'),\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  character.hide('xing_nai_7'),\r\n\r\n  dialog.show(\r\n    util.colorText(\r\n      '',\r\n      color.lightskyblue\r\n    )\r\n  ),\r\n\r\n  ...commonEnd\r\n]\r\n\r\n","import { bgm, stage, scene, dialog, flow, util } from '../../api'\r\nimport { color } from '../../../config'\r\n\r\nconst commonStart = [\r\n  stage.curtain.down(),\r\n  scene.show('voiceover', 'voiceover'),\r\n  stage.curtain.up(500),\r\n\r\n  stage.voiceover.show(\r\n    util.colorText('', color.deepskyblue)\r\n  ),\r\n\r\n  stage.curtain.down(500),\r\n  stage.voiceover.hide(),\r\n  scene.hide('voiceover'),\r\n  scene.show('hostel', 'map01003'),\r\n  stage.curtain.up(500),\r\n\r\n  bgm.play('nerves', {\r\n    loop: true\r\n  }),\r\n]\r\n\r\nconst commonEnd = [\r\n  bgm.stop('nerves'),\r\n  stage.curtain.down(500),\r\n  flow.goto('chapter2_4')\r\n]\r\n\r\n// \r\nexport const chapter2_4_5 = [\r\n  ...commonStart,\r\n\r\n  dialog.show(\r\n    '',\r\n    ''\r\n  ),\r\n\r\n  ...commonEnd\r\n]\r\n","import * as chapter1 from './chapter1'\r\nimport * as chapter2 from './chapter2'\r\n\r\nexport default {\r\n  ...chapter1,\r\n  ...chapter2\r\n}\r\n","import { Scene } from '../../../engine/render'\r\nimport {\r\n  PIXIRenderSystem,\r\n  AnimationSystem,\r\n  TypewriterSystem,\r\n  TextButtonSystem,\r\n  TransformSystem,\r\n  TextUpdateSystem,\r\n  SoundSystem\r\n} from '../../../engine/systems'\r\nimport {\r\n  encryptByRabbit,\r\n  decryptByRabbit,\r\n  saveToLocalStorage,\r\n  loadFromLocalStorage\r\n} from '../../../engine/utils'\r\nimport {\r\n  InputSystem,\r\n  StorySystem,\r\n  RemoveSystem\r\n} from '../../systems'\r\nimport {\r\n  InputComponent,\r\n  // StoryComponent\r\n} from '../../components/singleton'\r\n\r\nimport story from '../../story'\r\n\r\nexport class Main {\r\n  constructor(game) {\r\n    this.game = game\r\n    this.world = null\r\n    this.view = null\r\n\r\n    this.init()\r\n  }\r\n\r\n  init() {\r\n    this._initWorldModule()\r\n    this._initData()\r\n    this.world.start()\r\n  }\r\n\r\n  saveArchive() {\r\n    const data = {\r\n      engine: this.world.serialize(),\r\n      system: this.world.systemData,\r\n      story: this.world.storyData\r\n    }\r\n\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.log('save data:', data)\r\n    }\r\n\r\n    saveToLocalStorage('data', encryptByRabbit(JSON.stringify(data)))\r\n  }\r\n\r\n  loadArchive() {\r\n    let data = loadFromLocalStorage('data', true)\r\n\r\n    if (data) {\r\n      data = JSON.parse(decryptByRabbit(data))\r\n\r\n      if (process.env.NODE_ENV === 'development') {\r\n        console.log('load data:', data)\r\n      }\r\n\r\n      const { engine, system, story } = data\r\n      this.world.deserialize(engine)\r\n      this.world.systemData = system\r\n      this.world.storyData = story\r\n    }\r\n  }\r\n\r\n  _initWorldModule() {\r\n    console.log(story)\r\n    this.world = new Scene()\r\n    this.world.interaction = this.game.renderer.plugins.interaction\r\n    this.world.storyScript = story\r\n    this.view = this.world.view\r\n    window.world = this.world\r\n\r\n    this.world\r\n      .registerSystem(InputSystem)\r\n      .registerSystem(StorySystem)\r\n      .registerSystem(TypewriterSystem)\r\n      .registerSystem(TextButtonSystem)\r\n      .registerSystem(AnimationSystem)\r\n      .registerSystem(TransformSystem)\r\n      .registerSystem(TextUpdateSystem)\r\n      .registerSystem(SoundSystem)\r\n      .registerSystem(RemoveSystem)\r\n      .registerSystem(PIXIRenderSystem)\r\n\r\n    this.world.singleton\r\n      .addComponent(InputComponent)\r\n      // .addComponent(StoryComponent, {\r\n      //   curChapter: 'chapter1',\r\n      // })\r\n  }\r\n\r\n  _initData() {\r\n    this.world.systemData = {\r\n      entities: {},\r\n      chapter: 'chapter1',\r\n      initialed: false,\r\n      nodeIndex: 0,\r\n      subIndex: 0\r\n    }\r\n    this.world.storyData = {}\r\n  }\r\n\r\n  update(delta) {\r\n    this.world.execute(delta)\r\n  }\r\n\r\n  stats(stats) {\r\n    stats.entity.update(this.world.stats().overview.numEntities, 30)\r\n  }\r\n}\r\n","import * as PIXI from 'pixi.js'\r\n\r\nexport class Cutscene{\r\n  constructor() {\r\n    this.view = new PIXI.Container()\r\n  }\r\n\r\n  update() {}\r\n}\r\n","import Stats from 'stats.js'\r\nimport { Signal } from 'signals'\r\n\r\nimport Loader from '../engine/loader'\r\nimport { Renderer } from '../engine/render'\r\nimport { InteractionManager } from '../engine/render/plugins'\r\nimport { Sound } from '../engine/sound'\r\n\r\nimport { gameInfo, assetRootUrl, assets } from './config'\r\nimport { CutsceneScene } from './scene'\r\n\r\nRenderer.registerPlugin('interaction', InteractionManager)\r\n\r\nclass Game {\r\n  constructor(title) {\r\n    this.title = title\r\n\r\n    this.scale = 1\r\n    this.renderer = null\r\n\r\n    this.loader = new Loader(assetRootUrl)\r\n\r\n    this.cutscenes = new CutsceneScene(this)\r\n\r\n    this.prevScene = null\r\n    this.curScene = null\r\n    this.show = null\r\n\r\n    this.isPlay = true\r\n    this.updated = new Signal()\r\n\r\n    this.stats = new Stats()\r\n    this.stats.added = false\r\n    this.stats.entity = this.stats.addPanel( new Stats.Panel( 'ENTITY', '#ff8', '#221' ) )\r\n    this.stats.showPanel(0) // 0: fps, 1: ms, 2: mb, 3+: custom\r\n\r\n    this.init()\r\n  }\r\n\r\n  init() {\r\n    if (process.env.NODE_ENV === 'development') {\r\n      this.addStats()\r\n    }\r\n    this._initSoundModule()\r\n    this._initRenderModule()\r\n  }\r\n\r\n  load() {\r\n    return this.loader.load(assets)\r\n  }\r\n\r\n  addStats() {\r\n    if (!this.stats.added) {\r\n      document.body.appendChild(this.stats.dom)\r\n      this.stats.added = true\r\n    }\r\n  }\r\n\r\n  removeStats() {\r\n    if (this.stats.added) {\r\n      document.body.removeChild(this.stats.dom)\r\n      this.stats.added = false\r\n    }\r\n  }\r\n\r\n  _initSoundModule() {\r\n    Sound.loadState()\r\n  }\r\n\r\n  _initRenderModule() {\r\n    const resolution = window.devicePixelRatio || 1\r\n    const width = gameInfo.width\r\n    const height = gameInfo.height\r\n\r\n    this.renderer = new Renderer({\r\n      width,\r\n      height,\r\n      resolution\r\n    })\r\n    window.renderer = this.renderer.renderer\r\n  }\r\n\r\n  to(sceneClass, callback) {\r\n    Sound.stopAll()\r\n    const scene = new sceneClass(this)\r\n    return this._cutscenesWait(scene, callback)\r\n  }\r\n\r\n  back(callback) {\r\n    if (this.prevScene) {\r\n      Sound.stopAll()\r\n      return this._cutscenesWait(this.prevScene, callback)\r\n    } else {\r\n      return Promise.resolve()\r\n    }\r\n  }\r\n\r\n  _cutscenesWait(scene, callback) {\r\n    this.updated.addOnce(() => {\r\n      this.show = this.cutscenes\r\n    })\r\n    const cutscenesWait = new Promise(resolve => {\r\n      if (scene.load) {\r\n        // \r\n        scene.load().then(() => {\r\n          callback && callback(scene)\r\n          resolve()\r\n        })\r\n      } else {\r\n        callback && callback(scene)\r\n        // \r\n        setTimeout(resolve, 150)\r\n      }\r\n    })\r\n    cutscenesWait.then(() => {\r\n      this.updated.addOnce(() => {\r\n        this._changeScene(scene)\r\n      })\r\n    })\r\n    return cutscenesWait\r\n  }\r\n\r\n  start(sceneClass) {\r\n    if (sceneClass) {\r\n      const scene = new sceneClass(this)\r\n      this._changeScene(scene)\r\n    }\r\n    requestAnimationFrame(this._update)\r\n  }\r\n\r\n  pause() {\r\n    this.isPlay = false\r\n  }\r\n\r\n  resume() {\r\n    this.isPlay = true\r\n  }\r\n\r\n  _changeScene(scene) {\r\n    this.prevScene = this.curScene\r\n    this.curScene = scene\r\n    this.show = scene\r\n    this._setSceneScale()\r\n  }\r\n\r\n  _update = delta => {\r\n    this.stats.begin()\r\n    if (this.show && this.isPlay) {\r\n      this.show.update && this.show.update(delta)\r\n      this.renderer.render(this.show.view)\r\n    }\r\n    this.updated.dispatch(this)\r\n    this.stats.end()\r\n    if (this.curScene.stats) {\r\n      this.curScene.stats(this.stats)\r\n    } else {\r\n      this.stats.entity.update(0, 30)\r\n    }\r\n    requestAnimationFrame(this._update)\r\n  }\r\n\r\n  saveArchive() {\r\n    return new Promise(resolve => {\r\n      this.updated.addOnce(() => {\r\n        if (this.curScene.saveArchive) {\r\n          this.curScene.saveArchive()\r\n        }\r\n        resolve()\r\n      })\r\n    })\r\n  }\r\n\r\n  loadArchive() {\r\n    return new Promise(resolve => {\r\n      this.updated.addOnce(() => {\r\n        if (this.curScene.loadArchive) {\r\n          this.curScene.loadArchive()\r\n        }\r\n        resolve()\r\n      })\r\n    })\r\n  }\r\n\r\n  resize = () => {\r\n    this._updateRenderScale()\r\n    this._setSceneScale()\r\n  }\r\n\r\n  _updateRenderScale() {\r\n    const windowWidth = window.innerWidth\r\n    const windowHeight = window.innerHeight\r\n\r\n    if (\r\n      windowWidth < gameInfo.width ||\r\n      windowHeight < gameInfo.height\r\n    ) {\r\n      this.scale = Math.min(\r\n        windowWidth / gameInfo.width,\r\n        windowHeight / gameInfo.height\r\n      )\r\n    }\r\n\r\n    console.log('renderScale: ', this.scale)\r\n    this.renderer.resize(\r\n      gameInfo.width * this.scale,\r\n      gameInfo.height * this.scale\r\n    )\r\n  }\r\n\r\n  _setSceneScale() {\r\n    if (this.show) {\r\n      this.show.view.scale.set(this.scale)\r\n    }\r\n  }\r\n}\r\n\r\nconst game = new Game('love-memory')\r\nwindow.love_memory = game\r\n\r\nexport default game\r\n","import React from 'react'\r\nimport './index.css'\r\n\r\nimport Loader from '../loader'\r\nimport MenuIcon from '../menu-icon'\r\nimport MenuLayout from '../menu-layout'\r\nimport Config from '../config'\r\nimport About from '../about'\r\n\r\nimport SaveDialog from '../dialog/save'\r\nimport WarningDialog from '../dialog/warning'\r\nimport '../dialog/index.css'\r\n\r\nimport game from '../../game'\r\nimport { TitleScene, MainScene } from '../../game/scene'\r\n\r\nclass LoveMemory extends React.Component {\r\n  constructor() {\r\n    super()\r\n    this.loadError = false\r\n    this.loader = React.createRef()\r\n    this.canvas = React.createRef()\r\n    this.state = {\r\n      show: 0, // 1 | 3: Config menu, 2: About menu\r\n      menu: false, // is show menu switch\r\n      loader: {\r\n        loading: true,\r\n        progress: 0,\r\n        error: null\r\n      },\r\n      width: 0,\r\n      height: 0,\r\n      dialog: 0, // 1: save dialog, 2: warning dialog\r\n      dialogStatus: ''\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.resize()\r\n    this.addEvents()\r\n    game.load().then(\r\n      () => {\r\n        //  loading \r\n        setTimeout(() => {\r\n          this.setState({\r\n            loader: {\r\n              ...this.state.loader,\r\n              loading: false\r\n            }\r\n          }, () => {\r\n            // show\r\n            game.start(TitleScene)\r\n            game.renderer.view.style.opacity = 1\r\n          })\r\n        }, 1000)\r\n      },\r\n      error => {\r\n        console.warn(error)\r\n        this.loadError = true\r\n        this.loader.current.detailsHandle()\r\n        this.setState({\r\n          loader: {\r\n            ...this.state.loader,\r\n            error\r\n          }\r\n        })\r\n      }\r\n    )\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.removeEvents()\r\n  }\r\n\r\n  addEvents() {\r\n    this.canvas.current.appendChild(game.renderer.view)\r\n\r\n    window.addEventListener('resize', this.resize)\r\n\r\n    game.loader.onProgressed.add(this.progressHandle)\r\n\r\n    TitleScene.onStartClicked.add(this.clickStartHandle)\r\n    TitleScene.onLoadClicked.add(this.clickLoadHandle)\r\n    TitleScene.onSettingClicked.add(this.clickSettingHandle)\r\n    TitleScene.onAboutClicked.add(this.clickAboutHandle)\r\n  }\r\n\r\n  removeEvents() {\r\n    this.canvas.current.removeChild(game.renderer.view)\r\n\r\n    window.removeEventListener('resize', this.resize)\r\n\r\n    game.loader.onProgressed.remove(this.progressHandle)\r\n\r\n    TitleScene.onStartClicked.remove(this.clickStartHandle)\r\n    TitleScene.onLoadClicked.remove(this.clickLoadHandle)\r\n    TitleScene.onSettingClicked.remove(this.clickSettingHandle)\r\n    TitleScene.onAboutClicked.remove(this.clickAboutHandle)\r\n  }\r\n\r\n  resize = () => {\r\n    game.resize()\r\n    this.setState({\r\n      width: game.renderer.view.style.width,\r\n      height: game.renderer.view.style.height\r\n    })\r\n  }\r\n\r\n  progressHandle = (progress) => {\r\n    if (this.loadError) {\r\n      return\r\n    }\r\n    progress = Math.ceil(progress)\r\n    const prevProgress = this.state.loader.progress\r\n    const offset = progress - prevProgress\r\n\r\n    if (offset >= 20 || progress >= 100) {\r\n      this.setState({\r\n        loader: {\r\n          ...this.state.loader,\r\n          progress\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  clickStartHandle = () => {\r\n    game.to(MainScene).then(() => {\r\n      this.setState({\r\n        menu: true\r\n      })\r\n    })\r\n  }\r\n\r\n  clickLoadHandle = () => {\r\n    game\r\n      .to(MainScene, scene => {\r\n        scene.loadArchive()\r\n      })\r\n      .then(() => {\r\n        this.setState({\r\n          menu: true\r\n        })\r\n      })\r\n  }\r\n\r\n  clickSettingHandle = () => {\r\n    this.setState({\r\n      show: 1\r\n    })\r\n  }\r\n\r\n  clickAboutHandle = () => {\r\n    this.setState({\r\n      show: 2\r\n    })\r\n  }\r\n\r\n  openMenuHandle = () => {\r\n    this.setState({\r\n      show: 3\r\n    })\r\n  }\r\n\r\n  closeMenuHandle = () => {\r\n    this.setState({\r\n      show: 0\r\n    })\r\n  }\r\n\r\n  togglePanelHandle = () => {\r\n    const added = game.stats.added\r\n    if (added) {\r\n      game.removeStats()\r\n    } else {\r\n      game.addStats()\r\n    }\r\n  }\r\n\r\n  closeDialogHandle = () => {\r\n    this.setState({\r\n      dialog: 0,\r\n      dialogStatus: ''\r\n    })\r\n  }\r\n\r\n  openSaveDialogHandle = () => {\r\n    this.setState({\r\n      dialog: 1,\r\n      dialogStatus: 'saving'\r\n    })\r\n    this.saveArchive()\r\n  }\r\n\r\n  openLoadDialogHandle = () => {\r\n    this.setState({\r\n      dialog: 2,\r\n      dialogStatus: 'load'\r\n    })\r\n  }\r\n\r\n  openBackTitleDialogHandle = () => {\r\n    this.setState({\r\n      dialog: 2,\r\n      dialogStatus: 'back'\r\n    })\r\n  }\r\n\r\n  confirmWarnHandle = () => {\r\n    const { dialogStatus } = this.state\r\n\r\n    if (dialogStatus === 'back') {\r\n      this.backTitle()\r\n    } else if (dialogStatus === 'load') {\r\n      this.loadArchive()\r\n    }\r\n  }\r\n\r\n  saveArchive() {\r\n    game.saveArchive().then(() => {\r\n      setTimeout(() => {\r\n        this.setState({\r\n          dialogStatus: 'saved'\r\n        })\r\n      }, 500)\r\n    })\r\n  }\r\n\r\n  loadArchive() {\r\n    game.loadArchive().then(() => {\r\n      this.closeDialogHandle()\r\n      //  dialog  200ms  200ms\r\n      setTimeout(() => {\r\n        this.setState({\r\n          show: 0\r\n        })\r\n      }, 200)\r\n    })\r\n  }\r\n\r\n  getArchive = () => {\r\n  }\r\n\r\n  backTitle() {\r\n    game.to(TitleScene).then(() => {\r\n      this.closeDialogHandle()\r\n      //  dialog  200ms  200ms\r\n      setTimeout(() => {\r\n        this.setState({\r\n          show: 0,\r\n          menu: false\r\n        })\r\n      }, 200)\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { show, menu, width, height, loader } = this.state\r\n    const style = {\r\n      width,\r\n      height\r\n    }\r\n\r\n    if (show > 0) {\r\n      game.pause()\r\n    } else if (game.isPlay === false) {\r\n      game.resume()\r\n    }\r\n\r\n    return (\r\n      <>\r\n        <div className=\"love-memory\" style={style}>\r\n          <Loader ref={this.loader} loader={loader} />\r\n          {menu && (\r\n            <div className=\"menu-icon-wrapper\">\r\n              <MenuIcon onClick={this.openMenuHandle} />\r\n            </div>\r\n          )}\r\n          <MenuLayout show={show} onClose={this.closeMenuHandle}>\r\n            {(show === 1 || show === 3) && (\r\n              <Config\r\n                show={show}\r\n                onPanel={this.togglePanelHandle}\r\n                onSave={this.openSaveDialogHandle}\r\n                onLoad={this.openLoadDialogHandle}\r\n                onBack={this.openBackTitleDialogHandle}\r\n                getArchive={this.getArchive}\r\n              />\r\n            )}\r\n            {show === 2 && <About />}\r\n          </MenuLayout>\r\n          <div ref={this.canvas}></div>\r\n        </div>\r\n        <SaveDialog\r\n          isOpen={this.state.dialog === 1}\r\n          status={this.state.dialogStatus}\r\n          onClose={this.closeDialogHandle}\r\n        />\r\n        <WarningDialog\r\n          isOpen={this.state.dialog === 2}\r\n          onConfirm={this.confirmWarnHandle}\r\n          onClose={this.closeDialogHandle}\r\n        />\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default LoveMemory\r\n"],"sourceRoot":""}