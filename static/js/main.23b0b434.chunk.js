(this["webpackJsonplove-memory"]=this["webpackJsonplove-memory"]||[]).push([[0],{143:function(e,t,n){e.exports=n(281)},148:function(e,t,n){},149:function(e,t,n){},150:function(e,t,n){},151:function(e,t,n){},152:function(e,t,n){},153:function(e,t,n){},154:function(e,t,n){},166:function(e,t){},168:function(e,t){},179:function(e,t){},181:function(e,t){},207:function(e,t){},209:function(e,t){},210:function(e,t){},216:function(e,t){},218:function(e,t){},236:function(e,t){},239:function(e,t){},255:function(e,t){},258:function(e,t){},266:function(e,t,n){},276:function(e,t,n){},279:function(e,t,n){},280:function(e,t,n){},281:function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"xing_nai_1",(function(){return Zt})),n.d(i,"xing_nai_map_1",(function(){return Kt}));var a=n(1),o=n.n(a),s=n(81),r=n.n(s),l=n(14),u=n(5),c=n(6),h=n(9),d=n(8),v=(n(148),n(149),function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).detailsHandle=function(){e.setState({show:!e.state.show})},e.state={show:!1},e}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.loader,t=e.loading,n=e.progress,i=e.error,a="loader";return this.state.show&&(a+=" open"),o.a.createElement("div",{className:"loader-wrapper",style:{display:t?"block":"none"}},o.a.createElement("div",{className:"loader-container"},o.a.createElement("div",{className:a},o.a.createElement("em",{style:{width:"".concat(n,"%")}}),o.a.createElement("div",{className:"details-panel"},o.a.createElement("p",null,o.a.createElement("strong",null,"Progress:")," ",o.a.createElement("font",null,"".concat(n,"%"))),i&&o.a.createElement("p",null,o.a.createElement("strong",null,"Error:")," ",o.a.createElement("font",{style:{color:"red"}},"resource loading failed.")))),o.a.createElement("div",{className:"details button",onClick:this.detailsHandle},"Details")))}}]),n}(o.a.Component));n(150);var p=function(e){return o.a.createElement("div",{className:"menu-icon",onClick:function(t){e.onClick&&e.onClick(t)}},o.a.createElement("div",{className:"top bar"}),o.a.createElement("div",{className:"middle bar"}),o.a.createElement("div",{className:"bottom bar"}))},f=(n(151),n(61));var m=function(){return o.a.createElement("div",{className:"menu-title"},o.a.createElement("h1",null,"\u6e5b\u84dd\u56de\u5fc6",o.a.createElement("p",{className:"menu-subtitle"},o.a.createElement("span",null,"\u604b\u7231\u7269\u8bed"),o.a.createElement("span",{className:"menu-version"},"ver: ".concat(f.a)))),o.a.createElement("h2",null,"Love Memory"))};var y=function(e){var t={display:e.show>0?"block":"none"};return o.a.createElement("div",{className:"menu-wrapper",style:t},o.a.createElement("div",{className:"menu-container"},o.a.createElement(m,null),o.a.createElement("div",{className:"menu-content"},e.children),o.a.createElement("div",{className:"close",onClick:e.onClose})))};n(152);var g=function(e){return o.a.createElement("div",{className:"config-item"},o.a.createElement("div",{className:"config-name"},e.name),o.a.createElement("div",{className:"config-content"},e.children))};n(153);var b=function(e){return o.a.createElement("div",{className:"hexagon-button"},o.a.createElement("div",{onClick:function(t){e.onClick&&e.onClick(t)}},o.a.createElement("span",null,e.children)))};n(154);var w=function(e){var t=e.checked,n=e.onChange;return o.a.createElement("div",{className:"switch-button"},o.a.createElement("input",{className:"switch-button-checkbox",type:"checkbox",checked:t,onChange:function(e){var t=e.target;n&&n(t.checked)}}),o.a.createElement("div",{className:"switch-button-handle"}),o.a.createElement("label",{className:"switch-button-label"},"\u5f00"),o.a.createElement("label",{className:"switch-button-label"},"\u5173"))},x=n(141),k=n(53),E={position:"relative",width:"100%",touchAction:"none"};var C=function(e){var t=e.value,n=void 0===t?80:t,i=e.onChange,a=[0,100];return o.a.createElement(k.c,{mode:1,step:1,domain:a,rootStyle:E,onChange:function(e){i&&i(e[0])},values:[n]},o.a.createElement(k.b,null,(function(e){var t=e.getRailProps;return o.a.createElement(S,{getRailProps:t})})),o.a.createElement(k.a,null,(function(e){var t=e.handles,n=e.getHandleProps;return o.a.createElement("div",{className:"slider-handles"},t.map((function(e){return o.a.createElement(_,{key:e.id,handle:e,domain:a,getHandleProps:n})})))})),o.a.createElement(k.d,{right:!1},(function(e){var t=e.tracks,n=e.getTrackProps;return o.a.createElement("div",{className:"slider-tracks"},t.map((function(e){var t=e.id,i=e.source,a=e.target;return o.a.createElement(T,{key:t,source:i,target:a,getTrackProps:n})})))})))},O={position:"absolute",width:"100%",height:42,transform:"translate(0%, -50%)",borderRadius:7,cursor:"pointer"},j={position:"absolute",width:"100%",height:14,transform:"translate(0%, -50%)",borderRadius:7,pointerEvents:"none",backgroundColor:"rgb(155,155,155)"},S=function(e){var t=e.getRailProps;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",Object.assign({style:O},t())),o.a.createElement("div",{style:j}))},_=function(e){var t=Object(x.a)(e.domain,2),n=t[0],i=t[1],a=e.handle,s=a.id,r=a.value,l=a.percent,u=e.disabled,c=void 0!==u&&u,h=e.getHandleProps;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",Object.assign({style:{left:"".concat(l,"%"),position:"absolute",transform:"translate(-50%, -50%)",WebkitTapHighlightColor:"rgba(0,0,0,0)",zIndex:5,width:28,height:42,cursor:"pointer",backgroundColor:"none"}},h(s))),o.a.createElement("div",{role:"slider","aria-valuemin":n,"aria-valuemax":i,"aria-valuenow":r,style:{left:"".concat(l,"%"),position:"absolute",transform:"translate(-50%, -50%)",zIndex:2,width:24,height:24,borderRadius:"50%",boxShadow:"1px 1px 1px 1px rgba(0, 0, 0, 0.3)",backgroundColor:c?"#666":"#9BBFD4"}}))},T=function(e){var t=e.source,n=e.target,i=e.getTrackProps,a=e.disabled,s=void 0!==a&&a;return o.a.createElement("div",Object.assign({style:{position:"absolute",transform:"translate(0%, -50%)",height:14,zIndex:1,backgroundColor:s?"#999":"#607E9E",borderRadius:7,cursor:"pointer",left:"".concat(t.percent,"%"),width:"".concat(n.percent-t.percent,"%")}},i()))},P=n(29),I=(n(83),n(84)),M=n.n(I);M.a.parse("JQfTTft92kQ4").toString();var D=function(){function e(t){Object(u.a)(this,e),this.alias=t,this.sound=void 0,this.sound=P.a.find(t)}return Object(c.a)(e,null,[{key:"play",value:function(e,t){P.a.play(e,t)}},{key:"stop",value:function(e){P.a.stop(e)}},{key:"stopAll",value:function(){P.a.stopAll()}},{key:"mute",value:function(){this.muted=!0,P.a.muteAll()}},{key:"unmute",value:function(){this.muted=!1,P.a.unmuteAll()}},{key:"saveState",value:function(){var e,t,n={muted:this.muted,volume:this.volume};e="sound",t=JSON.stringify(n),localStorage.setItem(e,t)}},{key:"loadState",value:function(){var e=JSON.parse(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=localStorage.getItem(e);return n||!1!==t||console.warn('No data with the key value "'.concat(e,'" in localStorage.')),n}("sound",!0));e?(this.muted=e.muted,this.volume=e.volume,!0===this.muted&&this.mute()):this.volume=.8}},{key:"volume",set:function(e){P.a.volumeAll=e},get:function(){return P.a.volumeAll}}]),Object(c.a)(e,[{key:"play",value:function(e){this.sound.play(e)}},{key:"stop",value:function(){this.sound.stop()}},{key:"isPlaying",get:function(){return this.sound.isPlaying}}]),e}();D.muted=!1;var A=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).switchHandle=function(t){t?D.unmute():D.mute(),D.saveState(),e.setState({checked:t})},e.volumeHandle=function(e){D.volume=e/100,D.saveState()},e.exportHandle=function(){var t=e.data.current,n=e.props.getArchive()||"";t.value=n},e.selectAllHandle=function(){e.data.current.select()},e.data=o.a.createRef(),e.state={checked:!1},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.setState({checked:!D.muted,volume:D.volume})}},{key:"render",value:function(){return o.a.createElement("div",{className:"game-config"},o.a.createElement("section",null,o.a.createElement("h3",{className:"game-config-title"},"\u7cfb\u7edf"),o.a.createElement(g,{name:"\u58f0\u97f3"},o.a.createElement(w,{checked:this.state.checked,onChange:this.switchHandle})),o.a.createElement(g,{name:"\u97f3\u91cf"},o.a.createElement(C,{value:100*D.volume,onChange:this.volumeHandle})),o.a.createElement(b,{onClick:this.props.onPanel},"on/off",o.a.createElement("br",null),"\u72b6\u6001\u9762\u677f"),3===this.props.show&&o.a.createElement(o.a.Fragment,null,o.a.createElement(b,{onClick:this.props.onSave},"\u5b58\u50a8\u8fdb\u5ea6"),o.a.createElement(b,{onClick:this.props.onLoad},"\u8bfb\u53d6\u8fdb\u5ea6"),o.a.createElement(b,{onClick:this.props.onBreak},"\u8fd4\u56de\u6807\u9898"))),o.a.createElement("section",null,o.a.createElement("h3",{className:"game-config-title"},"\u6570\u636e"),o.a.createElement("textarea",{className:"game-input-data",ref:this.data}),o.a.createElement("div",{className:"game-data-options"},o.a.createElement("button",{onClick:this.exportHandle},"\u5bfc\u51fa"),o.a.createElement("button",{onClick:this.selectAllHandle},"\u5168\u9009"),o.a.createElement("button",null,"\u5bfc\u5165"))))}}]),n}(o.a.PureComponent);n(266);var L=function(e){var t=e.item,n=t.title,i=t.url,a=t.content;return o.a.createElement("div",{className:"about-item"},o.a.createElement("a",{href:i,target:"_blank",rel:"noopener noreferrer"},o.a.createElement("p",{className:"about-item-title"},n),i&&o.a.createElement("p",{className:"about-item-content"},i),a&&o.a.createElement("p",{className:"about-item-content"},a)))},N=480,H=576,z=[{title:"\u5f53\u524d\u7248\u672c",content:f.a},{title:"Blog",url:"https://xxxxxxxxx.net/"},{title:"Email",url:"/"},{title:"Github",url:"https://github.com/LuckyRabbitFeet"},{title:"Bug\u53cd\u9988",url:"xxxxxxxxxxx"},{title:"License",content:"MIT"}],B=["assets/fonts/SourceHanSansSC-Regular.woff","assets/fonts/SourceHanSansSC-Bold.woff","assets/images/map01.json","assets/images/map02.json","assets/images/map03.json","assets/images/system/title_gold.json","assets/images/system/system.json","assets/images/file/1001.json","assets/images/file/1002.json","assets/images/file/1003.json","assets/images/file/1004.json","assets/images/file/1005.json","assets/images/file/1006.json","assets/images/file/1007.json","assets/images/file/1008-1010.json","assets/images/file/2001.json","assets/images/file/2002-2004.json","assets/images/file/3001.json","assets/images/file/3002.json","assets/images/file/3003-3005.json","assets/images/file/4001.json","assets/images/file/4002.json",{name:"funny",url:"assets/sound/funny.mp3",onComplete:q},{name:"happy",url:"assets/sound/happy.mp3",onComplete:q},{name:"hope",url:"assets/sound/hope.mp3",onComplete:q},{name:"memory",url:"assets/sound/memory.mp3",onComplete:q},{name:"nerves",url:"assets/sound/nerves.mp3",onComplete:q},{name:"night",url:"assets/sound/night.mp3",onComplete:q},{name:"romantix",url:"assets/sound/romantix.mp3",onComplete:q},{name:"sad",url:"assets/sound/sad.mp3",onComplete:q},{name:"shopping",url:"assets/sound/shopping.mp3",onComplete:q},{name:"system_over",url:"assets/sound/system_over.mp3",onComplete:q},{name:"system_title",url:"assets/sound/system_title.mp3",onComplete:q}];function q(e){e.sound.singleInstance=!0}var R={fontFamily:["Source Han Sans SC","Arial","sans-serif"],fontWeight:"bold",fontSize:20,lineJoin:"round",fill:"#ffffff",stroke:"#000000",strokeThickness:3},F=Object(l.a)(Object(l.a)({},R),{},{fontSize:22,fill:"#6D8CD4",stroke:"#ffffff"}),J=R,U=R,W=R,V={id:"name_frame",height:44,padding:0},Q={id:"speak_frame",height:126,padding:12},Y={"1001_b":{res:"1001_b",layer:1,x:110,y:288},"1002_b":{res:"1002_b",layer:1,x:107,y:294},"1003_b":"1003_b","2001_b":"2001_b","3001_b":"3001_b","3002_b":"3002_b","4001_b":"4001_b",map02001:{res:"map02001",layer:1,x:48,y:0},map02002:"map02002",map02003:"map02003"},X={"1001_ha":{res:"1001_ha",layer:0,x:102,y:342},"1002_ha":{res:"1002_ha",layer:0,x:290,y:358}},G="#87cefa",Z="#deb887",K="#00bfff";var $=function(){return o.a.createElement("div",{className:"game-about"},z.map((function(e){return o.a.createElement(L,{key:e.title,item:e})})))},ee=n(62),te=n.n(ee);var ne=function(e){var t=e.isOpen,n=e.onClose,i=e.status;return o.a.createElement(te.a,{isOpen:t,closeTimeoutMS:200,ariaHideApp:!1,contentLabel:"save dialog",style:{overlay:{display:"flex",justifyContent:"center",alignItems:"center",zIndex:6,backgroundColor:null}},className:"dialog"},o.a.createElement("div",{className:"dialog-container"},o.a.createElement("div",{className:"dialog-content"},o.a.createElement("div",{className:"dialog-icon"},"saved"===i?o.a.createElement("div",{className:"sa-success"},o.a.createElement("div",{className:"sa-success-tip"}),o.a.createElement("div",{className:"sa-success-long"}),o.a.createElement("div",{className:"sa-success-placeholder"}),o.a.createElement("div",{className:"sa-success-fix"})):o.a.createElement("div",{className:"spinner-box"},o.a.createElement("div",{className:"circle-border"},o.a.createElement("div",{className:"circle-core"})))),o.a.createElement("div",{className:"dialog-text"},"saved"===i?"Saved success.":"Saving...")),o.a.createElement("div",{className:"dialog-interaction"},o.a.createElement("div",{className:"dialog-button",style:{margin:"saved"===i?0:-55}},o.a.createElement("button",{onClick:function(e){n&&n(e)}},"OK")))))};var ie=function(e){var t=e.isOpen,n=e.onConfirm,i=e.onClose;return o.a.createElement(te.a,{isOpen:t,closeTimeoutMS:200,ariaHideApp:!1,contentLabel:"warning dialog",style:{overlay:{display:"flex",justifyContent:"center",alignItems:"center",zIndex:6,backgroundColor:null}},className:"dialog"},o.a.createElement("div",{className:"dialog-container"},o.a.createElement("div",{className:"dialog-content"},o.a.createElement("div",{className:"dialog-icon"},o.a.createElement("div",{className:"sa-warning"},o.a.createElement("span",{className:"sa-warning-body"}),o.a.createElement("span",{className:"sa-warning-dot"}))),o.a.createElement("div",{className:"dialog-text",style:{lineHeight:1.2,textAlign:"left",paddingTop:5,paddingLeft:80}},"\u672a\u4fdd\u5b58\u7684\u6570\u636e\u5c06\u4f1a\u4e22\u5931\uff0c\u662f\u5426\u7ee7\u7eed\uff1f")),o.a.createElement("div",{className:"dialog-interaction"},o.a.createElement("div",{className:"dialog-button",style:{margin:0}},o.a.createElement("button",{className:"dialog-button-yes",onClick:function(e){n&&n(e)}},"Yes"),o.a.createElement("button",{className:"dialog-button-no",onClick:function(e){i&&i(e)}},"No")))))},ae=(n(276),n(85)),oe=n.n(ae),se=n(24),re=n(13),le=function(){function e(t,n){Object(u.a)(this,e),this.source=void 0,this.loaded=void 0,this.assets=void 0,this.onProgressed=void 0,this.onCompleted=void 0,this.source=new re.c(t,n),this.loaded=!1,this.onProgressed=new se.Signal,this.onCompleted=new se.Signal}return Object(c.a)(e,[{key:"load",value:function(e){var t=this;return!0===this.loaded?Promise.resolve(this.source.resources):(this.assets=e,this.source.add(e).on("progress",this._onProgress.bind(this)).on("complete",this._onComplete.bind(this)),new Promise((function(e,n){t.source.on("error",t._onError(n)).load(t._onLoad(e))})))}},{key:"_onProgress",value:function(e,t){this.onProgressed.dispatch(e.progress,t)}},{key:"_onComplete",value:function(e,t){this.onCompleted.dispatch(e.progress,t)}},{key:"_onError",value:function(e){var t=this;return function(n){t.source.reset(),e(n)}}},{key:"_onLoad",value:function(e){var t=this;return function(n,i){t.loaded=!0,e(i)}}}]),e}(),ue=function(){function e(t){for(var n in Object(u.a)(this,e),this.renderer=void 0,this.plugins=void 0,t=Object(l.a)({antialias:!0},t),this.renderer=re.h(t),this.plugins={},e.plugins)this.plugins[n]=new e.plugins[n](this.renderer,t);this.renderer.plugins.interaction.autoPreventDefault=!1,this.renderer.view.style.touchAction="auto"}return Object(c.a)(e,[{key:"render",value:function(e){this.renderer.render(e)}},{key:"resize",value:function(e,t){this.renderer.autoDensity=!0,this.renderer.resize(e,t)}},{key:"view",get:function(){return this.renderer.view}}],[{key:"registerPlugin",value:function(e,t){this.plugins[e]=t}}]),e}();ue.plugins={};var ce=n(17),he=function(){function e(t){Object(u.a)(this,e),this.ObjectClass=t,this.freed=[],this.capacity=100,this.size=0}return Object(c.a)(e,null,[{key:"of",value:function(t){var n=this.pools.get(t);return void 0===n&&this.pools.set(t,n=new e(t)),n}},{key:"free",value:function(e){var t=this.pools.get(e);t&&(t.clear(),this.pools.delete(e))}}]),Object(c.a)(e,[{key:"acquire",value:function(){return this.freed.length<=0&&this.expand(),this.freed.pop()}},{key:"release",value:function(e){this.freed.push(e)}},{key:"clear",value:function(){this.freed.length=0}},{key:"expand",value:function(){for(var e=Math.round(.2*this.capacity),t=0;t<e;t++){var n=new this.ObjectClass;this.freed.push(n)}this.size+=e,this.size>=this.capacity&&(this.capacity+=this.size)}},{key:"totalSize",value:function(){return this.size}},{key:"totalFree",value:function(){return this.freed.length}},{key:"totalUsed",value:function(){return this.size-this.freed.length}}]),e}();function de(e){return function(t){return ve._componentClassMap.has(e)?console.warn("Component id: '".concat(e,"' already registered.")):(t._id=e,t._isRegister=!0,ve._componentClassMap.set(e,t),ve._pools.has(e)||ve._pools.set(e,he.of(t))),t}}he.pools=new WeakMap;var ve=function(){function e(){Object(u.a)(this,e),this.entity=null}return Object(c.a)(e,[{key:"init",value:function(){}},{key:"clear",value:function(){}},{key:"_setProps",value:function(e){for(var t in e)"undefined"!==typeof e[t]&&(this[t]=e[t])}},{key:"toJSON",value:function(){return{}}}],[{key:"create",value:function(e,t,n){var i=this._pools.get(t._id).acquire();return i.entity=e,n&&i._setProps(n),i.init(),this.onComponentCreated.dispatch({componentClass:t,component:i,entity:e}),i}},{key:"destory",value:function(e,t){var n=this._pools.get(e._id);this.onComponentDestroyed.dispatch({componentClass:e,component:t,entity:t.entity}),t.clear(),t.entity=null,n.release(t)}},{key:"poolStats",value:function(){var e={};return this._pools.forEach((function(t,n){e[n]={size:t.totalSize(),free:t.totalFree(),used:t.totalUsed()}})),e}}]),e}();ve.onComponentCreated=new se.Signal,ve.onComponentDestroyed=new se.Signal,ve._id=void 0,ve._isRegister=!1,ve._isComponent=!0,ve._componentClassMap=new Map,ve._pools=new Map;var pe="undefined"!==typeof window&&"undefined"!==typeof window.performance?performance.now.bind(performance):Date.now.bind(Date),fe=function(){function e(){Object(u.a)(this,e),this.id=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}(),this.alias=void 0,this.isSingleton=!1,this._world=void 0,this._components=new Map,this.onComponentChanged=void 0}return Object(c.a)(e,[{key:"_destory",value:function(){this.alias=void 0,this._world=void 0,this.onComponentChanged=void 0,this.removeAllComponent()}},{key:"verifyComponent",value:function(e){if(!e._isComponent||!e._isRegister)throw new Error("The Component does not meet specifications.\n"+"Entity: ".concat(this.alias||this.id," Component: ").concat(e._id||e.name));return!this.hasComponent(e)||(console.warn("Component already exists on entity.\n"+"Entity: ".concat(this.alias||this.id," Component: ").concat(e._id)),!1)}},{key:"hasComponent",value:function(e){return this._components.has(e)}},{key:"hasAllComponent",value:function(e){var t,n=Object(ce.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!this.hasComponent(i))return!1}}catch(a){n.e(a)}finally{n.f()}return!0}},{key:"hasAnyComponent",value:function(e){var t,n=Object(ce.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(this.hasComponent(i))return!0}}catch(a){n.e(a)}finally{n.f()}return!1}},{key:"getComponent",value:function(e){return this._components.has(e)?this._components.get(e):(console.warn("getComponent: Component not found.\n"+"Component: ".concat(e)),{})}},{key:"addComponent",value:function(e,t){if(!this.verifyComponent(e))return this;var n=ve.create(this,e,t);return this._components.set(e,n),this.onComponentChanged&&this.onComponentChanged(this),this}},{key:"removeComponent",value:function(e){if(this._components.has(e)){var t=this._components.get(e);ve.destory(e,t),this._components.delete(e),this.onComponentChanged&&this.onComponentChanged(this)}return this}},{key:"removeAllComponent",value:function(){var e=this;return this._components.forEach((function(t,n){ve.destory(n,t),e._components.delete(n)})),this.onComponentChanged&&this.onComponentChanged(this),this}},{key:"toJSON",value:function(){var e=[];return this._components.forEach((function(t,n){e.push({class:n._id,content:t})})),{id:this.id,alias:this.alias,isSingleton:this.isSingleton,components:e}}},{key:"fromJSON",value:function(e){var t=ve._componentClassMap;this.id=e.id,this.alias=e.alias,this.isSingleton=e.isSingleton;var n,i=e.components,a=Object(ce.a)(i);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=o.class,r=o.content;if(t.has(s)){var l=t.get(s);this.addComponent(l,r)}else console.warn("Cannot find component with id '".concat(s,"'."))}}catch(u){a.e(u)}finally{a.f()}}}],[{key:"create",value:function(e,t){var n=this._pool.acquire();return n._world=e,t&&(n.alias=t),n}},{key:"destory",value:function(e){if(e.isSingleton)throw new Error("Cannot destroy singleton entities.");e._destory(),this._pool.release(e)}},{key:"singleton",value:function(t){var n=new e;return n._world=t,n.alias="singleton components",n.isSingleton=!0,n}},{key:"poolStats",value:function(){return{size:this._pool.totalSize(),free:this._pool.totalFree(),used:this._pool.totalUsed()}}}]),e}();fe._pool=he.of(fe);var me=function(){function e(t,n){if(Object(u.a)(this,e),this.queryComponents=t,this.matchType=n,this.entities=[],this.key=null,0===t.length)throw new Error('Can\'t create a query without "components" on System.')}return Object(c.a)(e,[{key:"match",value:function(e){return"all"===this.matchType?this.matchAll(e):"any"===this.matchType&&this.matchAny(e)}},{key:"matchAll",value:function(e){return e.hasAllComponent(this.queryComponents)}},{key:"matchAny",value:function(e){return e.hasAnyComponent(this.queryComponents)}},{key:"getEntity",value:function(){return this.entities}},{key:"addEntity",value:function(e){-1===this.entities.indexOf(e)&&this.entities.push(e)}},{key:"removeEntity",value:function(e){var t=this.entities.indexOf(e);-1!==t&&this.entities.splice(t,1)}},{key:"stats",value:function(){var e=this.queryComponents.map((function(e){return e._id}));return{matchType:this.matchType,numQueryComponents:this.queryComponents.length,numEntities:this.entities.length,queryComponents:e}}}]),e}(),ye=function(){function e(){Object(u.a)(this,e),this.queries=new Map}return Object(c.a)(e,[{key:"createQuery",value:function(e,t){var n=t+e.map((function(e){return e._id})).join("-");if(this.queries.has(n))return this.queries.get(n);var i=new me(e,t);return i.key=n,this.queries.set(n,i),i}},{key:"onEntityRemoved",value:function(e){this.queries.forEach((function(t){t.removeEntity(e)}))}},{key:"onEntityComponentChanged",value:function(e){this.queries.forEach((function(t){t.match(e)?t.addEntity(e):t.removeEntity(e)}))}},{key:"stats",value:function(){var e=[];return this.queries.forEach((function(t){e.push(t.stats())})),{numQueries:e.length,queries:e}}}]),e}(),ge=function(){function e(t){Object(u.a)(this,e),this.world=t,this.entities=new Map,this.numEntities=0,this.entityQuery=new ye,this.entitiesWithComponentChanged=new Set}return Object(c.a)(e,[{key:"createEntity",value:function(e){var t=this.initEntity(e);return this.pushEntity(t),t}},{key:"initEntity",value:function(e){var t=this,n=fe.create(this.world,e);return n.onComponentChanged=function(e){t.entitiesWithComponentChanged.add(e)},n}},{key:"pushEntity",value:function(e){this.numEntities++,this.entities.set(e.id,e)}},{key:"removeEntity",value:function(e){this.entityQuery.onEntityRemoved(e),this.numEntities--,this.entities.delete(e.id),fe.destory(e)}},{key:"hasEntity",value:function(e){return this.entities.has(e.id)}},{key:"getEntity",value:function(e){return this.entities.get(e)}},{key:"clear",value:function(){var e=this;this.entities.forEach((function(t){e.removeEntity(t)}))}},{key:"createQuery",value:function(e,t){return this.entityQuery.createQuery(e,t)}},{key:"updateEntityQuery",value:function(){var e=this;this.entitiesWithComponentChanged.forEach((function(t){e.entityQuery.onEntityComponentChanged(t)})),this.entitiesWithComponentChanged.clear()}},{key:"toJSON",value:function(){var e=[];return this.entities.forEach((function(t){e.push(t)})),e}},{key:"fromJSON",value:function(e){var t,n=Object(ce.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this.initEntity();a.fromJSON(i),this.pushEntity(a)}}catch(o){n.e(o)}finally{n.f()}}},{key:"stats",value:function(){var e=this.entityQuery.stats();return{numEntities:this.numEntities,numQueries:e.numQueries,queries:e.queries}}}]),e}(),be=3,we=function(){function e(){Object(u.a)(this,e),this.world=null,this.queries={},this._priority=-1,this._executeTime=0}return Object(c.a)(e,[{key:"init",value:function(){}},{key:"execute",value:function(e,t){}}]),e}();we.isSystem=!0,we.queries=void 0;var xe=function(){function e(t,n){Object(u.a)(this,e),this.world=t,this.entityManager=n,this.systems=[]}return Object(c.a)(e,[{key:"_injectQuery",value:function(e,t){var n=e.queries;if(n)for(var i in n)if(Array.isArray(n[i])){var a=this.entityManager.createQuery(n[i],"all");t.queries[i]={results:a.getEntity()}}else{var o=n[i],s=o.type,r=void 0===s?"all":s,l=o.components;if("all"!==r&&"any"!==r&&Array.isArray(l))continue;var u=this.entityManager.createQuery(l,r);t.queries[i]={results:u.getEntity()}}}},{key:"_pushSystem",value:function(e){var t=this.systems.length;if(t>0){if(e._priority<this.systems[0]._priority)return void this.systems.unshift(e);if(e._priority>=this.systems[t-1]._priority)return void this.systems.push(e)}for(var n=0;n<t;n++)if(e._priority<this.systems[n]._priority)return void this.systems.splice(n,0,e);this.systems.push(e)}},{key:"registerSystem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be;if(!e.isSystem)throw new Error('System "'.concat(e.name,'" must extend "System" class.'));if(this.isRegisterSystem(e))console.warn('System "'.concat(e.name,'" already registered.'));else{var n=new e;n._priority=t,n.world=this.world,this._injectQuery(e,n),this._pushSystem(n),n.init()}}},{key:"isRegisterSystem",value:function(e){return-1!==this.systems.findIndex((function(t){return t instanceof e}))}},{key:"execute",value:function(e,t){var n=this;this.systems.forEach((function(i){var a=pe();i.execute(e,t),n.entityManager.updateEntityQuery(),i._executeTime=pe()-a}))}},{key:"stats",value:function(){return{numSystems:this.systems.length,executeTime:this.systems.map((function(e){return{name:e.constructor.name,executeTime:e._executeTime}}))}}}]),e}(),ke=function(){function e(){Object(u.a)(this,e),this.entityManager=new ge(this),this.systemManager=new xe(this,this.entityManager),this.singleton=fe.singleton(this),this.enabled=!1,this.lastTimestamp=0}return Object(c.a)(e,[{key:"registerSystem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be;return this.systemManager.registerSystem(e,t),this}},{key:"createEntity",value:function(e){return this.entityManager.createEntity(e)}},{key:"removeEntity",value:function(e){this.entityManager.removeEntity(e)}},{key:"removeAllEntity",value:function(){this.entityManager.clear()}},{key:"hasEntity",value:function(e){return this.entityManager.hasEntity(e)}},{key:"getEntity",value:function(e){return this.entityManager.getEntity(e)}},{key:"mandatoryUpdateEntityQuery",value:function(){this.entityManager.updateEntityQuery()}},{key:"execute",value:function(e){"undefined"===typeof e&&(e=pe());var t=0;0!==this.lastTimestamp&&(t=e-this.lastTimestamp),this.lastTimestamp=e,this.enabled&&this.systemManager.execute(t,e)}},{key:"start",value:function(){this.enabled=!0,this.lastTimestamp=0}},{key:"stop",value:function(){this.enabled=!1}},{key:"clear",value:function(){this.entityManager.clear(),this.singleton.removeAllComponent()}},{key:"serialize",value:function(){return JSON.stringify({entity:this.entityManager,singleton:this.singleton})}},{key:"deserialize",value:function(e){this.clear();var t=JSON.parse(e);this.entityManager.fromJSON(t.entity),this.singleton.fromJSON(t.singleton)}},{key:"stats",value:function(){var e=this.entityManager.stats(),t=e.numEntities,n=e.numQueries,i=e.queries,a=this.systemManager.stats();return{overview:{numEntities:t,numSystems:a.numSystems,numQueries:n},systems:a.executeTime,queries:i,pool:{entity:fe.poolStats(),component:ve.poolStats()}}}}]),e}();n(27);var Ee=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(u.a)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).numLayer=0,e.layerMap=new Map,e}return Object(c.a)(n,[{key:"_addLayer",value:function(e,t,n){n?this.addChildAt(e,n):this.addChild(e),this.layerMap.set(t,e),this.numLayer++}},{key:"createLayer",value:function(e,t){var n=new re.b;this._addLayer(n,e,t)}},{key:"createParticleLayer",value:function(e,t){var n=new re.d;this._addLayer(n,e,t)}},{key:"hasLayer",value:function(e){return this.layerMap.has(e)}},{key:"getLayer",value:function(e){return this.layerMap.has(e)||console.warn('There is no layer whose id is "'.concat(e,'".')),this.layerMap.get(e)}},{key:"removeLayer",value:function(e){if(this.layerMap.has(e)){var t=this.layerMap.get(e);this.removeChild(t),this.numLayer--}else console.warn('There is no layer whose id is "'.concat(e,'".'))}},{key:"clearLayer",value:function(){this.layerMap.forEach((function(e){e.removeChildren(0)}))}}]),n}(re.b),Ce=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(u.a)(this,n),(e=t.call(this)).view=void 0,e.view=new Ee;for(var i=0;i<=10;i++)e.addLayer("UserLayer".concat(i));return e}return Object(c.a)(n,[{key:"addLayer",value:function(e,t){this.view.createLayer(e,t)}},{key:"addParticleLayer",value:function(e,t){this.view.createParticleLayer(e,t)}},{key:"hasLayer",value:function(e){return this.view.hasLayer(e)}},{key:"getLayer",value:function(e){return this.view.getLayer(e)}},{key:"removeLayer",value:function(e){this.view.removeLayer(e)}},{key:"addSprite",value:function(e,t){var n=this.getLayer(e);null===n||void 0===n||n.addChild(t)}},{key:"removeSprite",value:function(e,t){var n=this.getLayer(e);null===n||void 0===n||n.removeChild(t)}}]),n}(ke),Oe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;Object(u.a)(this,e),this.x=void 0,this.y=void 0,this.x=t,this.y=n}return Object(c.a)(e,[{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;this.x=e,this.y=t}}]),e}(),je=function(){function e(){Object(u.a)(this,e),this.global=void 0,this.originalEvent=void 0,this.isDown=void 0,this.identifier=void 0,this.isPrimary=void 0,this.button=void 0,this.buttons=void 0,this.width=void 0,this.height=void 0,this.tiltX=void 0,this.tiltY=void 0,this.pointerType=void 0,this.pressure=void 0,this.rotationAngle=void 0,this.twist=void 0,this.tangentialPressure=void 0,this.global=new Oe,this.originalEvent=null,this.isDown=!1,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object(c.a)(e,[{key:"copyEvent",value:function(e){"isPrimary"in e&&e.isPrimary&&(this.isPrimary=!0),this.button="button"in e&&e.button;var t="buttons"in e&&e.buttons;this.buttons=Number.isInteger(t)?t:"which"in e&&e.which,this.width="width"in e&&e.width,this.height="height"in e&&e.height,this.tiltX="tiltX"in e&&e.tiltX,this.tiltY="tiltY"in e&&e.tiltY,this.pointerType="pointerType"in e&&e.pointerType,this.pressure="pressure"in e&&e.pressure,this.rotationAngle="rotationAngle"in e&&e.rotationAngle,this.twist="twist"in e&&e.twist||0,this.tangentialPressure="tangentialPressure"in e&&e.tangentialPressure||0}},{key:"reset",value:function(){this.isPrimary=!1}},{key:"pointerId",get:function(){return this.identifier}}]),e}(),Se=function(){function e(t){Object(u.a)(this,e),this.supportsTouchEvents=void 0,this.supportsPointerEvents=void 0,this.renderer=void 0,this.mouse=void 0,this.resolution=void 0,this.interactionDOMElement=void 0,this.eventsAdded=void 0,this.renderer=t,this.mouse=new je,this.mouse.identifier=1,this.mouse.global.set(-1),this.interactionDOMElement=null,this.eventsAdded=!1,this.supportsTouchEvents="ontouchstart"in window,this.supportsPointerEvents=!!window.PointerEvent,this.resolution=1,this.onPointerUp=this.onPointerUp.bind(this),this.onPointerCancel=this.onPointerCancel.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerOut=this.onPointerOut.bind(this),this.onPointerOver=this.onPointerOver.bind(this),this.setTargetElement(this.renderer.view,this.renderer.resolution)}return Object(c.a)(e,[{key:"setTargetElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.removeEvents(),this.interactionDOMElement=e,this.resolution=t,this.addEvents()}},{key:"addEvents",value:function(){if(!this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none");var t=this.interactionDOMElement;this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),t.addEventListener("pointerdown",this.onPointerDown,!0),t.addEventListener("pointerleave",this.onPointerOut,!0),t.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),t.addEventListener("mousedown",this.onPointerDown,!0),t.addEventListener("mouseout",this.onPointerOut,!0),t.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(t.addEventListener("touchstart",this.onPointerDown,!0),t.addEventListener("touchcancel",this.onPointerCancel,!0),t.addEventListener("touchend",this.onPointerUp,!0),t.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0}}},{key:"removeEvents",value:function(){if(this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction="");var t=this.interactionDOMElement;this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),t.removeEventListener("pointerdown",this.onPointerDown,!0),t.removeEventListener("pointerleave",this.onPointerOut,!0),t.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),t.removeEventListener("mousedown",this.onPointerDown,!0),t.removeEventListener("mouseout",this.onPointerOut,!0),t.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(t.removeEventListener("touchstart",this.onPointerDown,!0),t.removeEventListener("touchcancel",this.onPointerCancel,!0),t.removeEventListener("touchend",this.onPointerUp,!0),t.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1}}},{key:"mapPositionToPoint",value:function(e,t){var n,i=new Oe(0);n=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var a=1/this.resolution;return i.x=(e-n.left)*(this.interactionDOMElement.width/n.width)*a,i.y=(t-n.top)*(this.interactionDOMElement.height/n.height)*a,i}},{key:"processInteractive",value:function(e,t){var n=this.getInteractionData(e);n.isDown="boolean"===typeof t?t:this.mouse.isDown,this.configureInteractionDataForDOMEvent(e,n),this.mouse=n}},{key:"onPointerDown",value:function(e){if(!this.supportsTouchEvents||"touch"!==e.pointerType){var t=this.normalizeToPointerData(e)[0];this.processInteractive(t,!0)}}},{key:"onPointerComplete",value:function(e){var t=this.normalizeToPointerData(e)[0];this.processInteractive(t,!1)}},{key:"onPointerCancel",value:function(e){this.supportsTouchEvents&&"touch"===e.pointerType||this.onPointerComplete(e)}},{key:"onPointerUp",value:function(e){this.supportsTouchEvents&&"touch"===e.pointerType||this.onPointerComplete(e)}},{key:"onPointerMove",value:function(e){if(!this.supportsTouchEvents||"touch"!==e.pointerType){var t=this.normalizeToPointerData(e)[0];this.processInteractive(t)}}},{key:"onPointerOut",value:function(e){if(!this.supportsTouchEvents||"touch"!==e.pointerType){var t=this.normalizeToPointerData(e)[0];this.processInteractive(t)}}},{key:"onPointerOver",value:function(e){var t=this.normalizeToPointerData(e)[0];this.processInteractive(t)}},{key:"getInteractionData",value:function(e){var t=e.pointerId,n=new je;return n.identifier=t,n.copyEvent(e),n}},{key:"configureInteractionDataForDOMEvent",value:function(e,t){t.global=this.mapPositionToPoint(e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=t.global.x,e.globalY=t.global.y),t.originalEvent=e}},{key:"normalizeToPointerData",value:function(e){var t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var n=0,i=e.changedTouches.length;n<i;n++){var a=e.changedTouches[n];"undefined"===typeof a.button&&(a.button=e.touches.length?1:0),"undefined"===typeof a.buttons&&(a.buttons=e.touches.length?1:0),"undefined"===typeof a.isPrimary&&(a.isPrimary=1===e.touches.length&&"touchstart"===e.type),"undefined"===typeof a.width&&(a.width=a.radiusX||1),"undefined"===typeof a.height&&(a.height=a.radiusY||1),"undefined"===typeof a.tiltX&&(a.tiltX=0),"undefined"===typeof a.tiltY&&(a.tiltY=0),"undefined"===typeof a.pointerType&&(a.pointerType="touch"),"undefined"===typeof a.pointerId&&(a.pointerId=a.identifier||0),"undefined"===typeof a.pressure&&(a.pressure=a.force||.5),"undefined"===typeof a.twist&&(a.twist=0),"undefined"===typeof a.tangentialPressure&&(a.tangentialPressure=0),"undefined"===typeof a.layerX&&(a.layerX=a.offsetX=a.clientX),"undefined"===typeof a.layerY&&(a.layerY=a.offsetY=a.clientY),a.isNormalized=!0,t.push(a)}else if(!(e instanceof MouseEvent)||this.supportsPointerEvents&&e instanceof window.PointerEvent)t.push(e);else{var o=e;"undefined"===typeof o.isPrimary&&(o.isPrimary=!0),"undefined"===typeof o.width&&(o.width=1),"undefined"===typeof o.height&&(o.height=1),"undefined"===typeof o.tiltX&&(o.tiltX=0),"undefined"===typeof o.tiltY&&(o.tiltY=0),"undefined"===typeof o.pointerType&&(o.pointerType="mouse"),"undefined"===typeof o.pointerId&&(o.pointerId=1),"undefined"===typeof o.pressure&&(o.pressure=.5),"undefined"===typeof o.twist&&(o.twist=0),"undefined"===typeof o.tangentialPressure&&(o.tangentialPressure=0),o.isNormalized=!0,t.push(o)}return t}},{key:"destroy",value:function(){this.removeEvents(),this.renderer=null,this.mouse=null,this.interactionDOMElement=null,this.onPointerDown=null,this.onPointerUp=null,this.onPointerCancel=null,this.onPointerMove=null,this.onPointerOut=null,this.onPointerOver=null}}]),e}(),_e=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,i,a,o){var s;return Object(u.a)(this,n),(s=t.call(this,e)).x=Math.random()*(i+o)-o/2,s.y=Math.random()*(a+o)-o/2,s.z=.5*Math.random()+.3,s.vx=(1*Math.random()+1)*s.z,s.vy=(.5*Math.random()+1)*s.z,s.rotation=Math.random()*Math.PI*2,s.anchor.set(.5),s.spin=s.rotation>Math.PI?1:-1,s}return n}(re.e),Te=function(){function e(t){var n=t.width,i=t.height,a=t.amount,o=t.maxDist,s=t.parent,r=t.textureId;Object(u.a)(this,e),this.width=n,this.height=i,this.amount=a,this.maxDist=o,this.parent=s,this.textureId=r,this.flowerArr=[],this.init()}return Object(c.a)(e,[{key:"init",value:function(){for(var e=this.width,t=this.height,n=this.amount,i=this.maxDist,a=this.parent,o=0;o<n;o++){var s=re.g.from("title_gold-".concat(this.textureId)),r=new _e(s,e,t,i);this.flowerArr.push(r),a.addChild(r)}}},{key:"update",value:function(e){var t=this.width,n=this.height,i=this.maxDist;e.rotation+=.003*e.spin,e.x+=e.vx,e.y+=e.vy,e.x>t+i/2?e.x=-i/2:e.xpos<-i/2&&(e.x=t+i/2),e.y>n+i/2?e.y=-i/2:e.y<-i/2&&(e.y=n+i/2)}},{key:"tick",value:function(){var e=this;this.flowerArr.forEach((function(t){e.update(t)}))}}]),e}(),Pe=F,Ie="#ffffff",Me="#F9B541",De=function(){function e(){Object(u.a)(this,e),this.view=new re.b,this.init()}return Object(c.a)(e,[{key:"init",value:function(){this._bgmPlay(),this._addBackground(),this._addPtcLayer(),this._addMenu()}},{key:"_addBackground",value:function(){var e=re.e.from("title_background");this.view.addChild(e)}},{key:"_addPtcLayer",value:function(){this.ptcLayer=new re.b,this.view.addChild(this.ptcLayer),this.flowerFly=[];for(var e=0;e<5;e++){var t=5;2===e&&(t=2),this.flowerFly.push(new Te({width:N,height:H,amount:t,maxDist:100,parent:this.ptcLayer,textureId:e}))}}},{key:"_addMenu",value:function(){var t=this,n=new re.b;n.x=365,n.y=380;var i=this._createButton(0,"\u5f00\u59cb\u6e38\u620f",(function(){t._bgmStop(),e.onStartClicked.dispatch()})),a=this._createButton(1,"\u7ee7\u7eed\u6e38\u620f",(function(){t._bgmStop(),e.onLoadClicked.dispatch()})),o=this._createButton(2,"\u7cfb\u7edf\u8bbe\u7f6e",(function(){e.onSettingClicked.dispatch()})),s=this._createButton(3,"\u5173\u4e8e\u6e38\u620f",(function(){e.onAboutClicked.dispatch()}));n.addChild(i,a,o,s),this.view.addChild(n)}},{key:"_bgmPlay",value:function(){D.play("system_title",{loop:!0})}},{key:"_bgmStop",value:function(){D.stop("system_title")}},{key:"_createButton",value:function(e,t,n){var i=new re.f(t,Pe);return i.y=30*e,i.interactive=!0,i.buttonMode=!0,i.resolution=2,i.anchor.set(.5),i.on("pointerdown",Ae).on("pointerup",Le).on("pointerupoutside",Le).on("pointerover",Ne).on("pointerout",He).on("pointertap",(function(e){e.data.originalEvent.preventDefault(),n()})),i}},{key:"update",value:function(){this.flowerFly.forEach((function(e){e.tick()}))}}]),e}();function Ae(){this.isdown=!0,this.scale.set(.95)}function Le(){this.isOver?(this.style.fill=Ie,this.style.stroke=Me):(this.style.fill=Pe.fill,this.style.stroke=Pe.stroke),this.isdown&&(this.isdown=!1,this.scale.set(1))}function Ne(){this.isOver=!0,this.isdown||(this.style.fill=Ie,this.style.stroke=Me)}function He(){this.isOver=!1,this.isdown||(this.style.fill=Pe.fill,this.style.stroke=Pe.stroke)}De.onStartClicked=new se.Signal,De.onLoadClicked=new se.Signal,De.onSettingClicked=new se.Signal,De.onAboutClicked=new se.Signal;var ze=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).layer=void 0,e.anchor=void 0,e.visible=void 0,e.view=void 0,e.isRender=void 0,e.layer="UserLayer0",e.anchor={x:0,y:0},e.visible=!0,e.view=null,e.isRender=!1,e}return Object(c.a)(n,[{key:"revert",value:function(){this.layer="UserLayer0",this.anchor={x:0,y:0},this.visible=!0,this.view&&(this.view.destroy(),this.view=null),this.isRender=!1}},{key:"getRenderJSON",value:function(){return{layer:this.layer,anchor:this.anchor,visible:this.visible}}}]),n}(ve),Be=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).textureId=void 0,e.texture=void 0,e.textureId=null,e.texture=null,e}return Object(c.a)(n,[{key:"init",value:function(){this.textureId?this.texture=re.g.from(this.textureId):this.texture=re.g.EMPTY,this.view=new re.e(this.texture)}},{key:"clear",value:function(){this.revert(),this.textureId=null,this.texture=null}},{key:"toJSON",value:function(){var e=this.textureId,t=this.getRenderJSON();return Object(l.a)({textureId:e},t)}}]),n}(ze);de("SpriteComponent")(Be);var qe=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).texturesId=void 0,e.loop=void 0,e.animationSpeed=void 0,e.playing=void 0,e.cycle=void 0,e.textures=void 0,e.texturesId=null,e.loop=!0,e.animationSpeed=1,e.playing=!0,e.cycle=0,e.textures=null,e}return Object(c.a)(n,[{key:"init",value:function(){if(null===this.texturesId)this.textures=[re.g.EMPTY];else{var e=this.texturesId.length,t=this.getFillFrames();this.textures=[];for(var n=0;n<t-e;n++){var i=re.g.from(this.texturesId[0]);this.textures.push(i)}for(var a=0;a<e;a++){var o=re.g.from(this.texturesId[a]);this.textures.push(o)}}this.view=new re.a(this.textures)}},{key:"getFillFrames",value:function(){return this.cycle*this.animationSpeed/1e3*60}},{key:"clear",value:function(){this.revert(),this.texturesId=null,this.loop=!0,this.animationSpeed=1,this.playing=!0,this.cycle=0,this.textures=null}},{key:"toJSON",value:function(){var e=this.texturesId,t=this.loop,n=this.animationSpeed,i=this.playing,a=this.cycle,o=this.getRenderJSON();return Object(l.a)({texturesId:e,loop:t,animationSpeed:n,playing:i,interval:a},o)}}]),n}(ze);de("AnimationComponent")(qe);var Re=n(63),Fe=n(33),Je=n(22),Ue=n(4),We=n(7),Ve=n(3),Qe=n(0),Ye=n(15),Xe=0,Ge={texture:!0,children:!1,baseTexture:!0};function Ze(e,t,n,i){var a="none",o=n,s={};if("["===t){o+=i;var r=e.slice(n,o+1).join("");if("[style={"===r){var l,u="";do{u+=l=e[o],o++}while("}"!==l);s=JSON.parse(u),a="open"}else"[/style]"===r&&(a="close")}return{type:a,index:o,params:s}}Ye.b.tokenize=function(e){var t=[],n="";if("string"!==typeof e)return t;for(var i=0;i<e.length;i++){var a=e[i];/[a-z'-]/i.test(a)?n+=a:(""!==n&&(t.push(n),n=""),t.push(a))}return""!==n&&t.push(n),t},Ye.b.wordWrap=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ye.b._canvas,i=n.getContext("2d"),a=0,o="",s="",r={},l=t.letterSpacing,u=t.whiteSpace,c=Ye.b.collapseSpaces(u),h=Ye.b.collapseNewlines(u),d=!c,v=t.wordWrapWidth+l,p=Ye.b.tokenize(e),f=0;f<p.length;f++){var m=p[f],y=Ze(p,m,f,3);if("none"!==y.type){if((f=y.index+1)>=p.length)continue;m=p[f]}if(Ye.b.isNewline(m)){if(!h){s+=Ye.b.addLine(o),d=!c,o="",a=0;continue}m=" "}if(c){var g=Ye.b.isBreakingSpace(m),b=Ye.b.isBreakingSpace(o[o.length-1]);if(g&&b)continue}var w=Ye.b.getFromCache(m,l,r,i);if(w>v)if(""!==o&&(s+=Ye.b.addLine(o),o="",a=0),Ye.b.canBreakWords(m,t.breakWords))for(var x=Ye.b.wordWrapSplit(m),k=0;k<x.length;k++){for(var E=x[k],C=1;x[k+C];){var O=x[k+C],j=E[E.length-1];if(Ye.b.canBreakChars(j,O,m,k,t.breakWords))break;E+=O,C++}k+=E.length-1;var S=Ye.b.getFromCache(E,l,r,i);S+a>v&&(s+=Ye.b.addLine(o),d=!1,o="",a=0),o+=E,a+=S}else{o.length>0&&(s+=Ye.b.addLine(o),o="",a=0);var _=f===p.length-1;s+=Ye.b.addLine(m,!_),d=!1,o="",a=0}else w+a>v&&(d=!1,s+=Ye.b.addLine(o),o="",a=0),(o.length>0||!Ye.b.isBreakingSpace(m)||d)&&(o+=m,a+=w)}return s+=Ye.b.addLine(o,!1)};var Ke=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e,i,a){var o;Object(u.a)(this,n);var s=!1;a||(a=document.createElement("canvas"),s=!0),a.width=3,a.height=3;var r=Ue.p.from(a);return r.orig=new Ve.j,r.trim=new Ve.j,(o=t.call(this,r))._ownCanvas=s,o.canvas=a,o.context=o.canvas.getContext("2d"),o._resolution=We.b.RESOLUTION,o._autoResolution=!0,o._text=null,o._style=null,o._styleListener=null,o._font="",o.text=e,o.style=i,o.localStyleID=-1,o.bbcodeFillIndex=0,o.bbcodeStrokeIndex=0,o}return Object(c.a)(n,[{key:"updateText",value:function(e){var t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),this.dirty||!e){this._font=this._style.toFontString();var n,i,a=this.context,o=Ye.b.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=o.width,r=o.height,l=o.lines,u=o.lineHeight,c=o.lineWidths,h=o.maxLineWidth,d=o.fontProperties;this.canvas.width=Math.ceil((Math.max(1,s)+2*t.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,r)+2*t.padding)*this._resolution),a.scale(this._resolution,this._resolution),a.clearRect(0,0,this.canvas.width,this.canvas.height),a.font=this._font,a.lineWidth=t.strokeThickness,a.textBaseline=t.textBaseline,a.lineJoin=t.lineJoin,a.miterLimit=t.miterLimit;for(var v=t.dropShadow?2:1,p=0;p<v;++p){var f=t.dropShadow&&0===p,m=f?2*r:0,y=m*this.resolution;if(f){a.fillStyle="black",a.strokeStyle="black";var g=t.dropShadowColor,b=Object(Qe.l)("number"===typeof g?g:Object(Qe.z)(g));a.shadowColor="rgba(".concat(255*b[0],",").concat(255*b[1],",").concat(255*b[2],",").concat(t.dropShadowAlpha,")"),a.shadowBlur=t.dropShadowBlur,a.shadowOffsetX=Math.cos(t.dropShadowAngle)*t.dropShadowDistance,a.shadowOffsetY=Math.sin(t.dropShadowAngle)*t.dropShadowDistance+y}else a.fillStyle=this._generateFillStyle(t,l,o),a.strokeStyle=t.stroke,a.shadowColor="0",a.shadowBlur=0,a.shadowOffsetX=0,a.shadowOffsetY=0;for(var w=this._text.replace(/(?:\r\n|\r|\n)/g,""),x=Array.from?Array.from(w):w.split(""),k=0;k<l.length;k++)n=t.strokeThickness/2,i=t.strokeThickness/2+k*u+d.ascent,"right"===t.align?n+=h-c[k]:"center"===t.align&&(n+=(h-c[k])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(x,l[k],n+t.padding,i+t.padding-m,!0),t.fill&&this.drawLetterSpacing(x,l[k],n+t.padding,i+t.padding-m);this.bbcodeFillIndex=0,this.bbcodeStrokeIndex=0}this.updateTexture()}}},{key:"drawLetterSpacing",value:function(e,t,n,i){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this._style,s=o.letterSpacing,r=n,l=Array.from?Array.from(t):t.split(""),u=this.context.measureText(t).width,c=0,h=0;h<l.length;++h){var d=l[h];if(a){var v=Ze(e,e[this.bbcodeStrokeIndex],this.bbcodeStrokeIndex,7);if("open"===v.type){var p=v.params;p.fill&&(this.context.strokeStyle=p.stroke)}else"close"===v.type&&(this.context.strokeStyle=o.stroke);if("none"!==v.type){var f=v.index-this.bbcodeStrokeIndex;if(this.bbcodeStrokeIndex=this.bbcodeStrokeIndex+f+1,this.bbcodeStrokeIndex>=e.length)continue}this.bbcodeStrokeIndex++,this.context.strokeText(d,r,i)}else{var m=Ze(e,e[this.bbcodeFillIndex],this.bbcodeFillIndex,7);if("open"===m.type){var y=m.params;y.fill&&(this.context.fillStyle=y.fill)}else"close"===m.type&&(this.context.fillStyle=o.fill);if("none"!==m.type){var g=m.index-this.bbcodeFillIndex;if(this.bbcodeFillIndex=this.bbcodeFillIndex+g+1,this.bbcodeFillIndex>=e.length)continue}this.bbcodeFillIndex++,this.context.fillText(d,r,i)}r+=u-(c=this.context.measureText(t.substring(h+1)).width)+s,u=c}}},{key:"updateTexture",value:function(){var e=this.canvas;if(this._style.trim){var t=Object(Qe.A)(e);t.data&&(e.width=t.width,e.height=t.height,this.context.putImageData(t.data,0,0))}var n=this._texture,i=this._style,a=i.trim?0:i.padding,o=n.baseTexture;n.trim.width=n._frame.width=Math.ceil(e.width/this._resolution),n.trim.height=n._frame.height=Math.ceil(e.height/this._resolution),n.trim.x=-a,n.trim.y=-a,n.orig.width=n._frame.width-2*a,n.orig.height=n._frame.height-2*a,this._onTextureUpdate(),o.setRealSize(e.width,e.height,this._resolution),this._recursivePostUpdateTransform(),this.dirty=!1}},{key:"_render",value:function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),Object(Re.a)(Object(Fe.a)(n.prototype),"_render",this).call(this,e)}},{key:"getLocalBounds",value:function(e){return this.updateText(!0),Object(Re.a)(Object(Fe.a)(n.prototype),"getLocalBounds",this).call(this,e)}},{key:"_calculateBounds",value:function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}},{key:"_generateFillStyle",value:function(e,t,n){var i,a=e.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];var o=e.dropShadow?e.dropShadowDistance:0,s=e.padding||0,r=Math.ceil(this.canvas.width/this._resolution)-o-2*s,l=Math.ceil(this.canvas.height/this._resolution)-o-2*s,u=a.slice(),c=e.fillGradientStops.slice();if(!c.length)for(var h=u.length+1,d=1;d<h;++d)c.push(d/h);if(u.unshift(a[0]),c.unshift(0),u.push(a[a.length-1]),c.push(1),e.fillGradientType===Xe){i=this.context.createLinearGradient(r/2,s,r/2,l+s);for(var v=0,p=(n.fontProperties.fontSize+e.strokeThickness)/l,f=0;f<t.length;f++)for(var m=n.lineHeight*f,y=0;y<u.length;y++){var g=m/l+("number"===typeof c[y]?c[y]:y/u.length)*p,b=Math.max(v,g);b=Math.min(b,1),i.addColorStop(b,u[y]),v=b}}else{i=this.context.createLinearGradient(s,l/2,r+s,l/2);for(var w=u.length+1,x=1,k=0;k<u.length;k++){var E=void 0;E="number"===typeof c[k]?c[k]:x/w,i.addColorStop(E,u[k]),x++}}return i}},{key:"destroy",value:function(e){"boolean"===typeof e&&(e={children:e}),e=Object.assign({},Ge,e),Object(Re.a)(Object(Fe.a)(n.prototype),"destroy",this).call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}},{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var t=Object(Qe.y)(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var t=Object(Qe.y)(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}},{key:"style",get:function(){return this._style},set:function(e){(e=e||{})instanceof Ye.c?this._style=e:this._style=new Ye.c(e),this.localStyleID=-1,this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(e){e=String(null===e||void 0===e?"":e),this._text!==e&&(this._text=e,this.dirty=!0)}},{key:"resolution",get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}}]),n}(Je.a),$e=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).text=void 0,e.style=void 0,e.position=void 0,e.bgTextureId=void 0,e.padding=void 0,e.bgTexture=void 0,e.textView=void 0,e.btnView=void 0,e.text="",e.style={},e.position={x:"left",y:"top"},e.bgTextureId=null,e.padding=0,e.bgTexture=null,e.textView=null,e.btnView=null,e}return Object(c.a)(n,[{key:"init",value:function(){this.view=new re.b,this.bgTextureId?this.bgTexture=re.g.from(this.bgTextureId):this.bgTexture=re.g.EMPTY,this.btnView=new re.e(this.bgTexture),this.bgTextureId&&(this.style=Object(l.a)({wordWrap:!0,wordWrapWidth:this.btnView.width-2*this.padding},this.style)),this.textView=new Ke(this.text,this.style),this.textView.resolution=2,this.justifyContent(),this.view.addChild(this.btnView,this.textView)}},{key:"justifyContent",value:function(){var e=this.position,t=this.btnView,n=t.width,i=t.height,a=this.textView,o=a.width,s=a.height;"left"===e.x?this.textView.x=this.padding:"center"===e.x?this.textView.x=Math.abs(n-o)/2:"right"===e.x&&(this.textView.x=Math.abs(n-o)-this.padding),"top"===e.y?this.textView.y=this.padding:"center"===e.y?this.textView.y=Math.abs(i-s)/2:"bottom"===e.y&&(this.textView.y=Math.abs(i-s)-this.padding)}},{key:"clear",value:function(){var e,t;this.revert(),this.text="",this.style={},this.position={x:"left",y:"top"},this.bgTextureId=null,this.padding=0,null===(e=this.textView)||void 0===e||e.destroy(),this.textView=null,null===(t=this.btnView)||void 0===t||t.destroy(),this.btnView=null,this.bgTexture=null}},{key:"toJSON",value:function(){var e=this.text,t=this.style,n=this.position,i=this.bgTextureId,a=this.padding,o=this.getRenderJSON();return Object(l.a)({text:e,style:t,position:n,bgTextureId:i,padding:a},o)}}]),n}(ze);de("TextComponent")($e);var et=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).text=void 0,e.speed=void 0,e.printDelay=void 0,e.deltaTimer=void 0,e.text="",e.speed=10,e.printDelay=0,e.deltaTimer=0,e}return Object(c.a)(n,[{key:"clear",value:function(){this.text="",this.speed=10,this.printDelay=0,this.deltaTimer=0}},{key:"toJSON",value:function(){return{text:this.text,speed:this.speed,printDelay:this.printDelay}}}]),n}(ve);de("TypewriterComponent")(et);var tt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).tag=void 0,e.textureId=void 0,e.style=void 0,e.useAnimation=void 0,e.texture=void 0,e.isBind=void 0,e.isClick=void 0,e.origin=void 0,e.clickEvent=void 0,e.deltaTimer=void 0,e.tag=null,e.textureId=null,e.style={},e.useAnimation=!0,e.texture=null,e.isBind=!1,e.isClick=!1,e.origin=null,e.clickEvent=!1,e.deltaTimer=0,e}return Object(c.a)(n,[{key:"init",value:function(){this.textureId&&(this.texture=re.g.from(this.textureId))}},{key:"clear",value:function(){this.tag=null,this.textureId=null,this.style={},this.useAnimation=!0,this.texture=null,this.isBind=!1,this.isClick=!1,this.origin&&(this.origin.interactive=!1,this.origin.buttonMode=!1,this.origin.removeAllListeners()),this.origin=null,this.clickEvent=!1,this.deltaTimer=0}},{key:"toJSON",value:function(){return{tag:this.tag,textureId:this.textureId,style:this.style,useAnimation:this.useAnimation}}}]),n}(ve);de("ButtonComponent")(tt);var nt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).x=void 0,e.y=void 0,e.angle=void 0,e.scale=void 0,e.x=0,e.y=0,e.angle=0,e.scale=1,e}return Object(c.a)(n,[{key:"clear",value:function(){this.x=0,this.y=0,this.angle=0,this.scale=1}},{key:"toJSON",value:function(){return{x:this.x,y:this.y,angle:this.angle,scale:this.scale}}}]),n}(ve);de("TransformComponent")(nt);var it=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).alpha=void 0,e.alpha=0,e}return Object(c.a)(n,[{key:"clear",value:function(){this.alpha=0}},{key:"toJSON",value:function(){return{alpha:this.alpha}}}]),n}(ve);de("TransparentComponent")(it);var at=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).alias=void 0,e.options=void 0,e.firstPlay=void 0,e.isPlaying=void 0,e.sound=void 0,e.alias=null,e.options={},e.firstPlay=!0,e.isPlaying=!1,e.sound=null,e}return Object(c.a)(n,[{key:"init",value:function(){this.sound=new D(this.alias)}},{key:"clear",value:function(){this.alias=null,this.options={},this.firstPlay=!0,this.isPlaying=!1,this.sound.stop(),this.sound=null}},{key:"toJSON",value:function(){return{resourceId:this.alias,options:this.options}}}]),n}(ve);de("SoundComponent")(at);var ot=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).start=void 0,e.end=void 0,e.duration=void 0,e.start={},e.end={},e.duration=0,e}return Object(c.a)(n,[{key:"clear",value:function(){this.start={},this.end={},this.duration=0}},{key:"toJSON",value:function(){return{start:this.start,end:this.end,duration:this.duration}}}]),n}(ve);de("DisplacementComponent")(ot);var st=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).start=void 0,e.end=void 0,e.duration=void 0,e.start={},e.end={},e.duration=0,e}return Object(c.a)(n,[{key:"clear",value:function(){this.start={},this.end={},this.duration=0}},{key:"toJSON",value:function(){return{start:this.start,end:this.end,duration:this.duration}}}]),n}(ve);de("FadeComponent")(st);var rt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"execute",value:function(){var e,t=this.queries.entities.results,n=Object(ce.a)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;this.match(i,Be),this.match(i,qe),this.match(i,$e)}}catch(a){n.e(a)}finally{n.f()}}},{key:"match",value:function(e,t){if(e.hasComponent(t)){var n=e.getComponent(t);this.configureSprite(n),this.transform(e,n),this.transparent(e,n)}}},{key:"configureSprite",value:function(e){e.view.visible=e.visible;var t={x:e.anchor.x*e.view.width,y:e.anchor.y*e.view.height};if(e.view.pivot.set(t.x,t.y),!e.isRender){var n=this.world;e.isRender=!0,n.addSprite(e.layer,e.view)}}},{key:"transform",value:function(e,t){if(e.hasComponent(nt)){var n=e.getComponent(nt);t.view.x=n.x,t.view.y=n.y,t.view.angle=n.angle,t.view.scale.set(n.scale)}}},{key:"transparent",value:function(e,t){if(e.hasComponent(it)){var n=e.getComponent(it);t.view.alpha=n.alpha}}}]),n}(we);rt.queries={entities:{type:"any",components:[Be,qe,$e]}};var lt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"execute",value:function(){var e,t=this.queries.entities.results,n=Object(ce.a)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value.getComponent($e);i.textView.text!==i.text&&(i.textView.text=i.text,i.justifyContent())}}catch(a){n.e(a)}finally{n.f()}}}]),n}(we);lt.queries={entities:[$e]};var ut=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"execute",value:function(){var e,t=this.queries.entities.results,n=Object(ce.a)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value.getComponent(qe),a=i.view;a.loop!==i.loop&&(a.loop=i.loop),a.animationSpeed!==i.animationSpeed&&(a.animationSpeed=i.animationSpeed),!0===i.playing?!1===a.playing&&a.play():!0===a.playing&&a.gotoAndStop(0)}}catch(o){n.e(o)}finally{n.f()}}}]),n}(we);ut.queries={entities:[qe]};var ct=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"execute",value:function(e){var t,n=this.queries.entities.results,i=Object(ce.a)(n);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.getComponent($e),s=a.getComponent(et);if(s.text.length>o.text.length){s.speed<=0&&(s.speed=10),s.deltaTimer+=e;var r=1e3/s.speed;if(0===o.text.length&&s.printDelay>=0&&(r=s.printDelay),s.deltaTimer>=r){var l=void 0;do{l=s.text.charAt(o.text.length);var u=ht(s.text,l,o.text.length,7);"tag"===u.type&&(o.text+=u.bbcode,l=s.text.charAt(o.text.length)),o.text+=l}while(" "===l);s.deltaTimer=0}}else a.removeComponent(et)}}catch(c){i.e(c)}finally{i.f()}}}]),n}(we);function ht(e,t,n,i){var a="none",o="";if("["===t){var s=n;if(s+=i,"[style={"===(o=e.slice(n,s+1))){var r;do{s++,o+=r=e.charAt(s)}while("]"!==r);a="tag"}else"[/style]"===o&&(a="tag")}return{type:a,bbcode:o}}ct.queries={entities:[$e,et]};var dt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"execute",value:function(e){var t,n=this,i=this.queries.entities.results,a=Object(ce.a)(i);try{var o=function(){var i=t.value,a=i.getComponent($e),o=i.getComponent(tt);!1===o.isBind&&(o.isBind=!0,a.view.interactive=!0,a.view.buttonMode=!0,a.view.on("pointerdown",n.processButtonDown(i)).on("pointerup",n.processButtonUp(i)).on("pointerupoutside",n.processButtonUp(i)).on("pointertap",(function(){o.clickEvent=!0,o.deltaTimer=0})),o.origin=a.view),o.isClick=!1,!0===o.clickEvent&&(o.deltaTimer>=10?(o.isClick=!0,o.clickEvent=!1,o.deltaTimer=0):o.deltaTimer+=e)};for(a.s();!(t=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}}},{key:"processButtonUp",value:function(e){var t=this,n=e.getComponent($e),i=e.getComponent(tt),a=n.view;return function(){!0===i.useAnimation&&(e.hasComponent(nt)?e.getComponent(nt).scale=1:a.scale.set(1),n.anchor={x:0,y:0}),t.onButtonUp(n)}}},{key:"processButtonDown",value:function(e){var t=this,n=e.getComponent($e),i=e.getComponent(tt),a=n.view;return function(){!0===i.useAnimation&&(e.hasComponent(nt)?e.getComponent(nt).scale=.95:a.scale.set(.95),n.anchor={x:-.025,y:-.025}),t.onButtonDown(n,i)}}},{key:"onButtonUp",value:function(e){e.btnView.texture=e.bgTexture,Object.assign(e.textView.style,e.style)}},{key:"onButtonDown",value:function(e,t){t.texture&&(e.btnView.texture=t.texture),Object.assign(e.textView.style,t.style)}}]),n}(we);dt.queries={entities:[$e,tt]};var vt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"execute",value:function(e){var t,n=this.queries.disp.results,i=Object(ce.a)(n);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.getComponent(nt),s=a.getComponent(ot);!0===this.transform(o,s,e)&&a.removeComponent(ot)}}catch(v){i.e(v)}finally{i.f()}var r,l=this.queries.fade.results,u=Object(ce.a)(l);try{for(u.s();!(r=u.n()).done;){var c=r.value,h=c.getComponent(it),d=c.getComponent(st);!0===this.transform(h,d,e)&&c.removeComponent(st)}}catch(v){u.e(v)}finally{u.f()}}},{key:"transform",value:function(e,t,n){var i=e,a=t,o=a.start,s=a.end,r=a.duration;for(var l in s){var u=s[l]-o[l];if(i[l]!==s[l])if(i[l]+=u/r*n,u>=0){if(i[l]>=s[l])return i[l]=s[l],!0}else if(i[l]<=s[l])return i[l]=s[l],!0}return!1}}]),n}(we);vt.queries={disp:[nt,ot],fade:[it,st]};var pt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"execute",value:function(){var e,t=this.queries.entities.results,n=Object(ce.a)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,a=i.getComponent(at);!0===a.firstPlay?(a.sound.play(a.options),a.firstPlay=!1,a.isPlaying=!0):!0===a.isPlaying?!1===a.sound.isPlaying&&i.removeComponent(at):(a.sound.stop(),i.removeComponent(at))}}catch(o){n.e(o)}finally{n.f()}}}]),n}(we);pt.queries={entities:[at]};var ft=0,mt=1,yt=2,gt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).curEvent={isDown:!1,buttons:0,x:-1,y:-1},e.preEvent={isDown:!1,buttons:0,x:-1,y:-1},e.downPoint={x:0,y:0},e.isClick=!1,e.readyClick=!1,e.deltaTimer=0,e}return Object(c.a)(n,[{key:"clear",value:function(){this.curEvent={isDown:!1,buttons:0,x:-1,y:-1},this.preEvent={isDown:!1,buttons:0,x:-1,y:-1},this.downPoint={x:0,y:0},this.isClick=!1,this.readyClick=!1,this.deltaTimer=0}},{key:"isMouseUp",value:function(e){var t=this.curEvent,n=t.isDown,i=t.buttons;return!n&&(e===ft?0===i:e===mt?1===i:e===yt&&2===i)}},{key:"isMouseDown",value:function(e){var t=this.curEvent,n=t.isDown,i=t.buttons;return!!n&&(e===ft?0===i:e===mt?1===i:e===yt&&2===i)}}]),n}(ve);de("InputComponent")(gt);var bt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).entities={},e.curChapter=null,e.initialed=!1,e.nodeIndex=0,e.subIndex=0,e}return Object(c.a)(n,[{key:"clear",value:function(){this.entities={},this.curChapter=null,this.initialed=!1,this.nodeIndex=0,this.subIndex=0}},{key:"toJSON",value:function(){return{entities:this.entities,curChapter:this.curChapter,initialed:this.initialed,nodeIndex:this.nodeIndex,subIndex:this.subIndex}}}]),n}(ve);de("StoryComponent")(bt);var wt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"execute",value:function(e){var t=this.world.singleton.getComponent(gt);if(this.world.interaction){var n=this.world.interaction.mouse;t.preEvent=Object(l.a)({},t.curEvent),t.curEvent.x=n.global.x,t.curEvent.y=n.global.y,t.curEvent.buttons=n.buttons,n.isDown?(!1===t.curEvent.isDown&&(t.downPoint.x=t.curEvent.x,t.downPoint.y=t.curEvent.y),t.curEvent.isDown=!0):t.curEvent.isDown=!1,!0===t.preEvent.isDown&&1===t.preEvent.buttons&&!1===t.curEvent.isDown&&Math.abs(t.downPoint.x-t.curEvent.x)<=50&&Math.abs(t.downPoint.y-t.curEvent.y)<=50&&(t.readyClick=!0,t.deltaTimer=0),t.isClick=!1,!0===t.readyClick&&(t.deltaTimer>=10?(t.isClick=!0,t.readyClick=!1,t.deltaTimer=0):t.deltaTimer+=e)}}}]),n}(we),xt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"execute",value:function(e){var t=this.world.singleton;if(this.world.systemData&&this.world.storyScript)for(var n=t.getComponent(gt),i=!0;i;)i=this.processStory(e),n.isClick=!1}},{key:"processStory",value:function(e){if("undefined"===typeof this.world.storyScript)return!1;var t=this.world.systemData,n=this.world.storyScript[t.chapter];if("undefined"===typeof n)return!1;var i=n.length,a=n[t.nodeIndex];if("undefined"===typeof a)return!1;!1===t.initialed&&a.init&&(a.init(this.world),t.initialed=!0);var o=a.process(this.world,e);if(!0===o)if(a.goto){var s=a.goto();!s||"undefined"===typeof s.chapter&&"undefined"===typeof s.node?t.nodeIndex<i&&(t.nodeIndex++,t.subIndex=0,t.initialed=!1):(this.world.removeAllEntity(),t.entities={},t.initialed=!1,t.subIndex=0,"undefined"!==typeof s.chapter&&(t.nodeIndex=0,t.chapter=s.chapter),"undefined"!==typeof s.node&&(t.nodeIndex=s.node))}else t.nodeIndex<i&&(t.nodeIndex++,t.subIndex=0,t.initialed=!1);return o}}]),n}(we),kt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return n}(ve);de("BackgroundComponent")(kt);var Et=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return n}(ve);de("CGComponent")(Et);var Ct=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return n}(ve);de("BGMComponent")(Ct);var Ot=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return n}(ve);de("CharacterComponent")(Ot);var jt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return n}(ve);de("DialogComponent")(jt);var St=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return n}(ve);de("NameComponent")(St);var _t=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return n}(ve);de("ChoiceComponent")(_t);var Tt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return n}(ve);de("RemoveComponent")(Tt);var Pt=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"execute",value:function(){var e,t=this.queries.entities.results,n=Object(ce.a)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.hasAnyComponent([ot,st])||this.world.removeEntity(i)}}catch(l){n.e(l)}finally{n.f()}var a,o=this.queries.bgm.results,s=Object(ce.a)(o);try{for(s.s();!(a=s.n()).done;){var r=a.value;r.hasComponent(at)||this.world.removeEntity(r)}}catch(l){s.e(l)}finally{s.f()}}}]),n}(we);Pt.queries={entities:[Tt],bgm:[Ct]};var It=n(142),Mt=function(){function e(t){Object(u.a)(this,e),this.group=t}return Object(c.a)(e,[{key:"getGroup",value:function(e){return"undefined"===typeof e.systemData.entities[this.group]&&(e.systemData.entities[this.group]={}),e.systemData.entities[this.group]}},{key:"set",value:function(e,t,n){this.getGroup(e)[t]=n}},{key:"get",value:function(e,t){return this.getGroup(e)[t]}},{key:"delete",value:function(e,t){this.set(e,t,void 0)}}]),e}();var Dt=new Mt("stage");function At(e,t,n){var i=e.createEntity().addComponent(Be,{layer:"UserLayer10",textureId:"curtain"});return t>0?i.addComponent(it,{alpha:1-n}).addComponent(st,{targetId:"TransparentComponent",start:{alpha:1-n},end:{alpha:n},duration:t}):i.addComponent(it,{alpha:n}),i}var Lt={speed:22};function Nt(e,t){(e.getComponent($e).text="",e.hasComponent(et))?e.getComponent(et).text=t:e.addComponent(et,Object(l.a)({text:t},Lt))}var Ht={curtain:{up:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;function t(t){var n=Dt.get(t,"curtain");if(n){var i=t.getEntity(n);i.hasComponent(st)&&i.removeComponent(st);var a=i.getComponent(it);e>0?(a.alpha=1,i.addComponent(st,{targetId:"TransparentComponent",start:{alpha:1},end:{alpha:0},duration:e})):a.alpha=0}else{var o=At(t,e,0);Dt.set(t,"curtain",o.id)}}function n(e){var t=Dt.get(e,"curtain");if(!t)return!0;var n=e.getEntity(t);return!n.hasComponent(st)&&(Dt.delete(e,"curtain"),e.removeEntity(n),!0)}return{init:t,process:n}},down:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;function t(t){if(!Dt.get(t,"curtain")){var n=At(t,e,1);Dt.set(t,"curtain",n.id)}}function n(e){var t=Dt.get(e,"curtain");return!t||!e.getEntity(t).hasComponent(st)}return{init:t,process:n}}},voiceover:{show:function(e){return{init:function(t){var n;Array.isArray(e)?(t.systemData.subIndex=0,n=e[0],t.systemData.subIndex++):n=e,function(e,t){var n=Dt.get(e,"voiceover");if(n)Nt(e.getEntity(n),t);else{var i=e.createEntity("voiceover").addComponent($e,{layer:"UserLayer9",style:J,bgTextureId:"voiceover",padding:22,position:{x:"left",y:"center"}}).addComponent(et,Object(l.a)({text:t},Lt));Dt.set(e,"voiceover",i.id)}}(t,n)},process:function(t){var n=Dt.get(t,"voiceover"),i=t.getEntity(n);if(!1===t.singleton.getComponent(gt).isClick)return!1;if(i.hasComponent(et)){var a=i.getComponent(et).text;return i.getComponent($e).text=a,!1}if(Array.isArray(e)&&t.systemData.subIndex<e.length){var o=e[t.systemData.subIndex];return t.systemData.subIndex++,Nt(i,o),!1}return!0}}},hide:function(){return{process:function(e){var t=Dt.get(e,"voiceover");if(t){var n=e.getEntity(t);Dt.delete(e,"voiceover"),e.removeEntity(n)}return!0}}}}};var zt={wait:function(e){var t=0;return{process:function(n,i){return t>=e||(t+=i,!1)}}},waitClick:function(){return{process:function(e){return!1!==e.singleton.getComponent(gt).isClick}}},goto:function(e,t){return{process:function(){return!0},goto:function(){return{chapter:e,node:t}}}}},Bt=new Mt("scene");function qt(e,t,n,i,a){e.hasComponent(t)&&e.removeComponent(t),e.addComponent(t,{start:n,end:i,duration:a})}function Rt(e,t,n,i){if(i=function(e){return(e=e||{}).render=Object(l.a)({alpha:1},e.render),e.animation&&(e.animation=Object(l.a)({duration:1e3},e.animation)),e}(i),!Bt.get(e,t)){var a=i,o=a.render,s=a.animation,r=e.createEntity(t).addComponent(kt).addComponent(Be,{layer:"UserLayer0",textureId:n}).addComponent(nt,Object(l.a)({},o.position)).addComponent(it,{alpha:o.alpha});if(Bt.set(e,t,r.id),"undefined"!==typeof s){var u=s.position,c=s.alpha,h=s.duration,d=void 0===h?1e3:h;u&&qt(r,ot,o.position,u,d),"number"===typeof c&&qt(r,st,{alpha:o.alpha},{alpha:c},d)}}}function Ft(e,t){var n=Bt.get(e,t);if(!n)return null;var i=e.getEntity(n);return i||null}function Jt(e,t,n){var i=n=function(e){return(e=e||{}).animation&&(e.animation=Object(l.a)({duration:1e3},e.animation)),e}(n),a=i.render,o=i.animation,s=Ft(e,t);if(null!==s){var r=s.getComponent(nt),u=s.getComponent(it);if(a=Object(l.a)({position:{x:r.x,y:r.y},alpha:u.alpha},a),o){var c=o.position,h=o.alpha,d=o.duration,v=void 0===d?1e3:d;c&&qt(s,ot,a.position,c,v),"number"===typeof h&&qt(s,st,{alpha:a.alpha},{alpha:h},v)}}}var Ut={show:function(e,t,n){return{init:function(i){Rt(i,e,t,n)},process:function(){return!0}}},hide:function(e,t){return{init:function(n){Jt(n,e,t)},process:function(t){var n=Ft(t,e);return null===n||(Bt.delete(t,e),n.addComponent(Tt)),!0}}},show_async:function(e,t,n){return{init:function(i){Rt(i,e,t,n)},process:function(t){var n=Bt.get(t,e);if(n){var i=t.getEntity(n);return!i.hasComponent(ot)&&!i.hasComponent(st)}return!0}}},hide_async:function(e,t){return{init:function(n){Jt(n,e,t)},process:function(t){var n=Ft(t,e);return null===n||!n.hasComponent(ot)&&!n.hasComponent(st)&&(Bt.delete(t,e),t.removeEntity(n),!0)}}},shake:function(e,t){var n=0;return t=t||{},{process:function(i){var a=t,o=a.amplitude,s=void 0===o?0:o,r=a.duration,l=void 0===r?0:r,u=function(e,t){var n=Bt.get(e,t);if(!n)return null;var i=e.getEntity(n);return i||null}(i,e);if(null===u)return n=0,!0;var c=u.getComponent(nt);return l<=n?(c.x=0,c.y=0,n=0,!0):(c.x=Math.round(Math.random()*s*2)-s,c.y=Math.round(Math.random()*s*2)-s,n++,!1)}}},fadeIn:{render:{alpha:0},animation:{duration:1e3,alpha:1}},fadeOut:{render:{alpha:1},animation:{duration:1e3,alpha:0}},baseShake:{amplitude:10,duration:100}},Wt=new Mt("dialog"),Vt={speed:22};function Qt(e,t){(e.getComponent($e).text="",e.hasComponent(et))?e.getComponent(et).text=t:e.addComponent(et,Object(l.a)({text:t},Vt))}var Yt={show:function(e,t){return{init:function(n){var i;Array.isArray(e)?(n.systemData.subIndex=0,i=e[0],n.systemData.subIndex++):i=e,function(e,t){var n=Wt.get(e,"text");if(n)Qt(e.getEntity(n),t);else{var i=e.createEntity("dialog").addComponent(jt).addComponent($e,{layer:"UserLayer8",style:W,bgTextureId:Q.id,padding:Q.padding}).addComponent(nt,{x:0,y:H-Q.height}).addComponent(et,Object(l.a)({text:t},Vt));Wt.set(e,"text",i.id)}}(n,i),t?function(e,t){var n=Wt.get(e,"name");if(n){e.getEntity(n).getComponent($e).text=t}else{var i=e.createEntity("name").addComponent($e,{layer:"UserLayer9",text:t,style:U,bgTextureId:V.id,padding:V.padding,position:{x:"center",y:"center"}}).addComponent(nt,{x:0,y:H-V.height-Q.height}).addComponent(St);Wt.set(e,"name",i.id)}}(n,t):function(e){var t=Wt.get(e,"name");if(t){var n=e.getEntity(t);e.removeEntity(n),Wt.delete(e,"name")}}(n)},process:function(t){var n=t.getEntity(Wt.get(t,"text"));if(!1===t.singleton.getComponent(gt).isClick)return!1;if(n.hasComponent(et)){var i=n.getComponent(et).text;return n.getComponent($e).text=i,n.removeComponent(et),!1}if(Array.isArray(e)&&t.systemData.subIndex<e.length){var a=e[t.systemData.subIndex];return t.systemData.subIndex++,Qt(n,a),!1}return!0}}},hide:function(){return{process:function(e){var t=Wt.get(e,"text");if(t){var n=e.getEntity(t);Wt.delete(e,"text"),e.removeEntity(n)}if(t=Wt.get(e,"name")){var i=e.getEntity(t);Wt.delete(e,"name"),e.removeEntity(i)}return!0}}}},Xt=new Mt("character");function Gt(e,t){var n=e.createEntity().addComponent(Ot).addComponent(nt,{x:t.x,y:t.y});return Array.isArray(t.res)?n.addComponent(qe,{layer:"UserLayer".concat(t.layer+2),texturesId:t.res,cycle:5e3,animationSpeed:.2}):n.addComponent(Be,{layer:"UserLayer".concat(t.layer+2),textureId:t.res}),n}var Zt=[{res:["1001_e-0","1001_e-1","1001_e-2","1001_e-1","1001_e-0"],layer:1,x:180,y:154},{res:"1001_m-01",layer:1,x:218,y:221},Y["1001_b"],{res:"1001_he",layer:0,x:146,y:42},X["1001_ha"],X["1002_ha"]],Kt=[{res:"map02001f",layer:2,x:96,y:192},Y.map02001];function $t(e,t,n){var a=i[n];if("undefined"!==typeof a&&"undefined"===typeof Xt.get(e,t)){var o,s=[],r=Object(ce.a)(a);try{for(r.s();!(o=r.n()).done;){var l=Gt(e,o.value);s.push(l.id)}}catch(u){r.e(u)}finally{r.f()}Xt.set(e,t,s)}}var en={show:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;function n(n){$t(n,e,t)}function i(){return!0}return{init:n,process:i}},hide:function(e){return{init:function(t){var n=Xt.get(t,e);"undefined"!==typeof n&&(n.forEach((function(e){var n=t.getEntity(e);t.removeEntity(n)})),Xt.delete(t,e))},process:function(){return!0}}},update:function(e,t,n){return{init:function(i){var a=Xt.get(i,e);if("undefined"!==typeof a){var o=a[t],s=i.getEntity(o);i.removeEntity(s),s=Gt(i,n),a[t]=s.id}},process:function(){return!0}}}};new Mt("choice");var tn=new Mt("bgm");var nn={play:function(e,t){return t=t||{},{init:function(n){if(!tn.get(n,e)){var i=n.createEntity().addComponent(Ct).addComponent(at,{alias:e,options:t});tn.set(n,e,i.id)}},process:function(){return!0}}},stop:function(e){return{init:function(t){var n=tn.get(t,e);n&&(t.getEntity(n).getComponent(at).isPlaying=!1,tn.delete(t,e))},process:function(){return!0}}}},an={colorText:function(e,t){return Array.isArray(e)?e.map((function(e){return'[style={"fill": "'.concat(t,'"}]').concat(e,"[/style]")})):'[style={"fill": "'.concat(t,'"}]').concat(e,"[/style]")}},on=[Ht.voiceover.show([].concat(Object(It.a)(an.colorText(["\u6211\u59cb\u7ec8\u8ba4\u4e3a\uff0c\u4eba\u751f\u5c31\u50cf\u4e00\u5e45\u590d\u6742\u7684\u62fc\u56fe\uff0c\u6bcf\u4e2a\u4eba\u603b\u6709\u5c5e\u4e8e\u81ea\u5df1\u7684\u56de\u5fc6\u788e\u7247\u3002","\u603b\u662f\u5728\u4e0d\u81ea\u89c9\u7684\u5f53\u4e0b\uff0c\u4e00\u7247\u7247\u5e73\u51d1\u7740\uff0c\u76f4\u5230\u770b\u89c1\u4e8b\u4ef6\u7684\u539f\u59cb\u8f6e\u5ed3","\u81ea\u4ece\u90a3\u6b21\u65c5\u884c\uff0c\u5373\u4f7f\u5230\u73b0\u5728\uff0c\u6211\u7684\u8111\u6d77\u91cc\u4ecd\u6df1\u6df1\u70d9\u5370\u7740\u90a3\u5e74\u590f\u5929\u7684\u8273\u9633\u3001\u6d77\u98ce\uff0c\u4ee5\u53ca\u2026\u2026","\u4f60\u7684\u5fae\u7b11\u2026\u2026"],G)),[an.colorText("\u7b2c\u4e00\u7ae0    \u300a \u9082 \u9005 \u300b",Z),an.colorText("\u6d77\u8fb9",K)])),Ht.curtain.down(500),Ht.voiceover.hide(),Ut.show("hai_bian_d","map01001"),Ht.curtain.up(500),nn.play("shopping",{loop:!0}),Yt.show(["\u54c7\uff01\u597d\u523a\u773c\u7684\u592a\u9633\u554a\uff01\u5750\u4e86\u90a3\u4e48\u4e45\u7684\u8f66\uff0c\u7ec8\u4e8e\u5230\u8fbe\u6d77\u98ce\u9547\u5566\uff01","\u54e6\uff01\u662f\u6d77\u8036\uff01\u51c9\u723d\u7684\u6d77\u98ce\u2026\u2026\u54c7\u2026\u2026\u5fc3\u60c5\u90fd\u597d\u4e86\u8d77\u6765\u554a\u2026\u2026","\u771f\u4e0d\u6127\u662f\u6bcf\u5e74\u4e3e\u529e\u97f3\u6d6a\u796d\u7684\u4e13\u5c5e\u5730\u70b9\u554a\u2026\u2026","\u2026\u2026\n\u8fd9\u4e48\u6f02\u4eae\u7684\u666f\u8272\u2026\u2026\u5979\u770b\u5230\u4e5f\u4f1a\u5f88\u5f00\u5fc3\u7684\u5427\u2026\u2026","\u867d\u7136\u6211\u4eec\u7ea6\u597d\u8981\u5728\u8fd9\u8fb9\u4f1a\u548c\u2026\u2026\u4f46\u662f\u5979\u2026\u2026","\u5509\u2026\u2026\u6709\u4e8b\u803d\u6401\u4e86\uff0c\u4e5f\u662f\u6ca1\u529e\u6cd5\u7684\u4e8b\u554a\u2026\u2026"],"? ? ?"),Yt.show(an.colorText(["\u6211\uff0c\u4ee5\u7fd4\uff0c\u4e00\u4e2a\u5e73\u51e1\u7684\u5927\u4e00\u751f\u3002","\u52aa\u529b\u6253\u5de5\u4e86\u8fd9\u4e48\u4e45\uff0c\u603b\u7b97\u5b58\u5230\u4e86\u8fd9\u8d9f\u6765\u6d77\u98ce\u9547\u7684\u65c5\u8d39\u2026\u2026","\u867d\u7136\u5f88\u8f9b\u82e6\u2026\u2026","\u4f46\u662f\uff0c\u8fd9\u662f\u6211\u5fc5\u987b\u4e3a\u5979\u505a\u7684\u2026\u2026","\u8865\u507f\u5427\u2026\u2026"],G)),Yt.show(["\u5f69\u8679\u5929\u5802\u6c11\u5bbf\u5e94\u8be5\u79bb\u8fd9\u6ca1\u591a\u8fdc\u5427\u2026\u2026","\u8bb0\u5f97\u6c11\u5bbf\u7684\u4eba\u8bf4\u2026\u2026\u4e0b\u8f66\u540e\u6b65\u884c\u4e94\u767e\u516c\u5c3a\uff0c\u770b\u5230\u5c0f\u5403\u5e97\u518d\u5de6\u8f6c\u4e09\u767e\u516c\u5c3a\uff0c\u7a7f\u8fc7\u5e06\u8239\u516c\u56ed\u4e4b\u540e\u518d\u5f80\u53f3\u8d70\u4e00\u767e\u516c\u5c3a\u5c31\u5230\u4e86\u2026\u2026","\u2026\u2026\n\u8fd8\u2026\u2026\u8fd8\u771f\u4e0d\u662f\u666e\u901a\u7684\u8fd1\u54c8\u2026\u2026"],"\u4ee5\u7fd4"),Yt.show(an.colorText("\u9633\u5149\u7a7f\u8fc7\u4e91\u5c42\uff0c\u7167\u5c04\u5728\u9635\u96e8\u8fc7\u540e\u8fd8\u6709\u4e9b\u6ecb\u6da6\u7684\u516c\u8def\u4e0a\u3002\u8def\u4e0a\u4e00\u5927\u6ee9\u96e8\u540e\u7684\u79ef\u6c34\uff0c\u6b63\u4e00\u70b9\u4e00\u6ef4\u56e0\u4e3a\u70ed\u5ea6\u800c\u84b8\u53d1\u3002",G)),Yt.show(["\u770b\u8fd9\u91cc\u4e5f\u4e0d\u50cf\u6709\u8ba1\u7a0b\u8f66\u7ecf\u8fc7\u7684\u6837\u5b50\u2026\u2026","\u597d\u5427\uff01\u53ea\u597d\u8d70\u5230\u6c11\u5bbf\u53bb\u4e86\uff0c\u987a\u4fbf\u6b23\u8d4f\u6d77\u98ce\u9547\u7684\u6d77\u666f\u4e5f\u5f88\u4e0d\u9519\u554a\uff01"],"\u4ee5\u7fd4"),Yt.show(an.colorText(["\u6211\u632f\u594b\u7cbe\u795e\uff0c\u7ed5\u8fc7\u811a\u8fb9\u96e8\u540e\u6b8b\u7559\u7684\u6c34\u5751\uff0c\u6cbf\u7740\u8def\u65c1\u9752\u7fe0\u7684\u8349\u5730\uff0c\u8fc8\u5f00\u811a\u6b65\u51c6\u5907\u5f80\u524d\u8d70\u65f6\u2026\u2026","\u5657\u5472~"],G)),Ut.shake("hai_bian_d",Ut.baseShake),Yt.show(an.colorText(["\u4e00\u8f86\u8f66\u5b50\u4ece\u6211\u8eab\u65c1\u547c\u5578\u800c\u8fc7\uff0c\u72e0\u72e0\u78be\u8fc7\u6211\u523b\u610f\u907f\u5f00\u7684\u79ef\u6c34\uff0c\u6211\u8fde\u5fd9\u5f80\u65c1\u8fb9\u7684\u8349\u5730\u4e00\u8df3\uff0c\u8bd5\u56fe\u95ea\u8fc7\u6e85\u8d77\u7684\u6c34\u82b1\u3002","\u4f46\u662f\u6211\u6bd5\u7adf\u4e0d\u662f\u7ec3\u5c31\u98de\u6a90\u8d70\u58c1\u8f7b\u529f\u7684\u6b66\u6797\u9ad8\u624b\u3002\u6e85\u8d77\u7684\u6c34\u82b1\u98de\u5feb\u5730\u88ad\u51fb\u4e86\u6211\u7684\u4e0b\u534a\u8eab\u3002"],G)),Yt.show("\u54c7\u554a\uff01\u8fd9\u2026\u2026\u8fd9\u8f66\u5b50\u600e\u4e48\u641e\u7684\uff01\uff1f\u8fd9\u53ef\u662f\u6211\u4e3a\u4e86\u8fd9\u6b21\u65c5\u884c\u65b0\u4e70\u7684\u6d77\u6ee9\u88e4\u554a\u2026\u2026\uff01\uff01","\u4ee5\u7fd4"),Yt.show(an.colorText(["\u6211\u4f4e\u5934\u770b\u7740\u60e8\u906d\u201c\u6d77\u5578\u201d\u6d17\u793c\u7684\u88e4\u5b50\uff0c\u6c34\u8fd8\u610f\u72b9\u672a\u5c3d\u5730\u5728\u88e4\u7ba1\u8fb9\u7f18\u5f80\u4e0b\u6ef4\u3002","\u800c\u88ab\u6c34\u82b1\u6e85\u900f\u7684\u5730\u65b9\uff0c\u6e7f\u7684\u6709\u4e9b\u5de7\u5999\u2026\u2026\u8ba9\u6211\u770b\u8d77\u6765\u6d3b\u50cf\u4e2a\u5c3f\u5931\u7981\u7684\u5bb6\u4f19\u2026\u2026","\u8fd9\u65f6\uff0c\u811a\u4e0b\u9664\u4e86\u67d4\u8f6f\u7684\u8349\u5730\u4e4b\u5916\uff0c\u8fd8\u6709\u53e6\u4e00\u79cd\u5947\u602a\u7684\u89e6\u611f\u2026\u2026\u8be5\u2026\u2026\u8be5\u4e0d\u4f1a\u2026\u2026","\u6211\u7d27\u5f20\u5730\u7f13\u7f13\u62ac\u8d77\u811a\uff0c\u5ffd\u7136\u89c9\u5f97\u811a\u8e1d\u6c89\u91cd\u4e86\u8d77\u6765\u2026\u2026"],G)),nn.stop("shopping"),nn.play("funny",{loop:!0}),Yt.show("\u5443\u554a\uff01","\u4ee5\u7fd4"),Yt.show(an.colorText(["\u6211\u62ac\u8d77\u811a\u5e95\uff0c\u4e00\u5768\u70ed\u547c\u547c\u6e7f\u9ecf\u9ecf\u7684\u52a8\u7269\u6392\u6cc4\u7269\uff0c\u6b63\u5bf9\u7740\u6211\u7684\u6d77\u6ee9\u978b\u6b7b\u7f20\u70c2\u6253\u5730\u505a\u4eb2\u5bc6\u63a5\u89e6\u2026\u2026","\u5176\u95f4\u8fd8\u6709\u91d1\u9ec4\u707f\u70c2\u7684\u7389\u7c73\u7c92\u5a07\u7f9e\u5730\u745f\u7f29\u5728\u6211\u7684\u978b\u5e95\u7f1d\u9699\u95f4\u2026\u2026","\u6211\u6025\u5fd9\u5c31\u7740\u4eba\u884c\u9053\u7684\u53f0\u9636\u75af\u72c2\u5730\u8e6d\u7740\u978b\u5b50\u2026\u2026"],G)),Yt.show(["\u54c7\u554a\uff01\u6c14\u6b7b\u6211\u4e86\uff01","\u79bb\u6c11\u5bbf\u5230\u5e95\u6709\u591a\u8fdc\u554a\u2026\u2026\uff01\uff1f","\u65b9\u5706\u767e\u91cc\u5c45\u7136\u770b\u4e0d\u5230\u4ec0\u4e48\u5546\u5bb6\u2026\u2026"],"\u4ee5\u7fd4"),Yt.show(an.colorText("\u8fd9\u2026\u2026\u8fd9\u662f\u5730\u72f1\u5417\u2026\u2026\uff01\uff1f\u6211\u8be5\u4e0d\u4f1a\u7cca\u91cc\u7cca\u6d82\u642d\u4e0a\u901a\u5f80\u5730\u72f1\u5165\u53e3\u7684\u73ed\u8f66\u5427\uff1f\uff01",G)),Yt.show(["\u54ce\u2026\u2026\u60f3\u4e0d\u5230\u521a\u4e0b\u8f66\u5c31\u9047\u5230\u8fd9\u4e9b\u4e8b\u60c5\uff0c\u771f\u4e0d\u77e5\u9053\u540e\u9762\u8fd8\u4f1a\u6709\u4ec0\u4e48\u4e8b\u5728\u7b49\u7740\u6211\u2026\u2026","\u5982\u679c\u2026\u2026\u5982\u679c\u2026\u2026\u5979\u5728\u7684\u8bdd\uff0c\u60f3\u5fc5\u4f1a\u7b11\u6211\u50cf\u4e2a\u7b28\u86cb\u5427\u2026\u2026"],"\u4ee5\u7fd4"),Yt.show(an.colorText("\u6211\u7684\u8111\u6d77\u4e2d\u4e0d\u81ea\u89c9\u6d6e\u73b0\u5979\u7684\u7b11\u8138\uff0c\u6e29\u67d4\u7684\u7b11\u58f0\u4eff\u4f5b\u5c31\u5728\u6211\u7684\u8033\u8fb9\u56de\u8361\u7740\u2026\u2026",G)),Yt.show(["\u2026\u2026\n\u662f\u554a\uff0c\u8ba1\u5212\u8fd9\u6b21\u65c5\u884c\u7684\u76ee\u7684\u4e0d\u5c31\u662f\u4e3a\u4e86\u5979\u5417\u2026\u2026\uff1f","\u4e3a\u4e86\u2026\u2026\u5f25\u8865\u90a3\u9053\u2026\u2026\u88c2\u75d5\u2026\u2026\u4e0d\u662f\u5417\u2026\u2026\uff1f"],"\u4ee5\u7fd4"),Yt.show(an.colorText("\u60f3\u5230\u8fd9\u91cc\uff0c\u6211\u6536\u56de\u4e00\u76f4\u8e6d\u5728\u9636\u68af\u4e0a\u7684\u811a\uff0c\u5047\u88c5\u5fd8\u8bb0\u534a\u9897\u7f29\u5728\u978b\u5e95\u7684\u7389\u7c73\u7c92\u4e0e\u53cc\u817f\u95f4\u6e7f\u9ecf\u7684\u95f7\u70ed\u611f\u2026\u2026",G)),Yt.show(["\u770b\u6765\uff0c\u53ea\u597d\u8d70\u4e00\u6b65\u7b97\u4e00\u6b65\u4e86\u3002","\u53cd\u6b63\u8239\u5230\u6865\u5934\u81ea\u7136\u76f4\u5427\uff01"],"\u4ee5\u7fd4"),Yt.show(an.colorText(["\u63c9\u63c9\u9f3b\u5b50\uff0c\u6211\u518d\u6b21\u62c9\u7d27\u80cc\u5305\uff0c\u7ee7\u7eed\u5f80\u524d\u8d70\u53bb\u3002","\u6697\u6697\u671f\u5f85\u53ef\u4ee5\u8ba9\u6211\u6362\u4e0b\u8fd9\u8eab\u72fc\u72c8\u7684\u5730\u65b9\uff0c\u4f1a\u51fa\u73b0\u5728\u4e00\u4e2a\u8f6c\u89d2\u2026\u2026"],G)),nn.stop("funny"),Ht.curtain.down(500),Yt.hide(),Ut.hide("hai_bian_d"),Ut.show("voiceover","voiceover"),Ht.curtain.up(500),Ht.voiceover.show(an.colorText("\u5e06\u8239\u516c\u56ed",K)),Ht.curtain.down(500),Ht.voiceover.hide(),Ut.hide("voiceover"),Ut.show("gong_yuan","map01008"),Ht.curtain.up(500),nn.play("shopping",{loop:!0}),Yt.show(["\u8fd9\u6d77\u98ce\u9547\u7684\u89c4\u5212\u4e5f\u592a\u597d\u4e86\u5427\uff1f\u8d70\u5230\u8fd9\u91cc\u7adf\u7136\u5468\u56f4\u8fde\u4e00\u5bb6\u5546\u5e97\u90fd\u6ca1\u6709\u2026\u2026","\u6c11\u5bbf\u5feb\u5230\u4e86\u5427\uff01\uff1f\u603b\u89c9\u5f97\u8def\u7a0b\u6bd4\u6c11\u5bbf\u7684\u4eba\u8bf4\u5f97\u8fd8\u8fdc\u2026\u2026","\u597d\u60f3\u5feb\u70b9\u6362\u8863\u670d\u554a\u2026\u2026"],"\u4ee5\u7fd4"),Yt.show(an.colorText(["\u6211\u6709\u4e9b\u7edd\u671b\u5730\u5728\u5fc3\u91cc\u5450\u558a\u7740\uff0c\u4ece\u91cd\u8981\u90e8\u4f4d\u4f20\u6765\u7684\u95f7\u70ed\u611f\uff0c\u5df2\u7ecf\u628a\u6211\u903c\u5230\u60ac\u5d16\u7684\u8fb9\u7f18.\u4e16\u754c\u7684\u5c3d\u5934.\u795e\u660e\u7684\u6545\u4e61\u2026\u2026","\u7b80\u5355\u7684\u8bf4\u5c31\u662f\u201c\u6781\u9650\u201d\u5566\u2026\u2026"],G)),Yt.show("\u55ef\uff1f\u90a3\u4e0d\u662f\u2026\u2026","\u4ee5\u7fd4"),Yt.show(an.colorText(["\u662f\u2026\u2026\u662f\u4e0a\u5929\u542c\u5230\u6211\u7684\u6c42\u6551\u5417\u2026\u2026\uff1f","\u6211\u770b\u89c1\u79bb\u6b65\u9053\u8ddd\u79bb\u4e0d\u8fdc\u7684\u6811\u53f6\u4e2d\uff0c\u6709\u4e2a\u6c34\u9f99\u5934\u56e0\u4e3a\u9633\u5149\u7167\u5c04\uff0c\u8f89\u6620\u7740\u67d4\u548c\u7684\u91d1\u5c5e\u5149\u6cfd\u3002"],G)),Yt.show("\u554a\u2026\u2026\u8fd9\u662f\u2026\u2026\u662f\u795e\u8ff9\u5427\uff01\u592a\u2026\u2026\u592a\u4ee4\u4eba\u611f\u52a8\u4e86\u2026\u2026\uff01","\u4ee5\u7fd4"),Yt.show(an.colorText(["\u73b0\u5728\u56de\u60f3\u8d77\u6765\uff0c\u90a3\u4e2a\u6c34\u9f99\u5934\u5bf9\u5f53\u65f6\u7684\u6211\u6765\u8bf4\uff0c\u7b80\u76f4\u662f\u2026\u2026","\u795e\u7684\u793c\u7269\u554a\uff01\uff01"],G)),Yt.show("\u592a\u597d\u4e86\uff01\u6211\u7ec8\u4e8e\u5f97\u5230\u6551\u8d4e\u4e86\uff01","\u4ee5\u7fd4"),Yt.show(an.colorText("\u6211\u611f\u52a8\u4e0d\u5df2\u5730\u626d\u5f00\u6c34\u9f99\u5934\uff0c\u51b0\u51c9\u7684\u6c34\u6d41\u5728\u638c\u5fc3\u805a\u96c6\u6210\u4e00\u6c60\u8ff7\u4eba\u7684\u6c34\u6ce2\u3002\u63a5\u7740\u5fc3\u5b58\u611f\u6fc0\u7684\u4e00\u4ef0\u800c\u5c3d\uff0c\u8ba9\u6cc9\u6c34\u987a\u7740\u98df\u9053\uff0c\u5c06\u4f53\u5185\u7684\u70ed\u6c14\u4e00\u626b\u800c\u7a7a\u3002",G)),Yt.show("\u54c7\u554a\u2026\u2026\u597d\u8212\u670d\u554a\u2026\u2026\u8fd9\u6c34\u6709\u79cd\u7518\u751c\u7684\u5473\u9053\u5462\u2026\u2026","\u4ee5\u7fd4"),Yt.show(an.colorText("\u6211\u8d2a\u5a6a\u5730\u559d\u7740\uff0c\u751a\u81f3\u5962\u4f88\u5730\u5927\u628a\u5927\u628a\u6cfc\u5728\u8138\u4e0a\u3001\u624b\u4e0a\u3001\u4ee5\u53ca\u811a\u4e0a\uff0c\u987a\u9053\u5c06\u978b\u4e0a\u6b8b\u7559\u7684\u4e0d\u51c0\u4e4b\u7269\u7ed9\u6e05\u7406\u5e72\u51c0\u3002",G)),Yt.show("\u5bf9\u4e0d\u8d77\uff0c\u7389\u7c73\u7c92\uff0c\u6211\u60f3\u6211\u4eec\u4e0d\u5408\u9002\uff0c\u4f60\u8fd8\u662f\u8d70\u5427\u2026\u2026","\u4ee5\u7fd4"),Yt.show("\u2026\u2026","\u7389\u7c73\u7c92"),Yt.show("\u54c7\u54c8\u54c8\uff01\u5feb\u6eda\u5427\u4f60\uff01","\u4ee5\u7fd4"),Yt.show(an.colorText(["\u770b\u7740\u534a\u9897\u7684\u7389\u7c73\u7c92\u4ece\u978b\u5e95\u7684\u7f1d\u9699\u4e2d\uff0c\u987a\u7740\u6c34\u6d41\u98d8\u8d70\uff0c\u6211\u5fc3\u4e2d\u5347\u8d77\u65e0\u4e0e\u4f26\u6bd4\u7684\u6210\u5c31\u611f\u3002","\u628a\u811a\u4e0a\u7684\u4e1c\u897f\u6e05\u7406\u5e72\u51c0\u540e\uff0c\u6211\u603b\u7b97\u677e\u4e86\u53e3\u6c14\uff0c\u73b0\u5728\u5c31\u53ea\u5269\u2026\u2026"],G)),Yt.show(["\u5514\u2026\u2026\u8fd9\u516c\u56ed\u7684\u5395\u6240\u5728\u54ea\u5462\u2026\u2026","\u554a\u2026\u2026\u8fd8\u662f\u8981\u627e\u4e2a\u5730\u65b9\u6362\u6389\u8fd9\u6761\u88e4\u5b50\u624d\u884c\u554a\u2026\u2026\u662f\u4e0d\u662f\u8be5\u627e\u4e2a\u4eba\u95ee\u95ee\u624d\u597d\u5462\u2026\u2026\u4f46\u662f\u53c8\u6ca1\u770b\u5230\u4ec0\u4e48\u6e38\u5ba2\u2026\u2026","\u55ef\uff01\uff1f\u6ca1\u4ec0\u4e48\u6e38\u5ba2\u2026\u2026!?"],"\u4ee5\u7fd4"),Yt.show(an.colorText("\u770b\u770b\u5468\u906d\uff0c\u4e5f\u8bb8\u662f\u65e5\u6b63\u5f53\u4e2d\u7684\u5173\u7cfb\uff0c\u6240\u4ee5\u6765\u516c\u56ed\u7684\u6e38\u5ba2\u5e76\u4e0d\u591a\uff0c\u66f4\u522b\u8bf4\u90a3\u4e9b\u4f1a\u8eb2\u5728\u6811\u6797\u4e2d\u537f\u537f\u6211\u6211\u7684\u60c5\u4fa3\u4e86\u3002",G)),Yt.show(["\u5bf9\u4e86\uff01\u4e5f\u8bb8\u6211\u53ef\u4ee5\u2026\u2026\u4f46\u662f\u4f1a\u4e0d\u4f1a\u53c8\u592a\u2026\u2026","\u5982\u679c\u53ea\u662f\u4e00\u4e0b\u5b50\u2026\u2026\u8bf4\u4e0d\u5b9a\u2026\u2026","\u2026\u2026","\u53ea\u8981\u52a8\u4f5c\u5feb\u4e00\u70b9\u2026\u2026\u5e94\u8be5\u6ca1\u4ec0\u4e48\u95ee\u9898\u5427\u2026\u2026"],"\u4ee5\u7fd4"),Yt.show(an.colorText(["\u60f3\u5230\u8fd9\u91cc\uff0c\u6211\u628a\u5fc3\u4e00\u6a2a\uff0c\u50cf\u662f\u52a0\u91cd\u51b3\u5fc3\u822c\u5feb\u901f\u5c06\u80cc\u5305\u653e\u5728\u4e00\u65c1\u9f50\u8170\u9ad8\u7684\u6811\u6797\u4e0a\uff0c\u5e76\u4e14\u62c9\u5f00\u80cc\u5305\u7684\u62c9\u94fe\uff0c\u62ff\u51fa\u53e0\u5f97\u5341\u5206\u6574\u9f50\u5e72\u51c0\uff0c\u8fd8\u900f\u7740\u5fae\u5fae\u9999\u5473\u7684\u6362\u6d17\u8863\u7269\u3002","\u6211\u4e00\u8fb9\u5c0f\u5fc3\u5730\u5427\u5185\u88e4\u53ca\u77ed\u88e4\u5206\u5f00\u653e\u5728\u6811\u6797\u4e0a\uff0c\u4e00\u8fb9\u76d8\u7b97\u7740\u4e0b\u4e00\u6b65\u7684\u52a8\u4f5c\u2026\u2026","\u63a5\u7740\u6211\u6df1\u5438\u4e00\u53e3\u6c14\uff0c\u4ee5\u8fc5\u96f7\u4e0d\u53ca\u63a9\u8033\u7684\u901f\u5ea6\uff0c\u5feb\u901f\u8131\u4e0b\u8eab\u4e0a\u90a3\u5c42\u6e7f\u9ecf\u95f7\u70ed\u7684\u88e4\u5b50\u53ca\u5185\u88e4\u3002","\u4e3a\u4e86\u4e89\u53d6\u6548\u7387\uff0c\u6211\u4e00\u624b\u5c06\u6362\u4e0b\u6765\u7684\u8863\u7269\u4e22\u5728\u4e00\u65c1\u7684\u6c34\u9f99\u5934\u4e0a\uff0c\u4e00\u624b\u6293\u8d77\u5185\u88e4\u5feb\u901f\u7a7f\u4e0a\uff0c\u4e00\u6c14\u5475\u6210\uff01"],G)),Yt.show("\u547c\u2026\u2026\u770b\u6765\u6bd4\u60f3\u8c61\u4e2d\u7b80\u5355\u554a\u2026\u2026","\u4ee5\u7fd4"),Yt.show(an.colorText(["\u6211\u7a0d\u7a0d\u677e\u4e86\u53e3\u6c14\uff0c\u4eab\u53d7\u7740\u8863\u670d\u4e0e\u808c\u8089\u95f4\u8212\u723d\u7684\u5feb\u611f\uff0c\u987a\u9053\u4e1c\u5f20\u897f\u671b\u4e86\u4e00\u4e0b\u2026\u2026","\u4e00\u9635\u6e05\u723d\u5fae\u51c9\u7684\u6a59\u9999\u5473\u5e26\u7740\u590f\u5929\u7684\u8bf1\u60d1\u4ece\u8eab\u540e\u4f20\u6765\uff0c\u6211\u8fde\u5fd9\u8f6c\u8eab\u5b9a\u773c\u4e00\u770b\u2026\u2026"],G)),Yt.show("\u54c7\u2026\u2026","\u4ee5\u7fd4"),Yt.show(an.colorText("\u773c\u524d\u7684\u753b\u9762\uff0c\u8ba9\u6211\u4e0d\u7531\u5f97\u8d5e\u53f9\u8d77\u6765\u2026\u2026",G)),nn.stop("shopping"),nn.play("night",{loop:!0}),en.show("xing_nai_1"),Yt.show(an.colorText(["\u90a3\u662f\u4e00\u4e2a\u7a7f\u7740\u767d\u8272\u6d0b\u88c5\u7684\u5973\u5b69\uff0c\u5a07\u5c0f\u7684\u8eab\u6750\u88ab\u6d0b\u88c5\u8f7b\u8584\u4f3c\u5730\u7d27\u88f9\u7740\u3002","\u8863\u6599\u7d27\u8d34\u5728\u67d4\u8f6f\u7684\u80f8\u4e0a\uff0c\u5f62\u6210\u4ee4\u4eba\u65e0\u9650\u9050\u60f3\u7684\u9b45\u529b\u66f2\u7ebf\u3002","\u7ea4\u7ec6\u7684\u8170\u8eab\u968f\u7740\u8d70\u52a8\u7684\u9891\u7387\u6b3e\u6446\u7740\uff0c\u6563\u53d1\u7740\u8db3\u4ee5\u8ba9\u4efb\u4f55\u4e00\u4e2a\u7537\u6027\u90fd\u60f3\u4e3a\u5979\u72af\u7f6a\u7684\u8bf1\u60d1\u3002","\u9633\u5149\u7a7f\u8fc7\u5979\u8eab\u4e0a\u7684\u6d0b\u88c5\uff0c\u987a\u7740\u5f62\u6210\u4e00\u9053\u5fae\u5fae\u7684\u5149\u6655\uff0c\u5723\u6d01\u5730\u4ee4\u4eba\u601c\u60dc\u3002"],G)),en.hide("xing_nai_1"),en.show("xing_nai_map_1"),Yt.hide(),zt.waitClick(),Yt.show(an.colorText(["\u88ab\u5fae\u98ce\u6311\u9017\u7684\u67d4\u4eae\u79c0\u53d1\uff0c\u8fce\u98ce\u98d8\u6563\u7740\u3002","\u5c0f\u5c0f\u8033\u5782\u4e0a\u6234\u7740\u4e00\u6735\u6276\u6851\u82b1\u8033\u5760\uff0c\u85cf\u5728\u79c0\u53d1\u95f4\u968f\u98ce\u6447\u66f3\u3002","\u767d\u7699\u65e0\u6687\u7684\u8138\u988a\uff0c\u900f\u7740\u5982\u82f9\u679c\u822c\u7684\u7ea2\u6655\u3002","\u4f46\u662f\u6700\u4ee4\u6211\u52a8\u5fc3\u7684\uff0c\u5374\u662f\u90a3\u5bf9\u4e0d\u5c5e\u4e8e\u4e1c\u65b9\u4eba\u7684\u989c\u8272\u773c\u7738\uff0c\u5982\u540c\u6df1\u9083\u7684\u5927\u6d77\u822c\u851a\u84dd\u2026\u2026"],G))];console.log("chapter1 length:",on.length);var sn={chapter1:on},rn=function(){function e(t){Object(u.a)(this,e),this.game=t,this.world=null,this.view=null,this.systemData=null,this.storyData=null,this.init()}return Object(c.a)(e,[{key:"init",value:function(){this._initData(),this._initWorldModule(),this.world.start()}},{key:"saveArchive",value:function(){return this.world.serialize()}},{key:"loadArchive",value:function(e){this.world.deserialize(e)}},{key:"_initData",value:function(){this.systemData={entities:{},chapter:"chapter1",initialed:!1,nodeIndex:0,subIndex:0},this.storyData={}}},{key:"_initWorldModule",value:function(){this.world=new Ce,this.world.interaction=this.game.renderer.plugins.interaction,this.world.storyScript=sn,this.world.storyData=this.storyData,this.world.systemData=this.systemData,this.view=this.world.view,window.world=this.world,this.world.registerSystem(wt).registerSystem(xt).registerSystem(ct).registerSystem(dt).registerSystem(ut).registerSystem(vt).registerSystem(lt).registerSystem(pt).registerSystem(Pt).registerSystem(rt),this.world.singleton.addComponent(gt)}},{key:"update",value:function(e){this.world.execute(e)}},{key:"stats",value:function(e){e.entity.update(this.world.stats().overview.numEntities,30)}}]),e}(),ln=function(){function e(){Object(u.a)(this,e),this.view=new re.b}return Object(c.a)(e,[{key:"update",value:function(){}}]),e}();ue.registerPlugin("interaction",Se);var un=new(function(){function e(t){var n=this;Object(u.a)(this,e),this._update=function(e){n.stats.begin(),n.show&&n.isPlay&&(n.show.update&&n.show.update(e),n.renderer.render(n.show.view)),n.updated.dispatch(n),n.stats.end(),n.curScene.stats?n.curScene.stats(n.stats):n.stats.entity.update(0,30),requestAnimationFrame(n._update)},this.resize=function(){n._updateRenderScale(),n._setSceneScale()},this.title=t,this.scale=1,this.renderer=null,this.loader=new le("https://cdn.jsdelivr.net/gh/LuckyRabbitFeet/temp@main/"),this.cutscenes=new ln(this),this.prevScene=null,this.curScene=null,this.show=null,this.isPlay=!0,this.updated=new se.Signal,this.stats=new oe.a,this.stats.added=!1,this.stats.entity=this.stats.addPanel(new oe.a.Panel("ENTITY","#ff8","#221")),this.stats.showPanel(0),this.init()}return Object(c.a)(e,[{key:"init",value:function(){this._initSoundModule(),this._initRenderModule()}},{key:"load",value:function(){return this.loader.load(B)}},{key:"addStats",value:function(){this.stats.added||(document.body.appendChild(this.stats.dom),this.stats.added=!0)}},{key:"removeStats",value:function(){this.stats.added&&(document.body.removeChild(this.stats.dom),this.stats.added=!1)}},{key:"_initSoundModule",value:function(){D.loadState()}},{key:"_initRenderModule",value:function(){var e=window.devicePixelRatio||1,t=N,n=H;this.renderer=new ue({width:t,height:n,resolution:e})}},{key:"to",value:function(e){D.stopAll();var t=new e(this);return this._cutscenesWait(t)}},{key:"break",value:function(){return this.prevScene?(D.stopAll(),this._cutscenesWait(this.prevScene)):Promise.resolve()}},{key:"_cutscenesWait",value:function(e){var t=this;this.updated.addOnce((function(){t.show=t.cutscenes}));var n=new Promise((function(t){e.load?e.load().then(t):setTimeout(t,150)}));return n.then((function(){t.updated.addOnce((function(){t._changeScene(e)}))})),n}},{key:"start",value:function(e){if(e){var t=new e(this);this._changeScene(t)}requestAnimationFrame(this._update)}},{key:"pause",value:function(){this.isPlay=!1}},{key:"resume",value:function(){this.isPlay=!0}},{key:"_changeScene",value:function(e){this.prevScene=this.curScene,this.curScene=e,this.show=e,this._setSceneScale()}},{key:"saveArchive",value:function(){var e=this;return new Promise((function(t){e.updated.addOnce((function(){if(e.curScene.saveArchive){var n=e.curScene.saveArchive();console.log(n)}t()}))}))}},{key:"loadArchive",value:function(){var e=this;return new Promise((function(t){e.updated.addOnce((function(){if(e.curScene.loadArchive){e.curScene.loadArchive("{}"),console.log("{}")}t()}))}))}},{key:"_updateRenderScale",value:function(){var e=window.innerWidth,t=window.innerHeight;(e<N||t<H)&&(this.scale=Math.min(e/N,t/H)),console.log("renderScale: ",this.scale),this.renderer.resize(N*this.scale,H*this.scale)}},{key:"_setSceneScale",value:function(){this.show&&this.show.view.scale.set(this.scale)}}]),e}())("love-memory"),cn=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).resize=function(){un.resize(),e.setState({width:un.renderer.view.style.width,height:un.renderer.view.style.height})},e.progressHandle=function(t){e.loadError||((t=Math.ceil(t))-e.state.loader.progress>=20||t>=100)&&e.setState({loader:Object(l.a)(Object(l.a)({},e.state.loader),{},{progress:t})})},e.clickStartHandle=function(){un.to(rn).then((function(){e.setState({menu:!0})}))},e.clickSettingHandle=function(){e.setState({show:1})},e.clickAboutHandle=function(){e.setState({show:2})},e.openMenuHandle=function(){e.setState({show:3})},e.closeMenuHandle=function(){e.setState({show:0})},e.togglePanelHandle=function(){un.stats.added?un.removeStats():un.addStats()},e.closeDialogHandle=function(){e.setState({dialog:0})},e.saveHandle=function(){e.setState({dialog:1,dialogStatus:"saving"}),un.saveArchive().then((function(){setTimeout((function(){e.setState({dialogStatus:"saved"})}),500)}))},e.loadHandle=function(){},e.getArchive=function(){},e.breakTitleHandle=function(){e.setState({dialog:2})},e.confirmWarnHandle=function(){un.to(De).then((function(){e.setState({dialog:0}),setTimeout((function(){e.setState({show:0,menu:!1})}),200)}))},e.loadError=!1,e.loader=o.a.createRef(),e.canvas=o.a.createRef(),e.state={show:0,menu:!1,loader:{loading:!0,progress:0,error:null},width:0,height:0,dialog:0,dialogStatus:""},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.resize(),this.addEvents(),un.load().then((function(){setTimeout((function(){e.setState({loader:Object(l.a)(Object(l.a)({},e.state.loader),{},{loading:!1})},(function(){un.start(De),e.clickStartHandle(),un.renderer.view.style.opacity=1}))}),1e3)}),(function(t){console.warn(t),e.loadError=!0,e.loader.current.detailsHandle(),e.setState({loader:Object(l.a)(Object(l.a)({},e.state.loader),{},{error:t})})}))}},{key:"componentWillUnmount",value:function(){this.removeEvents()}},{key:"addEvents",value:function(){this.canvas.current.appendChild(un.renderer.view),window.addEventListener("resize",this.resize),un.loader.onProgressed.add(this.progressHandle),De.onStartClicked.add(this.clickStartHandle),De.onSettingClicked.add(this.clickSettingHandle),De.onAboutClicked.add(this.clickAboutHandle)}},{key:"removeEvents",value:function(){window.removeEventListener("resize",this.resize),un.loader.onProgressed.remove(this.progressHandle),De.onStartClicked.remove(this.clickStartHandle),De.onSettingClicked.remove(this.clickSettingHandle),De.onAboutClicked.remove(this.clickAboutHandle)}},{key:"render",value:function(){var e=this.state,t=e.show,n=e.menu,i=e.width,a=e.height,s=e.loader,r={width:i,height:a};return t>0?un.pause():!1===un.isPlay&&un.resume(),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"love-memory",style:r},o.a.createElement(v,{ref:this.loader,loader:s}),n&&o.a.createElement("div",{className:"menu-icon-wrapper"},o.a.createElement(p,{onClick:this.openMenuHandle})),o.a.createElement(y,{show:t,onClose:this.closeMenuHandle},(1===t||3===t)&&o.a.createElement(A,{show:t,onPanel:this.togglePanelHandle,onSave:this.saveHandle,onLoad:this.loadHandle,onBreak:this.breakTitleHandle,getArchive:this.getArchive}),2===t&&o.a.createElement($,null)),o.a.createElement("div",{ref:this.canvas})),o.a.createElement(ne,{isOpen:1===this.state.dialog,status:this.state.dialogStatus,onClose:this.closeDialogHandle}),o.a.createElement(ie,{isOpen:2===this.state.dialog,onConfirm:this.confirmWarnHandle,onClose:this.closeDialogHandle}))}}]),n}(o.a.Component),hn={position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center"},dn={display:"flex",alignItems:"center",height:"100%",maxWidth:480,maxHeight:853,background:"black"};var vn=function(){return o.a.createElement("div",{style:hn},o.a.createElement("div",{style:dn},o.a.createElement(cn,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(278),n(279),n(280);r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(vn,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},61:function(e){e.exports=JSON.parse('{"a":"0.1.0"}')}},[[143,1,2]]]);
//# sourceMappingURL=main.23b0b434.chunk.js.map